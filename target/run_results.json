{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2024-01-18T13:26:01.030082Z", "invocation_id": "0846ef8d-4f3b-42e5-b062-25018428a08b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-18T13:25:47.153502Z", "completed_at": "2024-01-18T13:25:47.160313Z"}, {"name": "execute", "started_at": "2024-01-18T13:25:47.177528Z", "completed_at": "2024-01-18T13:25:50.929308Z"}], "thread_id": "Thread-2", "execution_time": 3.778488874435425, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.windingflowdev.stg_purchase", "compiled": true, "compiled_code": "with source as (\n    select * from \"postgres\".\"metrics_test\".\"purchase_sync\"\n),\n\nrenamed as (\n    select\n        id as purchase_id,\n        no as number,\n        tenantId as tenant_id,\n        appId as app_id,\n        sku as sku,\n        qty as qty,\n        amount as amount,\n        (amount * 7) as amount_rmb,\n        unit as unit,\n        date_trunc('day', createAt) as create_at\n    from source\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"metrics_test\".\"stg_purchase\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-18T13:25:50.937479Z", "completed_at": "2024-01-18T13:25:50.946387Z"}, {"name": "execute", "started_at": "2024-01-18T13:25:50.959434Z", "completed_at": "2024-01-18T13:25:56.192770Z"}], "thread_id": "Thread-4", "execution_time": 5.2591552734375, "adapter_response": {"_message": "SELECT 15", "code": "SELECT", "rows_affected": 15}, "message": "SELECT 15", "failures": null, "unique_id": "model.windingflowdev.purchase_items", "compiled": true, "compiled_code": "\n\nwith \n\npurchase_items as (\n    select *\n    from \"postgres\".\"metrics_test\".\"stg_purchase\"\n),\n\n\nrenamed as (\n    select purchase_id,\n    number,\n    tenant_id,\n    app_id,\n    sku,\n    qty,\n    amount,\n    amount_rmb,\n    unit,\n    create_at,\n    (amount * qty) as purchase_amount_usd\n    from purchase_items\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"metrics_test_windingflow\".\"purchase_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-18T13:25:50.984380Z", "completed_at": "2024-01-18T13:25:50.996150Z"}, {"name": "execute", "started_at": "2024-01-18T13:25:51.003819Z", "completed_at": "2024-01-18T13:25:56.965018Z"}], "thread_id": "Thread-2", "execution_time": 6.01352334022522, "adapter_response": {"_message": "SELECT 14", "code": "SELECT", "rows_affected": 14}, "message": "SELECT 14", "failures": null, "unique_id": "model.windingflowdev.purchase_items_week", "compiled": true, "compiled_code": "\n\nwith \n\npurchase_items as (\n    select *\n    from \"postgres\".\"metrics_test\".\"stg_purchase\"\n),\n\n\nrenamed as (\n    select\n    sku,\n    date_trunc('week', create_at) as create_at,\n    sum(amount * qty) as purchase_amount_usd_total,\n    sum(qty) as qty,\n    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg\n    from purchase_items\n    group by sku,create_at\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"metrics_test_windingflow\".\"purchase_items_week\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-18T13:25:50.941315Z", "completed_at": "2024-01-18T13:25:50.951239Z"}, {"name": "execute", "started_at": "2024-01-18T13:25:50.953588Z", "completed_at": "2024-01-18T13:25:57.938419Z"}], "thread_id": "Thread-3", "execution_time": 7.00418758392334, "adapter_response": {"_message": "SELECT 14", "code": "SELECT", "rows_affected": 14}, "message": "SELECT 14", "failures": null, "unique_id": "model.windingflowdev.purchase_items_day", "compiled": true, "compiled_code": "\n\nwith \n\npurchase_items as (\n    select *\n    from \"postgres\".\"metrics_test\".\"stg_purchase\"\n),\n\n\nrenamed as (\n    select\n    sku,\n    date_trunc('day', create_at) as create_at,\n    sum(amount * qty) as purchase_amount_usd_total,\n    sum(qty) as qty,\n    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg\n    from purchase_items\n    group by sku,create_at\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"metrics_test_windingflow\".\"purchase_items_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-18T13:25:47.144093Z", "completed_at": "2024-01-18T13:25:54.955569Z"}, {"name": "execute", "started_at": "2024-01-18T13:25:54.956468Z", "completed_at": "2024-01-18T13:25:58.137164Z"}], "thread_id": "Thread-1", "execution_time": 10.995647192001343, "adapter_response": {"_message": "SELECT 9862", "code": "SELECT", "rows_affected": 9862}, "message": "SELECT 9862", "failures": null, "unique_id": "model.windingflowdev.metricflow_time_spine", "compiled": true, "compiled_code": "\n\nwith days as (\n\n    \n\n\n    \n\n\n    with rawdata as (\n\n        \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n     + \n    \n    p13.generated_number * power(2, 13)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n     cross join \n    \n    p as p13\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 9862\n    order by generated_number\n\n\n\n    ),\n\n    all_periods as (\n\n        select (\n            \n\n    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n        ) as date_day\n        from rawdata\n\n    ),\n\n    filtered as (\n\n        select *\n        from all_periods\n        where date_day <= to_date('01/01/2027','mm/dd/yyyy')\n\n    )\n\n    select * from filtered\n\n\n\n),\n\nfinal as (\n    select cast(date_day as date) as date_day\n    from days\n)\n\nselect * from final", "relation_name": "\"postgres\".\"metrics_test_windingflow\".\"metricflow_time_spine\""}], "elapsed_time": 31.846324920654297, "args": {"populate_cache": true, "project_dir": "/home/shaw/Projects/windingflow/windingflowdev", "exclude": [], "log_level_file": "debug", "indirect_selection": "eager", "log_level": "info", "version_check": true, "partial_parse_file_diff": true, "log_path": "/home/shaw/Projects/windingflow/windingflowdev/logs", "printer_width": 80, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "static_parser": true, "favor_state": false, "show_resource_report": false, "cache_selected_only": false, "quiet": false, "log_format": "default", "partial_parse": true, "enable_legacy_logger": false, "macro_debugging": false, "use_colors": true, "invocation_command": "dbt run", "vars": {}, "send_anonymous_usage_stats": true, "which": "run", "strict_mode": false, "profiles_dir": "/root/.dbt", "use_colors_file": true, "introspect": true, "log_format_file": "debug", "select": [], "print": true, "write_json": true, "log_file_max_bytes": 10485760}}