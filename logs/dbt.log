[0m16:07:13.522131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ac250d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7aa1ac760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7aa1ac670>]}


============================== 16:07:13.524311 | 92fd7a19-6760-4b17-840f-35703194f3ec ==============================
[0m16:07:13.524311 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:07:13.524758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:07:13.525225 [info ] [MainThread]: dbt version: 1.7.4
[0m16:07:13.525547 [info ] [MainThread]: python version: 3.8.10
[0m16:07:13.525903 [info ] [MainThread]: python path: /usr/bin/python3
[0m16:07:13.526252 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m16:07:13.599515 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m16:07:13.599920 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m16:07:13.600278 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m16:07:13.600747 [info ] [MainThread]: adapter type: postgres
[0m16:07:13.601045 [info ] [MainThread]: adapter version: 1.7.4
[0m16:07:13.671009 [info ] [MainThread]: Configuration:
[0m16:07:13.671448 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:07:13.671781 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:07:13.672099 [info ] [MainThread]: Required dependencies:
[0m16:07:13.672446 [debug] [MainThread]: Executing "git --help"
[0m16:07:13.677069 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:07:13.678239 [debug] [MainThread]: STDERR: "b''"
[0m16:07:13.678680 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:07:13.679023 [info ] [MainThread]: Connection:
[0m16:07:13.679398 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m16:07:13.679691 [info ] [MainThread]:   port: 5432
[0m16:07:13.680021 [info ] [MainThread]:   user: postgres
[0m16:07:13.680294 [info ] [MainThread]:   database: postgres
[0m16:07:13.680590 [info ] [MainThread]:   schema: windingflowdev
[0m16:07:13.680896 [info ] [MainThread]:   connect_timeout: 10
[0m16:07:13.681178 [info ] [MainThread]:   role: None
[0m16:07:13.681463 [info ] [MainThread]:   search_path: None
[0m16:07:13.681764 [info ] [MainThread]:   keepalives_idle: 0
[0m16:07:13.682055 [info ] [MainThread]:   sslmode: None
[0m16:07:13.682445 [info ] [MainThread]:   sslcert: None
[0m16:07:13.682721 [info ] [MainThread]:   sslkey: None
[0m16:07:13.683017 [info ] [MainThread]:   sslrootcert: None
[0m16:07:13.683290 [info ] [MainThread]:   application_name: dbt
[0m16:07:13.683588 [info ] [MainThread]:   retries: 1
[0m16:07:13.684157 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:07:13.684854 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:07:13.685200 [debug] [MainThread]: Using postgres connection "debug"
[0m16:07:13.685499 [debug] [MainThread]: On debug: select 1 as id
[0m16:07:13.685791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:16.875266 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m16:07:16.876649 [debug] [MainThread]: On debug: Close
[0m16:07:16.877559 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:07:16.877919 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:07:16.878851 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4026697, "process_user_time": 1.763875, "process_kernel_time": 0.080176, "process_mem_max_rss": "100176", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m16:07:16.879487 [debug] [MainThread]: Command `dbt debug` succeeded at 16:07:16.879347 after 3.40 seconds
[0m16:07:16.879837 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:07:16.880182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ac250d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ab42cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a8883ca0>]}
[0m16:07:16.880607 [debug] [MainThread]: Flushing usage events
[0m16:07:33.053047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615424ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6152145be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61521b2d30>]}


============================== 16:07:33.055439 | 9a899e8f-098e-4de3-9fbc-2686ad3eff9d ==============================
[0m16:07:33.055439 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:07:33.055919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:33.234903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6153439dc0>]}
[0m16:07:33.319488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615219ec40>]}
[0m16:07:33.320202 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:07:33.327393 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:07:33.328325 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:07:33.328789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6150741df0>]}
[0m16:07:34.277946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614bf735e0>]}
[0m16:07:34.288857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614bf73550>]}
[0m16:07:34.289553 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:07:34.290166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61507417c0>]}
[0m16:07:34.292488 [info ] [MainThread]: 
[0m16:07:34.293343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:34.294442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_windingflowdev'
[0m16:07:34.306388 [debug] [ThreadPool]: Using postgres connection "list_postgres_windingflowdev"
[0m16:07:34.307141 [debug] [ThreadPool]: On list_postgres_windingflowdev: BEGIN
[0m16:07:34.307635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.620277 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:07:37.620706 [debug] [ThreadPool]: Using postgres connection "list_postgres_windingflowdev"
[0m16:07:37.621024 [debug] [ThreadPool]: On list_postgres_windingflowdev: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_windingflowdev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'windingflowdev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'windingflowdev'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'windingflowdev'
  
[0m16:07:37.868385 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:07:37.869520 [debug] [ThreadPool]: On list_postgres_windingflowdev: ROLLBACK
[0m16:07:38.107246 [debug] [ThreadPool]: On list_postgres_windingflowdev: Close
[0m16:07:38.112469 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:38.112852 [debug] [MainThread]: On master: BEGIN
[0m16:07:38.113128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:40.312505 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:07:40.312907 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:40.313221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:07:40.787634 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:07:40.788839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a899e8f-098e-4de3-9fbc-2686ad3eff9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614bf3b040>]}
[0m16:07:40.789230 [debug] [MainThread]: On master: ROLLBACK
[0m16:07:41.030748 [debug] [MainThread]: On master: Close
[0m16:07:41.032747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:41.033303 [info ] [MainThread]: 
[0m16:07:41.037765 [debug] [Thread-1  ]: Began running node model.windingflowdev.my_first_dbt_model
[0m16:07:41.038661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_windingflowdev, now model.windingflowdev.my_first_dbt_model)
[0m16:07:41.039270 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.my_first_dbt_model
[0m16:07:41.046907 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.my_first_dbt_model"
[0m16:07:41.047775 [debug] [Thread-1  ]: Timing info for model.windingflowdev.my_first_dbt_model (compile): 16:07:41.039521 => 16:07:41.047543
[0m16:07:41.048222 [debug] [Thread-1  ]: Began executing node model.windingflowdev.my_first_dbt_model
[0m16:07:41.048647 [debug] [Thread-1  ]: Timing info for model.windingflowdev.my_first_dbt_model (execute): 16:07:41.048444 => 16:07:41.048457
[0m16:07:41.049599 [debug] [Thread-1  ]: Finished running node model.windingflowdev.my_first_dbt_model
[0m16:07:41.054649 [debug] [Thread-3  ]: Began running node model.windingflowdev.my_second_dbt_model
[0m16:07:41.055564 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.my_second_dbt_model'
[0m16:07:41.055955 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.my_second_dbt_model
[0m16:07:41.058899 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.my_second_dbt_model"
[0m16:07:41.059544 [debug] [Thread-3  ]: Timing info for model.windingflowdev.my_second_dbt_model (compile): 16:07:41.056172 => 16:07:41.059315
[0m16:07:41.059897 [debug] [Thread-3  ]: Began executing node model.windingflowdev.my_second_dbt_model
[0m16:07:41.060317 [debug] [Thread-3  ]: Timing info for model.windingflowdev.my_second_dbt_model (execute): 16:07:41.060110 => 16:07:41.060122
[0m16:07:41.061124 [debug] [Thread-3  ]: Finished running node model.windingflowdev.my_second_dbt_model
[0m16:07:41.061544 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:07:41.066343 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.my_second_dbt_model, now test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:07:41.065469 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778
[0m16:07:41.067560 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778'
[0m16:07:41.067969 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778
[0m16:07:41.061993 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_my_first_dbt_model_id.16e066b321
[0m16:07:41.066754 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:07:41.085437 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.windingflowdev.unique_my_first_dbt_model_id.16e066b321'
[0m16:07:41.102592 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_my_first_dbt_model_id.16e066b321
[0m16:07:41.097434 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778"
[0m16:07:41.101973 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:07:41.086134 [debug] [Thread-1  ]: Began running node test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493
[0m16:07:41.110136 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_my_first_dbt_model_id.16e066b321"
[0m16:07:41.110846 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778 (compile): 16:07:41.068476 => 16:07:41.110614
[0m16:07:41.111986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.my_first_dbt_model, now test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:07:41.112453 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 16:07:41.097843 => 16:07:41.112239
[0m16:07:41.113038 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778
[0m16:07:41.113674 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_my_first_dbt_model_id.16e066b321 (compile): 16:07:41.102851 => 16:07:41.113456
[0m16:07:41.114101 [debug] [Thread-1  ]: Began compiling node test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493
[0m16:07:41.114579 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:07:41.115278 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778 (execute): 16:07:41.114965 => 16:07:41.114982
[0m16:07:41.115935 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_my_first_dbt_model_id.16e066b321
[0m16:07:41.119863 [debug] [Thread-1  ]: Writing injected SQL for node "test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:07:41.120415 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 16:07:41.120177 => 16:07:41.120190
[0m16:07:41.121272 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778
[0m16:07:41.121732 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_my_first_dbt_model_id.16e066b321 (execute): 16:07:41.121525 => 16:07:41.121532
[0m16:07:41.124682 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_my_first_dbt_model_id.16e066b321
[0m16:07:41.123348 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493 (compile): 16:07:41.116413 => 16:07:41.123145
[0m16:07:41.122879 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:07:41.125630 [debug] [Thread-1  ]: Began executing node test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493
[0m16:07:41.126389 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493 (execute): 16:07:41.126155 => 16:07:41.126164
[0m16:07:41.127205 [debug] [Thread-1  ]: Finished running node test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493
[0m16:07:41.128393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:41.128697 [debug] [MainThread]: Connection 'test.windingflowdev.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:07:41.128972 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m16:07:41.129262 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:07:41.129531 [debug] [MainThread]: Connection 'test.windingflowdev.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:07:41.131097 [debug] [MainThread]: Command end result
[0m16:07:41.138063 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 8.13125, "process_user_time": 3.043427, "process_kernel_time": 0.104254, "process_mem_max_rss": "113232", "process_in_blocks": "72", "process_out_blocks": "2440"}
[0m16:07:41.138668 [debug] [MainThread]: Command `dbt compile` succeeded at 16:07:41.138543 after 8.13 seconds
[0m16:07:41.139112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615424ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61508724f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614bf737c0>]}
[0m16:07:41.139484 [debug] [MainThread]: Flushing usage events
[0m16:08:48.802400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ab236ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a91aab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a91a2790>]}


============================== 16:08:48.804515 | fdc4648a-65ee-447f-baae-da1a48b6b610 ==============================
[0m16:08:48.804515 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:08:48.804979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:48.962810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a786ee50>]}
[0m16:08:49.038426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a7805280>]}
[0m16:08:49.039119 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:08:49.045545 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:08:49.070721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:49.071137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:49.076913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a75f1c10>]}
[0m16:08:49.087232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a76b3850>]}
[0m16:08:49.087848 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:08:49.088249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a76b3e80>]}
[0m16:08:49.089439 [info ] [MainThread]: 
[0m16:08:49.090260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:49.091464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:08:49.102134 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:08:49.102615 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:08:49.102954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:51.913259 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m16:08:51.914415 [debug] [ThreadPool]: On list_postgres: Close
[0m16:08:51.915916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_windingflowdev)
[0m16:08:51.916465 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "windingflowdev"
"
[0m16:08:51.920827 [debug] [ThreadPool]: Using postgres connection "create_postgres_windingflowdev"
[0m16:08:51.921178 [debug] [ThreadPool]: On create_postgres_windingflowdev: BEGIN
[0m16:08:51.921446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:54.148013 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:08:54.148409 [debug] [ThreadPool]: Using postgres connection "create_postgres_windingflowdev"
[0m16:08:54.148702 [debug] [ThreadPool]: On create_postgres_windingflowdev: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "create_postgres_windingflowdev"} */
create schema if not exists "windingflowdev"
[0m16:08:54.391314 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:08:54.392238 [debug] [ThreadPool]: On create_postgres_windingflowdev: COMMIT
[0m16:08:54.392535 [debug] [ThreadPool]: Using postgres connection "create_postgres_windingflowdev"
[0m16:08:54.392967 [debug] [ThreadPool]: On create_postgres_windingflowdev: COMMIT
[0m16:08:54.631277 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:08:54.631713 [debug] [ThreadPool]: On create_postgres_windingflowdev: Close
[0m16:08:54.633809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_windingflowdev, now list_postgres_windingflowdev)
[0m16:08:54.638313 [debug] [ThreadPool]: Using postgres connection "list_postgres_windingflowdev"
[0m16:08:54.638609 [debug] [ThreadPool]: On list_postgres_windingflowdev: BEGIN
[0m16:08:54.638876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:56.961494 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:08:56.961893 [debug] [ThreadPool]: Using postgres connection "list_postgres_windingflowdev"
[0m16:08:56.962180 [debug] [ThreadPool]: On list_postgres_windingflowdev: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_windingflowdev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'windingflowdev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'windingflowdev'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'windingflowdev'
  
[0m16:08:57.200987 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:08:57.201998 [debug] [ThreadPool]: On list_postgres_windingflowdev: ROLLBACK
[0m16:08:57.429095 [debug] [ThreadPool]: On list_postgres_windingflowdev: Close
[0m16:08:57.433629 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:57.434014 [debug] [MainThread]: On master: BEGIN
[0m16:08:57.434307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:59.505868 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:08:59.506288 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:59.506682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:08:59.967887 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:08:59.969009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a75f7130>]}
[0m16:08:59.969406 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:00.203726 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:00.204139 [debug] [MainThread]: On master: BEGIN
[0m16:09:00.657065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:00.657461 [debug] [MainThread]: On master: COMMIT
[0m16:09:00.657765 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:00.658026 [debug] [MainThread]: On master: COMMIT
[0m16:09:00.882352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:00.882792 [debug] [MainThread]: On master: Close
[0m16:09:00.883779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:00.884092 [info ] [MainThread]: 
[0m16:09:00.886509 [debug] [Thread-1  ]: Began running node model.windingflowdev.my_first_dbt_model
[0m16:09:00.886912 [info ] [Thread-1  ]: 1 of 2 START sql table model windingflowdev.my_first_dbt_model ................. [RUN]
[0m16:09:00.888166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_windingflowdev, now model.windingflowdev.my_first_dbt_model)
[0m16:09:00.888489 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.my_first_dbt_model
[0m16:09:00.895634 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.my_first_dbt_model"
[0m16:09:00.896615 [debug] [Thread-1  ]: Timing info for model.windingflowdev.my_first_dbt_model (compile): 16:09:00.888674 => 16:09:00.896197
[0m16:09:00.896964 [debug] [Thread-1  ]: Began executing node model.windingflowdev.my_first_dbt_model
[0m16:09:00.934836 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.my_first_dbt_model"
[0m16:09:00.935625 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.my_first_dbt_model"
[0m16:09:00.935969 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: BEGIN
[0m16:09:00.936267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:04.286497 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m16:09:04.286972 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.my_first_dbt_model"
[0m16:09:04.287353 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.my_first_dbt_model"} */

  
    

  create  table "postgres"."windingflowdev"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:09:04.524878 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m16:09:04.529886 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.my_first_dbt_model"
[0m16:09:04.530268 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.my_first_dbt_model"} */
alter table "postgres"."windingflowdev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:09:04.767369 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:04.781173 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: COMMIT
[0m16:09:04.781975 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.my_first_dbt_model"
[0m16:09:04.782544 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: COMMIT
[0m16:09:05.019401 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:09:05.024608 [debug] [Thread-1  ]: Applying DROP to: "postgres"."windingflowdev"."my_first_dbt_model__dbt_backup"
[0m16:09:05.028189 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.my_first_dbt_model"
[0m16:09:05.028527 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.my_first_dbt_model"} */
drop table if exists "postgres"."windingflowdev"."my_first_dbt_model__dbt_backup" cascade
[0m16:09:05.268993 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:05.270988 [debug] [Thread-1  ]: Timing info for model.windingflowdev.my_first_dbt_model (execute): 16:09:00.897161 => 16:09:05.270792
[0m16:09:05.271332 [debug] [Thread-1  ]: On model.windingflowdev.my_first_dbt_model: Close
[0m16:09:05.272385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a6d61c40>]}
[0m16:09:05.272885 [info ] [Thread-1  ]: 1 of 2 OK created sql table model windingflowdev.my_first_dbt_model ............ [[32mSELECT 2[0m in 4.38s]
[0m16:09:05.273420 [debug] [Thread-1  ]: Finished running node model.windingflowdev.my_first_dbt_model
[0m16:09:05.274086 [debug] [Thread-3  ]: Began running node model.windingflowdev.my_second_dbt_model
[0m16:09:05.274538 [info ] [Thread-3  ]: 2 of 2 START sql view model windingflowdev.my_second_dbt_model ................. [RUN]
[0m16:09:05.275275 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.my_second_dbt_model'
[0m16:09:05.275607 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.my_second_dbt_model
[0m16:09:05.277996 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.my_second_dbt_model"
[0m16:09:05.278717 [debug] [Thread-3  ]: Timing info for model.windingflowdev.my_second_dbt_model (compile): 16:09:05.275812 => 16:09:05.278450
[0m16:09:05.279037 [debug] [Thread-3  ]: Began executing node model.windingflowdev.my_second_dbt_model
[0m16:09:05.298885 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.my_second_dbt_model"
[0m16:09:05.299541 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.my_second_dbt_model"
[0m16:09:05.299959 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: BEGIN
[0m16:09:05.300301 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:09:07.420470 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m16:09:07.420977 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.my_second_dbt_model"
[0m16:09:07.421464 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.my_second_dbt_model"} */

  create view "postgres"."windingflowdev"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."windingflowdev"."my_first_dbt_model"
where id = 1
  );
[0m16:09:07.654809 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:09:07.657861 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.my_second_dbt_model"
[0m16:09:07.658364 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.my_second_dbt_model"} */
alter table "postgres"."windingflowdev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:09:07.894950 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:07.896451 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: COMMIT
[0m16:09:07.896771 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.my_second_dbt_model"
[0m16:09:07.897112 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: COMMIT
[0m16:09:08.127733 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:09:08.130227 [debug] [Thread-3  ]: Applying DROP to: "postgres"."windingflowdev"."my_second_dbt_model__dbt_backup"
[0m16:09:08.132741 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.my_second_dbt_model"
[0m16:09:08.133179 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.my_second_dbt_model"} */
drop view if exists "postgres"."windingflowdev"."my_second_dbt_model__dbt_backup" cascade
[0m16:09:08.363305 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:09:08.364720 [debug] [Thread-3  ]: Timing info for model.windingflowdev.my_second_dbt_model (execute): 16:09:05.279297 => 16:09:08.364529
[0m16:09:08.365084 [debug] [Thread-3  ]: On model.windingflowdev.my_second_dbt_model: Close
[0m16:09:08.365960 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc4648a-65ee-447f-baae-da1a48b6b610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a6ce9760>]}
[0m16:09:08.366501 [info ] [Thread-3  ]: 2 of 2 OK created sql view model windingflowdev.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 3.09s]
[0m16:09:08.367046 [debug] [Thread-3  ]: Finished running node model.windingflowdev.my_second_dbt_model
[0m16:09:08.368280 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:08.368571 [debug] [MainThread]: On master: BEGIN
[0m16:09:08.368854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:12.587778 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m16:09:12.588221 [debug] [MainThread]: On master: COMMIT
[0m16:09:12.588518 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:12.588789 [debug] [MainThread]: On master: COMMIT
[0m16:09:12.834009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:12.834459 [debug] [MainThread]: On master: Close
[0m16:09:12.835313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:12.835576 [debug] [MainThread]: Connection 'model.windingflowdev.my_first_dbt_model' was properly closed.
[0m16:09:12.835822 [debug] [MainThread]: Connection 'model.windingflowdev.my_second_dbt_model' was properly closed.
[0m16:09:12.836157 [info ] [MainThread]: 
[0m16:09:12.836752 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 23.75 seconds (23.75s).
[0m16:09:12.837861 [debug] [MainThread]: Command end result
[0m16:09:12.844087 [info ] [MainThread]: 
[0m16:09:12.844472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:12.844747 [info ] [MainThread]: 
[0m16:09:12.845029 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:09:12.845668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.084862, "process_user_time": 2.071627, "process_kernel_time": 0.117338, "process_mem_max_rss": "109044", "process_out_blocks": "1688", "process_in_blocks": "0"}
[0m16:09:12.846423 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:12.846310 after 24.09 seconds
[0m16:09:12.846723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ab236ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a786ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a6d65e20>]}
[0m16:09:12.847036 [debug] [MainThread]: Flushing usage events
[0m16:39:30.675679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b2665f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b05c2bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b05bad00>]}


============================== 16:39:30.677890 | a3396964-0ffe-46a4-980b-e72f598d17c0 ==============================
[0m16:39:30.677890 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:39:30.678393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:30.839419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b05c23a0>]}
[0m16:39:30.919228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b05a5e50>]}
[0m16:39:30.919942 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:39:30.926791 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:39:30.934269 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:39:30.934759 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:39:30.935108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aeba29d0>]}
[0m16:39:31.922931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.windingflowdev.example
[0m16:39:31.927208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ae240b80>]}
[0m16:39:31.936066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aeced160>]}
[0m16:39:31.936540 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:39:31.936883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aeb7ffa0>]}
[0m16:39:31.939212 [info ] [MainThread]: 
[0m16:39:31.939866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:31.940912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m16:39:31.951082 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:39:31.951515 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:39:31.951817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:31.953989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m16:39:31.956888 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:39:31.957344 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:39:31.957690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:34.341209 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:39:34.341584 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:39:34.341855 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:39:34.396491 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:39:34.396878 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:39:34.397171 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:39:34.590326 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:39:34.591405 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:39:34.653941 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:39:34.655044 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:39:34.840369 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:39:34.892325 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:39:34.897362 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:34.897718 [debug] [MainThread]: On master: BEGIN
[0m16:39:34.897972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:37.052823 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:39:37.053447 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:37.054072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:37.535425 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:39:37.536903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3396964-0ffe-46a4-980b-e72f598d17c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ad9a2ca0>]}
[0m16:39:37.537328 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:37.773040 [debug] [MainThread]: On master: Close
[0m16:39:37.774344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:37.774721 [info ] [MainThread]: 
[0m16:39:37.776866 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:39:37.777435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m16:39:37.777948 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:39:37.784992 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:39:37.785668 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:39:37.778267 => 16:39:37.785447
[0m16:39:37.786006 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:39:37.786427 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:39:37.786224 => 16:39:37.786234
[0m16:39:37.787178 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:39:37.787934 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:39:37.788537 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:39:37.788866 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:39:37.792689 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:39:37.793346 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:39:37.794635 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:39:37.795384 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:39:37.799742 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:39:37.800450 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:39:37.795690 => 16:39:37.800215
[0m16:39:37.800820 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:39:37.801247 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:39:37.801034 => 16:39:37.801045
[0m16:39:37.802019 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:39:37.803165 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:39:37.805354 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.purchase_items_week)
[0m16:39:37.805741 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:39:37.804506 [debug] [Thread-1  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:39:37.814776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m16:39:37.815194 [debug] [Thread-1  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:39:37.813921 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:39:37.822872 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:39:37.805970 => 16:39:37.822576
[0m16:39:37.803704 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:39:37.789065 => 16:39:37.803472
[0m16:39:37.824856 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:39:37.825293 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:39:37.825084 => 16:39:37.825095
[0m16:39:37.826722 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:39:37.804141 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:39:37.823282 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:39:37.834583 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:39:37.834248 => 16:39:37.834259
[0m16:39:37.833173 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:39:37.836131 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m16:39:37.832598 [debug] [Thread-1  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m16:39:37.836500 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:39:37.833887 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m16:39:37.842586 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:39:37.835406 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:39:37.851614 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m16:39:37.854634 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m16:39:37.855666 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:39:37.858605 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m16:39:37.857816 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 16:39:37.836972 => 16:39:37.857602
[0m16:39:37.856739 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 16:39:37.815398 => 16:39:37.856238
[0m16:39:37.859161 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 16:39:37.843005 => 16:39:37.858885
[0m16:39:37.859588 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:39:37.859972 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:39:37.860401 [debug] [Thread-1  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:39:37.860805 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:39:37.865017 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m16:39:37.867644 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 16:39:37.861085 => 16:39:37.867409
[0m16:39:37.866281 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 16:39:37.866040 => 16:39:37.866048
[0m16:39:37.866742 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 16:39:37.866541 => 16:39:37.866548
[0m16:39:37.869605 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:39:37.865691 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 16:39:37.865384 => 16:39:37.865413
[0m16:39:37.868879 [debug] [Thread-1  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:39:37.867986 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:39:37.870439 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:39:37.871121 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 16:39:37.870909 => 16:39:37.870916
[0m16:39:37.872298 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:39:37.874527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:37.874942 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m16:39:37.875248 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m16:39:37.875543 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m16:39:37.875845 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m16:39:37.877221 [debug] [MainThread]: Command end result
[0m16:39:37.885759 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.253713, "process_user_time": 2.950067, "process_kernel_time": 0.119435, "process_mem_max_rss": "115428", "process_out_blocks": "2504", "process_in_blocks": "0"}
[0m16:39:37.886364 [debug] [MainThread]: Command `dbt compile` succeeded at 16:39:37.886243 after 7.25 seconds
[0m16:39:37.886908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b2665f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ae240dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ae90cca0>]}
[0m16:39:37.887367 [debug] [MainThread]: Flushing usage events
[0m16:39:48.143742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f18a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef80dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef805d90>]}


============================== 16:39:48.146157 | 9d4e1a23-00bb-4983-8d55-f736a15808ef ==============================
[0m16:39:48.146157 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:39:48.146767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:48.309400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0a8ee20>]}
[0m16:39:48.388104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f2184fd0>]}
[0m16:39:48.388766 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:39:48.395706 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:39:48.424672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:48.425077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:48.425703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.windingflowdev.example
[0m16:39:48.441041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18edbe5ee0>]}
[0m16:39:48.450969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18edd15df0>]}
[0m16:39:48.451406 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:39:48.451715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18edd15f40>]}
[0m16:39:48.452916 [info ] [MainThread]: 
[0m16:39:48.453495 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:48.454499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:48.463858 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:48.464482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:48.466651 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:48.466934 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:48.467188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:48.464854 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:48.468339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:51.767920 [debug] [ThreadPool]: SQL status: SELECT 7 in 3.0 seconds
[0m16:39:51.769009 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:52.358747 [debug] [ThreadPool]: SQL status: SELECT 7 in 4.0 seconds
[0m16:39:52.360213 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:52.361936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_metrics_test_windingflow)
[0m16:39:52.362566 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "metrics_test_windingflow"
"
[0m16:39:52.366716 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:39:52.367006 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: BEGIN
[0m16:39:52.367269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:54.507726 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:39:54.508141 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:39:54.508421 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "create_postgres_metrics_test_windingflow"} */
create schema if not exists "metrics_test_windingflow"
[0m16:39:54.767253 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:39:54.768216 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: COMMIT
[0m16:39:54.768546 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:39:54.768821 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: COMMIT
[0m16:39:55.004092 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:39:55.004517 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: Close
[0m16:39:55.006733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metrics_test_windingflow, now list_postgres_metrics_test)
[0m16:39:55.013824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m16:39:55.014591 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:39:55.018535 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:39:55.018881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:55.016571 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:39:55.019372 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:39:55.019898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:57.219687 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:39:57.220101 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:39:57.220416 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:39:57.230920 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:39:57.231325 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:39:57.231605 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:39:57.458212 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:39:57.459716 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:39:57.470604 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:39:57.471461 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:39:57.704144 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:39:57.707176 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:39:57.711401 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:57.711735 [debug] [MainThread]: On master: BEGIN
[0m16:39:57.712011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:00.555401 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m16:40:00.555829 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:00.556183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:01.033753 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:40:01.035119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18edbe5f10>]}
[0m16:40:01.035491 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:01.263993 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:01.264390 [debug] [MainThread]: On master: BEGIN
[0m16:40:01.719398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:40:01.719946 [debug] [MainThread]: On master: COMMIT
[0m16:40:01.720437 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:01.720819 [debug] [MainThread]: On master: COMMIT
[0m16:40:01.950782 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:40:01.951217 [debug] [MainThread]: On master: Close
[0m16:40:01.951997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:01.952329 [info ] [MainThread]: 
[0m16:40:01.954785 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:40:01.955206 [info ] [Thread-1  ]: 1 of 4 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m16:40:01.955766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m16:40:01.956077 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:40:01.965056 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:40:01.965897 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:40:01.956268 => 16:40:01.965614
[0m16:40:01.966301 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:40:02.015158 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m16:40:02.015857 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:40:02.016257 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m16:40:02.016962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:40:05.316174 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m16:40:05.316611 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:40:05.317034 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m16:40:05.564872 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:40:05.572655 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:40:05.573378 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m16:40:05.815002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:05.819030 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:40:05.819456 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m16:40:06.056479 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:06.075156 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:40:06.075673 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:40:06.076013 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:40:06.319215 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:40:06.325050 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m16:40:06.328585 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:40:06.328929 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m16:40:06.574325 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:40:06.575841 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:40:01.966501 => 16:40:06.575645
[0m16:40:06.576198 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: Close
[0m16:40:06.577448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ec319100>]}
[0m16:40:06.577973 [info ] [Thread-1  ]: 1 of 4 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 4.62s]
[0m16:40:06.578567 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:40:06.579387 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:40:06.580166 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:40:06.580613 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:40:06.579808 [info ] [Thread-3  ]: 2 of 4 START sql view model metrics_test_windingflow.purchase_items ............ [RUN]
[0m16:40:06.581108 [info ] [Thread-4  ]: 3 of 4 START sql view model metrics_test_windingflow.purchase_items_day ........ [RUN]
[0m16:40:06.583054 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:40:06.581633 [info ] [Thread-2  ]: 4 of 4 START sql view model metrics_test_windingflow.purchase_items_week ....... [RUN]
[0m16:40:06.583404 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:40:06.582278 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:40:06.583939 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.purchase_items_week)
[0m16:40:06.589156 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:40:06.588647 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:40:06.589570 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:40:06.592263 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:40:06.595580 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:40:06.596868 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:40:06.592635 => 16:40:06.596568
[0m16:40:06.597491 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:40:06.598165 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:40:06.589825 => 16:40:06.597800
[0m16:40:06.605436 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:40:06.604820 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m16:40:06.612206 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:40:06.611363 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:40:06.584194 => 16:40:06.611117
[0m16:40:06.612610 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m16:40:06.613451 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:40:06.612986 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:40:06.610569 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m16:40:06.618375 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:40:06.618778 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: BEGIN
[0m16:40:06.619127 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:40:06.617225 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m16:40:06.621404 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:40:06.622195 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m16:40:06.622561 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:40:08.783610 [debug] [Thread-4  ]: SQL status: BEGIN in 2.0 seconds
[0m16:40:08.784055 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:40:08.784598 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:40:08.784962 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m16:40:08.785419 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:40:08.785748 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select *,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
[0m16:40:09.026083 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:40:09.028894 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:40:09.029239 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m16:40:09.029703 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:40:09.032279 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:40:09.032611 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m16:40:09.262571 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:09.264155 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:40:09.264469 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:40:09.264760 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:40:09.271430 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:09.273232 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:40:09.273608 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:40:09.274009 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:40:09.453723 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m16:40:09.454172 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:40:09.454485 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:40:09.507386 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:40:09.509788 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m16:40:09.510649 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:40:09.511118 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:40:09.511478 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m16:40:09.513613 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m16:40:09.514464 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:40:09.514776 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m16:40:09.692021 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:40:09.695315 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:40:09.695681 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m16:40:09.754637 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:40:09.757057 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:40:06.613816 => 16:40:09.756861
[0m16:40:09.757388 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: Close
[0m16:40:09.758715 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18edbf5220>]}
[0m16:40:09.759275 [info ] [Thread-4  ]: 3 of 4 OK created sql view model metrics_test_windingflow.purchase_items_day ... [[32mCREATE VIEW[0m in 3.18s]
[0m16:40:09.760191 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:40:09.765694 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:40:09.767141 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:40:06.605710 => 16:40:09.766945
[0m16:40:09.767490 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: Close
[0m16:40:09.768594 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ec2bc820>]}
[0m16:40:09.769107 [info ] [Thread-3  ]: 2 of 4 OK created sql view model metrics_test_windingflow.purchase_items ....... [[32mCREATE VIEW[0m in 3.19s]
[0m16:40:09.769803 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:40:09.934468 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:09.936079 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:40:09.936406 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:40:09.936699 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:40:10.178072 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:40:10.180888 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m16:40:10.181575 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:40:10.181902 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m16:40:10.421468 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:40:10.423475 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:40:06.598472 => 16:40:10.423281
[0m16:40:10.423832 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m16:40:10.424697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e1a23-00bb-4983-8d55-f736a15808ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ec2a0580>]}
[0m16:40:10.425223 [info ] [Thread-2  ]: 4 of 4 OK created sql view model metrics_test_windingflow.purchase_items_week .. [[32mCREATE VIEW[0m in 3.84s]
[0m16:40:10.425783 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:40:10.427063 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:10.427358 [debug] [MainThread]: On master: BEGIN
[0m16:40:10.427637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:12.683795 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:40:12.684227 [debug] [MainThread]: On master: COMMIT
[0m16:40:12.684493 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:12.684760 [debug] [MainThread]: On master: COMMIT
[0m16:40:12.936175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:40:12.936615 [debug] [MainThread]: On master: Close
[0m16:40:12.937750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:12.938396 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m16:40:12.938838 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m16:40:12.939127 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m16:40:12.939382 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m16:40:12.939713 [info ] [MainThread]: 
[0m16:40:12.940043 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 24.49 seconds (24.49s).
[0m16:40:12.940982 [debug] [MainThread]: Command end result
[0m16:40:12.949979 [info ] [MainThread]: 
[0m16:40:12.950460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:12.950752 [info ] [MainThread]: 
[0m16:40:12.951051 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:40:12.951698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.852715, "process_user_time": 2.341732, "process_kernel_time": 0.104434, "process_mem_max_rss": "110368", "process_out_blocks": "1744", "process_in_blocks": "0"}
[0m16:40:12.952177 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:12.952065 after 24.85 seconds
[0m16:40:12.952484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f18a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0a8ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18edce6040>]}
[0m16:40:12.952790 [debug] [MainThread]: Flushing usage events
[0m16:41:01.842584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d38597f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d36480bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d364f3d00>]}


============================== 16:41:01.844659 | 1726f1d1-2916-4c80-8953-9fcf4e802538 ==============================
[0m16:41:01.844659 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:41:01.845118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:01.996992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d364803a0>]}
[0m16:41:02.077620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d38e90e80>]}
[0m16:41:02.078404 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:41:02.086239 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:41:02.094983 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:41:02.095474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d34b921c0>]}
[0m16:41:03.062071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.windingflow_dbt_poc.staging
- models.windingflow_dbt_poc.purchase
[0m16:41:03.068372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3417faf0>]}
[0m16:41:03.079974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3417ff40>]}
[0m16:41:03.080576 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:41:03.080948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d34a96580>]}
[0m16:41:03.082404 [info ] [MainThread]: 
[0m16:41:03.083076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:03.084096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m16:41:03.103064 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:41:03.103604 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:41:03.103895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:03.110246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m16:41:03.112973 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:41:03.113602 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:41:03.114076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:05.206536 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:41:05.206966 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:41:05.207247 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:41:05.218782 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:41:05.219187 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:41:05.219476 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:41:05.433860 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:41:05.435015 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:41:05.452005 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:41:05.452968 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:41:05.660030 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:41:05.680883 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:41:05.685801 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:05.686082 [debug] [MainThread]: On master: BEGIN
[0m16:41:05.686416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:07.892817 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:41:07.893215 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:07.893562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:41:08.376160 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:41:08.377492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1726f1d1-2916-4c80-8953-9fcf4e802538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3417c9a0>]}
[0m16:41:08.377905 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:08.616365 [debug] [MainThread]: On master: Close
[0m16:41:08.618229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:08.618617 [info ] [MainThread]: 
[0m16:41:08.620658 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:41:08.621214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m16:41:08.621709 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:41:08.629130 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:41:08.630451 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:41:08.621907 => 16:41:08.629681
[0m16:41:08.630781 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:41:08.631189 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:41:08.631003 => 16:41:08.631014
[0m16:41:08.631960 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:41:08.634266 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:41:08.635215 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:41:08.635691 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:41:08.640130 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:41:08.640654 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:41:08.642561 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:41:08.643093 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:41:08.641134 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:41:08.649521 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.purchase_items_week)
[0m16:41:08.647799 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:41:08.656972 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:41:08.643396 => 16:41:08.656536
[0m16:41:08.657330 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:41:08.657817 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:41:08.657588 => 16:41:08.657601
[0m16:41:08.658653 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:41:08.652766 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:41:08.636007 => 16:41:08.652389
[0m16:41:08.659475 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:41:08.660074 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:41:08.659724 => 16:41:08.659731
[0m16:41:08.650018 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:41:08.665030 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:41:08.641569 [debug] [Thread-1  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:41:08.660812 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:41:08.670501 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:41:08.671191 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m16:41:08.671614 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:41:08.659115 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:41:08.666160 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:41:08.661138 => 16:41:08.665743
[0m16:41:08.685914 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:41:08.683259 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m16:41:08.686362 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:41:08.686149 => 16:41:08.686159
[0m16:41:08.687768 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:41:08.688157 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:41:08.686807 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:41:08.669760 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m16:41:08.697499 [debug] [Thread-1  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:41:08.688752 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m16:41:08.695461 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m16:41:08.685400 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m16:41:08.701582 [debug] [Thread-1  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m16:41:08.702055 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:41:08.703006 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 16:41:08.671874 => 16:41:08.702693
[0m16:41:08.706330 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m16:41:08.707042 [debug] [Thread-1  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 16:41:08.698211 => 16:41:08.706808
[0m16:41:08.709271 [debug] [Thread-1  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:41:08.709708 [debug] [Thread-1  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 16:41:08.709510 => 16:41:08.709521
[0m16:41:08.708846 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 16:41:08.703372 => 16:41:08.708546
[0m16:41:08.710914 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:41:08.711450 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 16:41:08.711135 => 16:41:08.711196
[0m16:41:08.710503 [debug] [Thread-1  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:41:08.712156 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:41:08.708030 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:41:08.712963 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 16:41:08.712752 => 16:41:08.712758
[0m16:41:08.707708 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 16:41:08.689063 => 16:41:08.707489
[0m16:41:08.714478 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:41:08.714884 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 16:41:08.714690 => 16:41:08.714696
[0m16:41:08.715560 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:41:08.714127 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:41:08.716910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:08.717319 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m16:41:08.717609 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m16:41:08.717892 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m16:41:08.718220 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m16:41:08.719638 [debug] [MainThread]: Command end result
[0m16:41:08.728790 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.9285836, "process_user_time": 2.994338, "process_kernel_time": 0.120093, "process_mem_max_rss": "115528", "process_out_blocks": "2504", "process_in_blocks": "0"}
[0m16:41:08.729407 [debug] [MainThread]: Command `dbt compile` succeeded at 16:41:08.729289 after 6.93 seconds
[0m16:41:08.729769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d38597f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d34c46fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d340dcaf0>]}
[0m16:41:08.730174 [debug] [MainThread]: Flushing usage events
[0m16:45:38.351786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9a957f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c98835bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c988a8d00>]}


============================== 16:45:38.353774 | e6be10c7-ea0e-47aa-a078-91885d0c05dd ==============================
[0m16:45:38.353774 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:45:38.354196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:38.511866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6be10c7-ea0e-47aa-a078-91885d0c05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c988353a0>]}
[0m16:45:38.588551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6be10c7-ea0e-47aa-a078-91885d0c05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9b245e80>]}
[0m16:45:38.589195 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:45:38.596125 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:45:38.625662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:38.626082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:38.626762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.windingflow_dbt_poc.staging
- models.windingflow_dbt_poc.purchase
[0m16:45:38.631752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6be10c7-ea0e-47aa-a078-91885d0c05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c96c8aeb0>]}
[0m16:45:38.643727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6be10c7-ea0e-47aa-a078-91885d0c05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c96d5ddf0>]}
[0m16:45:38.644176 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:45:38.644499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6be10c7-ea0e-47aa-a078-91885d0c05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c96d5df10>]}
[0m16:45:38.645726 [info ] [MainThread]: 
[0m16:45:38.646456 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:38.647527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m16:45:38.663202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m16:45:38.661851 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:45:38.665550 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:45:38.665823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:38.665040 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:45:38.667543 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:45:38.667953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:40.974219 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:45:40.974634 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:45:40.974936 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:45:40.975317 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:45:40.975605 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:45:40.975869 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:45:41.222398 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:45:41.224099 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:45:41.224614 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:45:41.226273 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:45:41.460510 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:45:41.461457 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:45:41.466747 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:41.467100 [debug] [MainThread]: On master: BEGIN
[0m16:45:41.467397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:43.728418 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:45:43.728864 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:43.729217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:44.353558 [debug] [MainThread]: SQL status: SELECT 7 in 1.0 seconds
[0m16:45:44.355051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6be10c7-ea0e-47aa-a078-91885d0c05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c96ef2a00>]}
[0m16:45:44.355498 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:44.692244 [debug] [MainThread]: On master: Close
[0m16:45:44.693603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:44.693974 [info ] [MainThread]: 
[0m16:45:44.697340 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:45:44.697886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m16:45:44.698213 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:45:44.708355 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:45:44.709194 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:45:44.698422 => 16:45:44.708909
[0m16:45:44.709530 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:45:44.709914 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:45:44.709722 => 16:45:44.709735
[0m16:45:44.710641 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:45:44.711463 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:45:44.712039 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:45:44.712348 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:45:44.715172 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:45:44.715918 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:45:44.712533 => 16:45:44.715619
[0m16:45:44.716223 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:45:44.716593 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:45:44.716410 => 16:45:44.716420
[0m16:45:44.717271 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:45:44.717628 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:45:44.718015 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:45:44.719946 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_week'
[0m16:45:44.720263 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:45:44.723485 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:45:44.724330 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:45:44.720486 => 16:45:44.724019
[0m16:45:44.718355 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:45:44.725694 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m16:45:44.726035 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:45:44.724647 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:45:44.719232 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now model.windingflowdev.purchase_items_day)
[0m16:45:44.741786 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:45:44.736696 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:45:44.736339 => 16:45:44.736363
[0m16:45:44.718644 [debug] [Thread-1  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:45:44.751004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m16:45:44.751376 [debug] [Thread-1  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:45:44.750234 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:45:44.758647 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:45:44.759193 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m16:45:44.757969 [debug] [Thread-1  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m16:45:44.759523 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:45:44.741229 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m16:45:44.747284 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:45:44.763847 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m16:45:44.764605 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 16:45:44.726252 => 16:45:44.764336
[0m16:45:44.765502 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:45:44.742059 => 16:45:44.765182
[0m16:45:44.766320 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:45:44.766969 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:45:44.768010 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 16:45:44.767542 => 16:45:44.767554
[0m16:45:44.768792 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:45:44.768370 => 16:45:44.768402
[0m16:45:44.769985 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:45:44.770790 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:45:44.771228 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:45:44.772132 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 16:45:44.760083 => 16:45:44.771868
[0m16:45:44.773554 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:45:44.773112 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m16:45:44.772505 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 16:45:44.751701 => 16:45:44.772323
[0m16:45:44.775876 [debug] [Thread-1  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:45:44.775175 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:45:44.776480 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 16:45:44.776169 => 16:45:44.776178
[0m16:45:44.782905 [debug] [Thread-1  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:45:44.774189 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 16:45:44.773863 => 16:45:44.773871
[0m16:45:44.781968 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m16:45:44.783754 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:45:44.784878 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 16:45:44.777179 => 16:45:44.784537
[0m16:45:44.785288 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:45:44.786000 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 16:45:44.785517 => 16:45:44.785525
[0m16:45:44.786801 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:45:44.787738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:44.788031 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m16:45:44.788395 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m16:45:44.788663 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m16:45:44.788909 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m16:45:44.790917 [debug] [MainThread]: Command end result
[0m16:45:44.798178 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.488585, "process_user_time": 2.098536, "process_kernel_time": 0.07168, "process_mem_max_rss": "108300", "process_out_blocks": "1720", "process_in_blocks": "0"}
[0m16:45:44.798726 [debug] [MainThread]: Command `dbt compile` succeeded at 16:45:44.798608 after 6.49 seconds
[0m16:45:44.799057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9a957f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c94372f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c96ef28b0>]}
[0m16:45:44.799393 [debug] [MainThread]: Flushing usage events
[0m16:45:53.670744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1362eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e115a1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1159afd0>]}


============================== 16:45:53.672838 | 2cd03666-04b5-4156-835a-9e80322d65cd ==============================
[0m16:45:53.672838 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:45:53.673290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:45:53.830273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1152af40>]}
[0m16:45:53.909656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13f1ce20>]}
[0m16:45:53.910379 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:45:53.918223 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:45:53.947820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:53.948283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:53.948988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.windingflow_dbt_poc.purchase
- models.windingflow_dbt_poc.staging
[0m16:45:53.956179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0f97bf10>]}
[0m16:45:53.970760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0faaad60>]}
[0m16:45:53.971209 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:45:53.971520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0faaae80>]}
[0m16:45:53.972825 [info ] [MainThread]: 
[0m16:45:53.973458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:53.974490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:45:53.984438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:45:53.995409 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:45:53.995819 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:45:53.996918 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:45:54.002553 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:45:54.002828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:54.002212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:56.144821 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m16:45:56.146010 [debug] [ThreadPool]: On list_postgres: Close
[0m16:45:56.198120 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m16:45:56.199223 [debug] [ThreadPool]: On list_postgres: Close
[0m16:45:56.201020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_metrics_test_windingflow)
[0m16:45:56.201654 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "metrics_test_windingflow"
"
[0m16:45:56.206730 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:45:56.207208 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: BEGIN
[0m16:45:56.207492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:58.304029 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:45:58.304456 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:45:58.304747 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "create_postgres_metrics_test_windingflow"} */
create schema if not exists "metrics_test_windingflow"
[0m16:45:58.542739 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:45:58.544150 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: COMMIT
[0m16:45:58.544609 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:45:58.544947 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: COMMIT
[0m16:45:58.792535 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:45:58.793421 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: Close
[0m16:45:58.796017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m16:45:58.801861 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:45:58.802732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metrics_test_windingflow, now list_postgres_metrics_test)
[0m16:45:58.803167 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:45:58.805774 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:45:58.806404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:58.806833 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:45:58.807391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:00.964646 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:46:00.965270 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:46:00.965670 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:46:00.973410 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:46:00.974612 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:46:00.975172 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:46:01.205711 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:46:01.207117 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:46:01.213893 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:46:01.214802 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:46:01.443142 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:46:01.450819 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:46:01.454997 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:01.455393 [debug] [MainThread]: On master: BEGIN
[0m16:46:01.455690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:03.574472 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:46:03.575044 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:03.575440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:04.050411 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:46:04.051798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0faaa250>]}
[0m16:46:04.052176 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:04.285371 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:04.285980 [debug] [MainThread]: On master: BEGIN
[0m16:46:04.748338 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:46:04.748981 [debug] [MainThread]: On master: COMMIT
[0m16:46:04.749380 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:04.749713 [debug] [MainThread]: On master: COMMIT
[0m16:46:04.984084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:04.984530 [debug] [MainThread]: On master: Close
[0m16:46:04.986276 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:04.986930 [info ] [MainThread]: 
[0m16:46:04.989642 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:46:04.990079 [info ] [Thread-1  ]: 1 of 4 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m16:46:04.990790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m16:46:04.991160 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:46:05.002005 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:46:05.003492 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:46:04.991383 => 16:46:05.003162
[0m16:46:05.003889 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:46:05.047585 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m16:46:05.048638 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:46:05.049631 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m16:46:05.050333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:46:07.137017 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m16:46:07.137457 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:46:07.137785 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m16:46:07.364225 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:46:07.370179 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:46:07.370595 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m16:46:07.597790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:07.601470 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:46:07.602073 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m16:46:07.827980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:07.849451 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:46:07.850212 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:46:07.850649 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:46:08.075157 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:46:08.080860 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m16:46:08.084446 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:46:08.084800 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m16:46:08.313836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:08.315571 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:46:05.004136 => 16:46:08.315363
[0m16:46:08.315951 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: Close
[0m16:46:08.317228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0e8f41f0>]}
[0m16:46:08.317779 [info ] [Thread-1  ]: 1 of 4 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.33s]
[0m16:46:08.318846 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:46:08.319783 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:46:08.320219 [info ] [Thread-3  ]: 2 of 4 START sql view model metrics_test_windingflow.purchase_items ............ [RUN]
[0m16:46:08.320897 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:46:08.321366 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:46:08.325484 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:46:08.326736 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:46:08.321807 => 16:46:08.326310
[0m16:46:08.327154 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:46:08.331057 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m16:46:08.332199 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:46:08.332689 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:46:08.333532 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:46:08.335316 [info ] [Thread-2  ]: 4 of 4 START sql view model metrics_test_windingflow.purchase_items_week ....... [RUN]
[0m16:46:08.336238 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.purchase_items_week)
[0m16:46:08.336627 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:46:08.333158 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: BEGIN
[0m16:46:08.333992 [info ] [Thread-4  ]: 3 of 4 START sql view model metrics_test_windingflow.purchase_items_day ........ [RUN]
[0m16:46:08.342182 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:46:08.343192 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:46:08.344447 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:46:08.341504 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:46:08.349667 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:46:08.336831 => 16:46:08.349132
[0m16:46:08.350230 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:46:08.347950 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:46:08.358723 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m16:46:08.360027 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:46:08.344658 => 16:46:08.359710
[0m16:46:08.360525 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:46:08.364983 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m16:46:08.365860 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:46:08.366261 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m16:46:08.366597 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:46:08.367468 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:46:08.367832 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m16:46:08.368142 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:46:10.469998 [debug] [Thread-4  ]: SQL status: BEGIN in 2.0 seconds
[0m16:46:10.470525 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:46:10.470906 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:46:10.536625 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m16:46:10.537231 [debug] [Thread-2  ]: SQL status: BEGIN in 2.0 seconds
[0m16:46:10.537703 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:46:10.538176 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:46:10.538645 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select *,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
[0m16:46:10.539294 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:46:10.704286 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:46:10.707264 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:46:10.707669 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m16:46:10.778730 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:46:10.779306 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:46:10.783132 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:46:10.786064 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:46:10.786573 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m16:46:10.786975 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m16:46:10.937241 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:10.938974 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:46:10.939383 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:46:10.939756 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:46:11.025374 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:11.025859 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:11.027314 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:46:11.028593 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:46:11.029040 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:46:11.029446 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:46:11.029860 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:46:11.030635 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:46:11.210127 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:46:11.220421 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m16:46:11.222294 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:46:11.222970 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m16:46:11.266529 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:46:11.267411 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:46:11.271177 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m16:46:11.275431 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m16:46:11.277090 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:46:11.278822 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:46:11.279484 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m16:46:11.280374 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m16:46:11.464929 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:11.467349 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:46:08.360872 => 16:46:11.467102
[0m16:46:11.467844 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: Close
[0m16:46:11.469337 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0f164430>]}
[0m16:46:11.470075 [info ] [Thread-4  ]: 3 of 4 OK created sql view model metrics_test_windingflow.purchase_items_day ... [[32mCREATE VIEW[0m in 3.13s]
[0m16:46:11.470979 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:46:11.516991 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:11.519749 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:46:08.327398 => 16:46:11.519363
[0m16:46:11.520554 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:11.521223 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: Close
[0m16:46:11.523713 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:46:08.350656 => 16:46:11.523340
[0m16:46:11.524508 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m16:46:11.526301 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0c09f4c0>]}
[0m16:46:11.528447 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd03666-04b5-4156-835a-9e80322d65cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0c04b280>]}
[0m16:46:11.527454 [info ] [Thread-3  ]: 2 of 4 OK created sql view model metrics_test_windingflow.purchase_items ....... [[32mCREATE VIEW[0m in 3.21s]
[0m16:46:11.529638 [info ] [Thread-2  ]: 4 of 4 OK created sql view model metrics_test_windingflow.purchase_items_week .. [[32mCREATE VIEW[0m in 3.19s]
[0m16:46:11.530754 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:46:11.531778 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:46:11.539221 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:11.539730 [debug] [MainThread]: On master: BEGIN
[0m16:46:11.540165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:15.065171 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m16:46:15.065859 [debug] [MainThread]: On master: COMMIT
[0m16:46:15.066393 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:15.066833 [debug] [MainThread]: On master: COMMIT
[0m16:46:15.370702 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:15.371362 [debug] [MainThread]: On master: Close
[0m16:46:15.375422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:15.375951 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m16:46:15.376447 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m16:46:15.376907 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m16:46:15.377525 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m16:46:15.378115 [info ] [MainThread]: 
[0m16:46:15.379745 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 21.40 seconds (21.40s).
[0m16:46:15.382700 [debug] [MainThread]: Command end result
[0m16:46:15.406798 [info ] [MainThread]: 
[0m16:46:15.407976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:15.409007 [info ] [MainThread]: 
[0m16:46:15.409816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:46:15.411295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.781256, "process_user_time": 2.269579, "process_kernel_time": 0.111098, "process_mem_max_rss": "110188", "process_out_blocks": "1744", "process_in_blocks": "0"}
[0m16:46:15.412133 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:15.411928 after 21.78 seconds
[0m16:46:15.413239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1362eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0fd04eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0fba2220>]}
[0m16:46:15.413851 [debug] [MainThread]: Flushing usage events
[0m16:49:13.559392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0c073ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b09fe7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b09fe3fd0>]}


============================== 16:49:13.562406 | 6332baf1-b6dc-447f-a266-dc9bb69ae5ad ==============================
[0m16:49:13.562406 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:49:13.562839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:13.714236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b09f73f40>]}
[0m16:49:13.791161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0c961e20>]}
[0m16:49:13.791813 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:49:13.800080 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:49:13.824351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:13.824727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:13.825406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.windingflow_dbt_poc.purchase
- models.windingflow_dbt_poc.staging
[0m16:49:13.831471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b083c0f10>]}
[0m16:49:13.841374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b084ecd60>]}
[0m16:49:13.841847 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:49:13.842204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b084ece80>]}
[0m16:49:13.843550 [info ] [MainThread]: 
[0m16:49:13.844232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:13.845774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:49:13.853639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:49:13.866947 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:49:13.867414 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:49:13.868003 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:49:13.868261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:13.867728 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:49:13.871053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:16.684229 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m16:49:16.685360 [debug] [ThreadPool]: On list_postgres: Close
[0m16:49:16.761795 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m16:49:16.762896 [debug] [ThreadPool]: On list_postgres: Close
[0m16:49:16.765361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m16:49:16.770586 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:49:16.771083 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:49:16.771653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m16:49:16.771999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:16.774214 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:49:16.774823 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:49:16.775184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:19.423890 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:49:19.424311 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:49:19.424713 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:49:19.578669 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:49:19.579064 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:49:19.579410 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:49:19.708989 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:49:19.710253 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:49:19.883148 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:49:19.884212 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:49:19.995422 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:49:20.188769 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:49:20.194431 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:20.194858 [debug] [MainThread]: On master: BEGIN
[0m16:49:20.195159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:22.527751 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:49:22.528409 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:22.528863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:22.784208 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m16:49:22.786291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b08708040>]}
[0m16:49:22.786741 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:23.040489 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:23.040961 [debug] [MainThread]: On master: BEGIN
[0m16:49:23.542005 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:49:23.542509 [debug] [MainThread]: On master: COMMIT
[0m16:49:23.542963 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:23.543337 [debug] [MainThread]: On master: COMMIT
[0m16:49:23.799365 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:23.799896 [debug] [MainThread]: On master: Close
[0m16:49:23.801584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:49:23.802597 [info ] [MainThread]: 
[0m16:49:23.805000 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:49:23.805487 [info ] [Thread-1  ]: 1 of 4 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m16:49:23.806138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m16:49:23.806533 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:49:23.815479 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:49:23.816320 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:49:23.806776 => 16:49:23.816027
[0m16:49:23.816681 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:49:23.849981 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m16:49:23.850802 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:49:23.851118 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m16:49:23.851405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:26.138836 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m16:49:26.139306 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:49:26.139655 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m16:49:26.391098 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:49:26.396740 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:49:26.397108 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m16:49:26.636207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:26.639000 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:49:26.639341 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m16:49:26.895786 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:26.910517 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:49:26.910970 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:49:26.911332 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:49:27.183947 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:27.191236 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m16:49:27.194931 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:49:27.195308 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m16:49:27.466678 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:27.468348 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:49:23.816876 => 16:49:27.468144
[0m16:49:27.468715 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: Close
[0m16:49:27.469672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04ae4190>]}
[0m16:49:27.470404 [info ] [Thread-1  ]: 1 of 4 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.66s]
[0m16:49:27.470978 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:49:27.471845 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:49:27.473291 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:49:27.472268 [info ] [Thread-3  ]: 2 of 4 START sql view model metrics_test_windingflow.purchase_items ............ [RUN]
[0m16:49:27.473964 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:49:27.474434 [info ] [Thread-4  ]: 3 of 4 START sql view model metrics_test_windingflow.purchase_items_day ........ [RUN]
[0m16:49:27.475299 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:49:27.476812 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:49:27.475733 [info ] [Thread-2  ]: 4 of 4 START sql view model metrics_test_windingflow.purchase_items_week ....... [RUN]
[0m16:49:27.478315 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.purchase_items_week)
[0m16:49:27.477678 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:49:27.478691 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:49:27.477296 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:49:27.489464 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:49:27.486797 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:49:27.491382 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:49:27.483930 => 16:49:27.491072
[0m16:49:27.491840 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:49:27.482628 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:49:27.495500 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m16:49:27.490521 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:49:27.487144 => 16:49:27.490206
[0m16:49:27.496384 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:49:27.479040 => 16:49:27.496050
[0m16:49:27.496896 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:49:27.497274 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:49:27.501645 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m16:49:27.507291 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:49:27.506475 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:49:27.508633 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m16:49:27.509032 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:49:27.505715 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m16:49:27.508083 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: BEGIN
[0m16:49:27.510538 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:49:27.511135 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:49:27.512248 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m16:49:27.513820 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:49:29.797213 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m16:49:29.797666 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:49:29.798023 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select *,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
[0m16:49:29.855944 [debug] [Thread-4  ]: SQL status: BEGIN in 2.0 seconds
[0m16:49:29.856417 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:49:29.856741 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:49:30.041382 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:49:30.044074 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:49:30.044418 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m16:49:30.126334 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:49:30.132284 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:49:30.133025 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m16:49:30.321922 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:30.324171 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:49:30.324608 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:49:30.324940 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:49:30.379243 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:30.380786 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:49:30.381118 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:49:30.381412 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:49:30.568743 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:30.571508 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m16:49:30.572311 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:49:30.572678 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m16:49:30.628074 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:30.630903 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m16:49:30.631750 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:49:30.632129 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m16:49:30.814973 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:30.816442 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:49:27.497594 => 16:49:30.816230
[0m16:49:30.816783 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: Close
[0m16:49:30.818336 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04ae76a0>]}
[0m16:49:30.818967 [info ] [Thread-3  ]: 2 of 4 OK created sql view model metrics_test_windingflow.purchase_items ....... [[32mCREATE VIEW[0m in 3.34s]
[0m16:49:30.819859 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:49:30.879940 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:30.881392 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:49:27.502055 => 16:49:30.881198
[0m16:49:30.881723 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: Close
[0m16:49:30.882671 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04aa9f70>]}
[0m16:49:30.883316 [info ] [Thread-4  ]: 3 of 4 OK created sql view model metrics_test_windingflow.purchase_items_day ... [[32mCREATE VIEW[0m in 3.41s]
[0m16:49:30.883872 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:49:31.216103 [debug] [Thread-2  ]: SQL status: BEGIN in 4.0 seconds
[0m16:49:31.216566 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:49:31.217040 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:49:31.548513 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:49:31.551482 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:49:31.551844 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m16:49:31.917207 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:31.918754 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:49:31.919235 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:49:31.919561 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:49:32.347212 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:32.350814 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m16:49:32.351703 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:49:32.352093 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m16:49:32.788985 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:49:32.791077 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:49:27.492078 => 16:49:32.790869
[0m16:49:32.791533 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m16:49:32.792675 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6332baf1-b6dc-447f-a266-dc9bb69ae5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b086470d0>]}
[0m16:49:32.793274 [info ] [Thread-2  ]: 4 of 4 OK created sql view model metrics_test_windingflow.purchase_items_week .. [[32mCREATE VIEW[0m in 5.31s]
[0m16:49:32.793878 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:49:32.795295 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:32.795684 [debug] [MainThread]: On master: BEGIN
[0m16:49:32.795972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:35.125061 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:49:35.125466 [debug] [MainThread]: On master: COMMIT
[0m16:49:35.125803 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:35.126139 [debug] [MainThread]: On master: COMMIT
[0m16:49:35.372359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:35.372799 [debug] [MainThread]: On master: Close
[0m16:49:35.373932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:35.374334 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m16:49:35.374657 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m16:49:35.374919 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m16:49:35.375176 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m16:49:35.375553 [info ] [MainThread]: 
[0m16:49:35.375900 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 21.53 seconds (21.53s).
[0m16:49:35.376865 [debug] [MainThread]: Command end result
[0m16:49:35.385853 [info ] [MainThread]: 
[0m16:49:35.386336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:35.386693 [info ] [MainThread]: 
[0m16:49:35.387053 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:49:35.387761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.870127, "process_user_time": 2.177369, "process_kernel_time": 0.134054, "process_mem_max_rss": "110676", "process_out_blocks": "1736", "process_in_blocks": "0"}
[0m16:49:35.388269 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:35.388149 after 21.87 seconds
[0m16:49:35.388613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0c073ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b085a51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04aa9f10>]}
[0m16:49:35.388966 [debug] [MainThread]: Flushing usage events
[0m16:50:01.650203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ea6bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61c9e0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61c9dbd00>]}


============================== 16:50:01.652349 | c81413a3-d2eb-4a27-9159-61ece2d31212 ==============================
[0m16:50:01.652349 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:50:01.652782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:01.802624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61c9e03a0>]}
[0m16:50:01.878823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f359e80>]}
[0m16:50:01.879500 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:50:01.886560 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:50:01.909872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:01.910321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:01.910983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.windingflow_dbt_poc.staging
- models.windingflow_dbt_poc.purchase
[0m16:50:01.915745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61adb8eb0>]}
[0m16:50:01.925458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ae8cdf0>]}
[0m16:50:01.925919 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:50:01.926269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ae8cf10>]}
[0m16:50:01.927848 [info ] [MainThread]: 
[0m16:50:01.928521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:50:01.929771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:50:01.936850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:50:01.953328 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:50:01.958116 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:50:01.958470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:01.947176 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:50:01.962045 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:50:01.962558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:04.389542 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m16:50:04.390716 [debug] [ThreadPool]: On list_postgres: Close
[0m16:50:04.588457 [debug] [ThreadPool]: SQL status: SELECT 7 in 3.0 seconds
[0m16:50:04.589653 [debug] [ThreadPool]: On list_postgres: Close
[0m16:50:04.591383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_metrics_test_windingflow)
[0m16:50:04.592131 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "metrics_test_windingflow"
"
[0m16:50:04.596338 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:50:04.596638 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: BEGIN
[0m16:50:04.597051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:06.816322 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:50:06.817135 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:50:06.817442 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "create_postgres_metrics_test_windingflow"} */
create schema if not exists "metrics_test_windingflow"
[0m16:50:07.052847 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:50:07.053694 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: COMMIT
[0m16:50:07.053988 [debug] [ThreadPool]: Using postgres connection "create_postgres_metrics_test_windingflow"
[0m16:50:07.054275 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: COMMIT
[0m16:50:07.287053 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:50:07.287480 [debug] [ThreadPool]: On create_postgres_metrics_test_windingflow: Close
[0m16:50:07.289810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m16:50:07.294945 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:50:07.295517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metrics_test_windingflow, now list_postgres_metrics_test)
[0m16:50:07.295833 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:50:07.297546 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:50:07.297923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:07.298334 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:50:07.299305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:09.550054 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:50:09.550500 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:50:09.550770 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:50:09.792530 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:50:09.793711 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:50:09.832912 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:50:09.833327 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:50:09.833630 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:50:10.027009 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:50:10.122519 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:50:10.123645 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:50:10.401871 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:50:10.408586 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:10.409080 [debug] [MainThread]: On master: BEGIN
[0m16:50:10.409505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:12.679893 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:50:12.680397 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:12.680771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:12.936178 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:50:12.937619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619d90730>]}
[0m16:50:12.938228 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:13.178917 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:13.179382 [debug] [MainThread]: On master: BEGIN
[0m16:50:13.697621 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:50:13.698167 [debug] [MainThread]: On master: COMMIT
[0m16:50:13.698504 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:13.698807 [debug] [MainThread]: On master: COMMIT
[0m16:50:13.941094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:13.941568 [debug] [MainThread]: On master: Close
[0m16:50:13.942733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:13.943274 [info ] [MainThread]: 
[0m16:50:13.946327 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:50:13.946853 [info ] [Thread-1  ]: 1 of 4 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m16:50:13.947427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m16:50:13.947760 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:50:13.956052 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:50:13.956839 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:50:13.947968 => 16:50:13.956570
[0m16:50:13.957163 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:50:13.988642 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m16:50:13.989501 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:50:13.989831 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m16:50:13.990161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:50:16.660718 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m16:50:16.661173 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:50:16.661492 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m16:50:16.942015 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:50:16.947430 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:50:16.947784 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m16:50:17.237381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:17.241090 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:50:17.241444 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m16:50:17.621544 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:17.637772 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:50:17.638279 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:50:17.638665 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:50:17.966160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:50:17.972041 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m16:50:17.976297 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:50:17.976723 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m16:50:18.306085 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:18.307573 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:50:13.957405 => 16:50:18.307381
[0m16:50:18.307920 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: Close
[0m16:50:18.309319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619d323d0>]}
[0m16:50:18.310112 [info ] [Thread-1  ]: 1 of 4 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 4.36s]
[0m16:50:18.311012 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:50:18.311839 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:50:18.312643 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:50:18.313032 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:50:18.312263 [info ] [Thread-3  ]: 2 of 4 START sql view model metrics_test_windingflow.purchase_items ............ [RUN]
[0m16:50:18.313544 [info ] [Thread-4  ]: 3 of 4 START sql view model metrics_test_windingflow.purchase_items_day ........ [RUN]
[0m16:50:18.314682 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:50:18.314031 [info ] [Thread-2  ]: 4 of 4 START sql view model metrics_test_windingflow.purchase_items_week ....... [RUN]
[0m16:50:18.317141 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.purchase_items_week)
[0m16:50:18.316249 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:50:18.315358 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:50:18.321016 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:50:18.320384 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:50:18.317544 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:50:18.329148 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:50:18.329946 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:50:18.326222 => 16:50:18.329668
[0m16:50:18.330274 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:50:18.324280 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:50:18.334615 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:50:18.321344 => 16:50:18.334330
[0m16:50:18.333783 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m16:50:18.334962 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:50:18.325080 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:50:18.317791 => 16:50:18.324791
[0m16:50:18.343297 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:50:18.335646 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:50:18.340893 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m16:50:18.347750 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m16:50:18.348190 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m16:50:18.348904 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:50:18.350057 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:50:18.350467 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: BEGIN
[0m16:50:18.350802 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:50:18.352304 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:50:18.353255 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m16:50:18.353612 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:50:21.267535 [debug] [Thread-4  ]: SQL status: BEGIN in 3.0 seconds
[0m16:50:21.267955 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:50:21.268270 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:50:21.318015 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m16:50:21.318500 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:50:21.318836 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
[0m16:50:21.421624 [debug] [Thread-3  ]: SQL status: BEGIN in 3.0 seconds
[0m16:50:21.422053 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:50:21.422437 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  create view "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
    
    
  as (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select *,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
[0m16:50:21.508103 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:50:21.511194 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:50:21.511581 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m16:50:21.563040 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:50:21.565979 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:50:21.566344 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m16:50:21.664508 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:50:21.667728 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:50:21.668111 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m16:50:21.768526 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:21.770126 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:50:21.770483 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:50:21.770916 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:50:21.810272 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:21.811721 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:50:21.812042 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:50:21.812326 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:50:21.926552 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:21.928129 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:50:21.928527 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:50:21.928841 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:50:22.023681 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:50:22.026274 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m16:50:22.026991 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:50:22.027315 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m16:50:22.048364 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:50:22.051002 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m16:50:22.051960 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:50:22.052292 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m16:50:22.187704 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:50:22.190047 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m16:50:22.190780 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:50:22.191259 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop view if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m16:50:22.294240 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:22.295814 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:50:18.335875 => 16:50:22.295607
[0m16:50:22.296179 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: Close
[0m16:50:22.297237 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61848ec40>]}
[0m16:50:22.297887 [info ] [Thread-4  ]: 3 of 4 OK created sql view model metrics_test_windingflow.purchase_items_day ... [[32mCREATE VIEW[0m in 3.98s]
[0m16:50:22.298557 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:50:22.298957 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:22.301002 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:50:18.330469 => 16:50:22.300813
[0m16:50:22.301368 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m16:50:22.302988 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618470b20>]}
[0m16:50:22.304351 [info ] [Thread-2  ]: 4 of 4 OK created sql view model metrics_test_windingflow.purchase_items_week .. [[32mCREATE VIEW[0m in 3.99s]
[0m16:50:22.305266 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:50:22.443663 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:22.445162 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:50:18.343701 => 16:50:22.444961
[0m16:50:22.445525 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: Close
[0m16:50:22.446473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81413a3-d2eb-4a27-9159-61ece2d31212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6184ecbb0>]}
[0m16:50:22.447063 [info ] [Thread-3  ]: 2 of 4 OK created sql view model metrics_test_windingflow.purchase_items ....... [[32mCREATE VIEW[0m in 4.13s]
[0m16:50:22.447619 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:50:22.448889 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:22.449207 [debug] [MainThread]: On master: BEGIN
[0m16:50:22.449496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:25.787684 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m16:50:25.788114 [debug] [MainThread]: On master: COMMIT
[0m16:50:25.788572 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:25.788980 [debug] [MainThread]: On master: COMMIT
[0m16:50:26.032238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:26.032750 [debug] [MainThread]: On master: Close
[0m16:50:26.033887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:26.034182 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m16:50:26.034553 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m16:50:26.034890 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m16:50:26.035147 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m16:50:26.035646 [info ] [MainThread]: 
[0m16:50:26.036083 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 24.11 seconds (24.11s).
[0m16:50:26.037098 [debug] [MainThread]: Command end result
[0m16:50:26.044987 [info ] [MainThread]: 
[0m16:50:26.045411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:26.045687 [info ] [MainThread]: 
[0m16:50:26.045970 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:50:26.046629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.439655, "process_user_time": 2.186127, "process_kernel_time": 0.119897, "process_mem_max_rss": "110112", "process_out_blocks": "1768", "process_in_blocks": "0"}
[0m16:50:26.047115 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:26.046968 after 24.44 seconds
[0m16:50:26.047420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61ea6bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618470ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618470af0>]}
[0m16:50:26.047729 [debug] [MainThread]: Flushing usage events
[0m16:51:54.864274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f6cabd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f5c6f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f4bfc5e0>]}


============================== 16:51:54.866905 | aa2f6843-8599-4ee5-937e-cfd5a2000000 ==============================
[0m16:51:54.866905 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:51:54.867335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m16:51:55.020565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f4b8e2e0>]}
[0m16:51:55.095663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f4b898b0>]}
[0m16:51:55.096381 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:51:55.103842 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:51:55.112325 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:51:55.112776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f31fd0d0>]}
[0m16:51:56.103020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f288aa90>]}
[0m16:51:56.111544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f31b27f0>]}
[0m16:51:56.111966 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:51:56.112332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f3322370>]}
[0m16:51:56.113570 [info ] [MainThread]: 
[0m16:51:56.114176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:56.115170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m16:51:56.133472 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:51:56.133996 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:51:56.134311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:56.136436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m16:51:56.138767 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:51:56.139079 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:51:56.140051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:58.396593 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:51:58.397054 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:51:58.397358 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:51:58.645655 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:51:58.646897 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:51:58.660824 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:51:58.661264 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:51:58.661579 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:51:58.889769 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:51:58.930156 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:51:58.931471 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:51:59.198481 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:51:59.203939 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:59.204284 [debug] [MainThread]: On master: BEGIN
[0m16:51:59.204596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:01.651811 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:52:01.652256 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:01.652573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:01.924502 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m16:52:01.926551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2f6843-8599-4ee5-937e-cfd5a2000000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f2887310>]}
[0m16:52:01.926929 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:02.171146 [debug] [MainThread]: On master: Close
[0m16:52:02.173064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:02.174021 [info ] [MainThread]: 
[0m16:52:02.176899 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:52:02.177497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m16:52:02.177856 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:52:02.185292 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:52:02.186223 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:52:02.178050 => 16:52:02.185900
[0m16:52:02.186545 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:52:02.186920 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:52:02.186735 => 16:52:02.186745
[0m16:52:02.188447 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:52:02.189246 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:52:02.189891 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:52:02.190227 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:52:02.193350 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:52:02.194120 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:52:02.190425 => 16:52:02.193859
[0m16:52:02.194478 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:52:02.195739 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:52:02.196056 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:52:02.194804 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:52:02.199765 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.purchase_items_week)
[0m16:52:02.200083 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:52:02.203245 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:52:02.199212 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:52:02.206467 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:52:02.196248 => 16:52:02.205932
[0m16:52:02.206843 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:52:02.207325 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:52:02.207067 => 16:52:02.207095
[0m16:52:02.195127 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:52:02.208621 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:52:02.208422 => 16:52:02.208429
[0m16:52:02.209347 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:52:02.204963 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:52:02.200271 => 16:52:02.204134
[0m16:52:02.208204 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:52:02.210165 [debug] [Thread-1  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:52:02.215044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m16:52:02.215372 [debug] [Thread-1  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:52:02.210509 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:52:02.223922 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:52:02.223398 => 16:52:02.223439
[0m16:52:02.224961 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:52:02.225360 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:52:02.209753 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:52:02.226578 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m16:52:02.226937 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:52:02.214429 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:52:02.225963 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m16:52:02.232932 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m16:52:02.237076 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:52:02.236658 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:52:02.236184 [debug] [Thread-1  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m16:52:02.251183 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 16:52:02.215578 => 16:52:02.250652
[0m16:52:02.248280 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m16:52:02.249513 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m16:52:02.243941 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m16:52:02.251706 [debug] [Thread-1  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:52:02.252944 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 16:52:02.237359 => 16:52:02.252573
[0m16:52:02.255800 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:52:02.254955 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 16:52:02.227155 => 16:52:02.254681
[0m16:52:02.256603 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:52:02.256220 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 16:52:02.256025 => 16:52:02.256032
[0m16:52:02.257932 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m16:52:02.257052 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 16:52:02.256856 => 16:52:02.256863
[0m16:52:02.258866 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m16:52:02.254383 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 16:52:02.244272 => 16:52:02.253496
[0m16:52:02.259390 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:52:02.259824 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 16:52:02.259628 => 16:52:02.259635
[0m16:52:02.260546 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m16:52:02.255377 [debug] [Thread-1  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 16:52:02.255178 => 16:52:02.255189
[0m16:52:02.261413 [debug] [Thread-1  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m16:52:02.262649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:02.262948 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m16:52:02.263262 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m16:52:02.263545 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m16:52:02.263824 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m16:52:02.265188 [debug] [MainThread]: Command end result
[0m16:52:02.272718 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 7.451534, "process_user_time": 2.96682, "process_kernel_time": 0.080184, "process_mem_max_rss": "115356", "process_out_blocks": "2504", "process_in_blocks": "0"}
[0m16:52:02.273300 [debug] [MainThread]: Command `dbt compile` succeeded at 16:52:02.273177 after 7.45 seconds
[0m16:52:02.273660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f6cabd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f288acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f2f4bb80>]}
[0m16:52:02.274026 [debug] [MainThread]: Flushing usage events
[0m16:52:08.584364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abb1f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab9163bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab915cd60>]}


============================== 16:52:08.586712 | 6e49a5b6-a91f-4c95-ae40-11050162af12 ==============================
[0m16:52:08.586712 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:52:08.587185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:52:08.751578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab91633a0>]}
[0m16:52:08.831178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abbadee80>]}
[0m16:52:08.832106 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:52:08.839761 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:52:08.864779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:08.865181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:08.871660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab753eeb0>]}
[0m16:52:08.881638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab7668df0>]}
[0m16:52:08.882285 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:52:08.882772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab7668f10>]}
[0m16:52:08.884411 [info ] [MainThread]: 
[0m16:52:08.885047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:08.886111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:52:08.895430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:52:08.903844 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:52:08.913856 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:52:08.914298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:08.912353 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:52:08.916280 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:52:08.916638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:12.679101 [debug] [ThreadPool]: SQL status: SELECT 8 in 4.0 seconds
[0m16:52:12.680182 [debug] [ThreadPool]: On list_postgres: Close
[0m16:52:12.810408 [debug] [ThreadPool]: SQL status: SELECT 8 in 4.0 seconds
[0m16:52:12.811480 [debug] [ThreadPool]: On list_postgres: Close
[0m16:52:12.813514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m16:52:12.819123 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:52:12.819489 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m16:52:12.820039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m16:52:12.820331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:12.822608 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:52:12.823431 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m16:52:12.823730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:15.209239 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:52:15.209629 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m16:52:15.209910 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m16:52:15.470517 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:52:15.471631 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m16:52:15.599229 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:52:15.599650 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m16:52:15.599923 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m16:52:15.723998 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m16:52:15.907129 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:52:15.908312 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m16:52:16.261907 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m16:52:16.267222 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:16.267558 [debug] [MainThread]: On master: BEGIN
[0m16:52:16.267829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:18.836611 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m16:52:18.837018 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:18.837388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:19.108054 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m16:52:19.109969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab651aaf0>]}
[0m16:52:19.110380 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:19.416151 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:19.416591 [debug] [MainThread]: On master: BEGIN
[0m16:52:20.020215 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:52:20.020647 [debug] [MainThread]: On master: COMMIT
[0m16:52:20.020947 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:20.021217 [debug] [MainThread]: On master: COMMIT
[0m16:52:20.279175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:20.279697 [debug] [MainThread]: On master: Close
[0m16:52:20.280975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:20.281640 [info ] [MainThread]: 
[0m16:52:20.284357 [debug] [Thread-1  ]: Began running node model.windingflowdev.stg_purchase
[0m16:52:20.284796 [info ] [Thread-1  ]: 1 of 4 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m16:52:20.285356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m16:52:20.285697 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.stg_purchase
[0m16:52:20.294188 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m16:52:20.295266 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (compile): 16:52:20.285883 => 16:52:20.294885
[0m16:52:20.295606 [debug] [Thread-1  ]: Began executing node model.windingflowdev.stg_purchase
[0m16:52:20.331479 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m16:52:20.332298 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:52:20.332630 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m16:52:20.332990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:52:22.604978 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m16:52:22.605419 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:52:22.605750 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m16:52:22.853403 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:52:22.859205 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:52:22.859607 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m16:52:23.103743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:23.106816 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:52:23.107173 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m16:52:23.355421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:23.369198 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:52:23.369614 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:52:23.369970 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m16:52:23.614219 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:52:23.620424 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m16:52:23.624407 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m16:52:23.624746 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m16:52:23.888035 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:52:23.890139 [debug] [Thread-1  ]: Timing info for model.windingflowdev.stg_purchase (execute): 16:52:20.295794 => 16:52:23.889769
[0m16:52:23.890675 [debug] [Thread-1  ]: On model.windingflowdev.stg_purchase: Close
[0m16:52:23.892293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab4463580>]}
[0m16:52:23.892963 [info ] [Thread-1  ]: 1 of 4 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.61s]
[0m16:52:23.893542 [debug] [Thread-1  ]: Finished running node model.windingflowdev.stg_purchase
[0m16:52:23.894381 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items
[0m16:52:23.894821 [info ] [Thread-3  ]: 2 of 4 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m16:52:23.895273 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m16:52:23.895911 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m16:52:23.897236 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items
[0m16:52:23.896699 [info ] [Thread-4  ]: 3 of 4 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m16:52:23.902137 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m16:52:23.902576 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m16:52:23.901493 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m16:52:23.896268 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m16:52:23.910465 [info ] [Thread-2  ]: 4 of 4 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m16:52:23.911051 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.purchase_items_week)
[0m16:52:23.911373 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m16:52:23.914524 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m16:52:23.915527 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 16:52:23.911565 => 16:52:23.915243
[0m16:52:23.915972 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m16:52:23.907192 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (compile): 16:52:23.897497 => 16:52:23.906917
[0m16:52:23.924013 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items
[0m16:52:23.906395 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m16:52:23.931571 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 16:52:23.902768 => 16:52:23.931253
[0m16:52:23.931995 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m16:52:23.963890 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m16:52:23.964794 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m16:52:23.971864 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:52:23.972295 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m16:52:23.972966 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:52:23.974471 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:52:23.975014 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: BEGIN
[0m16:52:23.975817 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:52:23.969331 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m16:52:23.976917 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:52:23.977233 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m16:52:23.977592 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:52:26.331525 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m16:52:26.331953 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:52:26.332262 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select *,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m16:52:26.709515 [debug] [Thread-4  ]: SQL status: BEGIN in 3.0 seconds
[0m16:52:26.709957 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:52:26.710464 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m16:52:26.787581 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m16:52:26.788032 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:52:26.788367 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m16:52:26.801765 [debug] [Thread-3  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:52:26.805294 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:52:26.805669 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m16:52:26.957222 [debug] [Thread-4  ]: SQL status: SELECT 14 in 0.0 seconds
[0m16:52:26.960155 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:52:26.960522 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m16:52:27.049290 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:27.053867 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:52:27.054230 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:52:27.054541 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: COMMIT
[0m16:52:27.057954 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:52:27.060559 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:52:27.060904 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m16:52:27.218896 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:27.220893 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:52:27.221243 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:52:27.221549 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m16:52:27.295133 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:52:27.298034 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m16:52:27.300359 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m16:52:27.300697 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m16:52:27.325418 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:27.327143 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:52:27.327604 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:52:27.327919 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m16:52:27.487134 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:52:27.489576 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m16:52:27.490319 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m16:52:27.490662 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m16:52:27.538062 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:27.539510 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items (execute): 16:52:23.924347 => 16:52:27.539315
[0m16:52:27.539861 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items: Close
[0m16:52:27.540822 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab4427160>]}
[0m16:52:27.541481 [info ] [Thread-3  ]: 2 of 4 OK created sql table model metrics_test_windingflow.purchase_items ...... [[32mSELECT 15[0m in 3.65s]
[0m16:52:27.542083 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items
[0m16:52:27.597974 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:52:27.600693 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m16:52:27.601427 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m16:52:27.601757 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m16:52:27.735795 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:27.737471 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 16:52:23.932239 => 16:52:27.737277
[0m16:52:27.737818 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items_day: Close
[0m16:52:27.738795 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab64aad60>]}
[0m16:52:27.739495 [info ] [Thread-4  ]: 3 of 4 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 3.84s]
[0m16:52:27.740081 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m16:52:27.879431 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:27.880897 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 16:52:23.916320 => 16:52:27.880703
[0m16:52:27.881244 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m16:52:27.882221 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e49a5b6-a91f-4c95-ae40-11050162af12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab77c72b0>]}
[0m16:52:27.882887 [info ] [Thread-2  ]: 4 of 4 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 10[0m in 3.97s]
[0m16:52:27.883464 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m16:52:27.884880 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:27.885182 [debug] [MainThread]: On master: BEGIN
[0m16:52:27.885469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:30.061017 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:52:30.061443 [debug] [MainThread]: On master: COMMIT
[0m16:52:30.061733 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:30.062004 [debug] [MainThread]: On master: COMMIT
[0m16:52:30.293316 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:30.293783 [debug] [MainThread]: On master: Close
[0m16:52:30.294769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:30.295072 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m16:52:30.295401 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m16:52:30.295742 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m16:52:30.295986 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m16:52:30.296350 [info ] [MainThread]: 
[0m16:52:30.296685 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 21.41 seconds (21.41s).
[0m16:52:30.297657 [debug] [MainThread]: Command end result
[0m16:52:30.306284 [info ] [MainThread]: 
[0m16:52:30.306711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:30.307008 [info ] [MainThread]: 
[0m16:52:30.307325 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:52:30.307981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.766094, "process_user_time": 2.250963, "process_kernel_time": 0.120372, "process_mem_max_rss": "110692", "process_out_blocks": "1768", "process_in_blocks": "0"}
[0m16:52:30.308448 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:30.308333 after 21.77 seconds
[0m16:52:30.308760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abb1f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab91633a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab78af2e0>]}
[0m16:52:30.309075 [debug] [MainThread]: Flushing usage events
[0m17:06:53.943248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6354ccee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6333aab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63341e760>]}


============================== 17:06:53.946338 | ed38004e-b66c-4c2c-a9f8-b5fb2feb29e6 ==============================
[0m17:06:53.946338 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:06:53.947025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:54.099424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed38004e-b66c-4c2c-a9f8-b5fb2feb29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6333b3f40>]}
[0m17:06:54.178224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed38004e-b66c-4c2c-a9f8-b5fb2feb29e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe635dbae20>]}
[0m17:06:54.178978 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:06:54.187391 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:06:54.219561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:06:54.220146 [debug] [MainThread]: Partial parsing: added file: windingflowdev://models/semantic_models/purchase_items_sem.yml
[0m17:06:54.359538 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a 'metricflow_time_spine' model in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine) 
[0m17:06:54.360345 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.45922777, "process_user_time": 1.998236, "process_kernel_time": 0.095533, "process_mem_max_rss": "102408", "process_in_blocks": "80", "process_out_blocks": "16", "command_success": false}
[0m17:06:54.360821 [debug] [MainThread]: Command `dbt compile` failed at 17:06:54.360706 after 0.46 seconds
[0m17:06:54.361164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6354ccee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6317be820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6316c28b0>]}
[0m17:06:54.361483 [debug] [MainThread]: Flushing usage events
[0m17:09:24.065775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a7da0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5c76be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5ce9d30>]}


============================== 17:09:24.068201 | 05f280c2-e2d5-440a-8036-2768601de861 ==============================
[0m17:09:24.068201 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:09:24.069253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:24.222085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05f280c2-e2d5-440a-8036-2768601de861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a6fcddf0>]}
[0m17:09:24.300653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05f280c2-e2d5-440a-8036-2768601de861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a43d4e50>]}
[0m17:09:24.301516 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:09:24.309496 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:09:24.340803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:09:24.341478 [debug] [MainThread]: Partial parsing: added file: windingflowdev://models/semantic_models/purchase_items_sem.yml
[0m17:09:24.341907 [debug] [MainThread]: Partial parsing: added file: windingflowdev://models/semantic_models/metricflow_time_spine.sql
[0m17:09:24.613206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05f280c2-e2d5-440a-8036-2768601de861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a3d93430>]}
[0m17:09:24.621813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05f280c2-e2d5-440a-8036-2768601de861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a4129f10>]}
[0m17:09:24.622309 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m17:09:24.622679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f280c2-e2d5-440a-8036-2768601de861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a4129dc0>]}
[0m17:09:24.623983 [info ] [MainThread]: 
[0m17:09:24.624649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:24.625696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m17:09:24.631435 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m17:09:24.631804 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m17:09:24.632073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:24.633384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m17:09:24.635282 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m17:09:24.635593 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m17:09:24.635854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:27.111004 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:09:27.111397 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m17:09:27.111685 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m17:09:27.149899 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m17:09:27.150406 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m17:09:27.151146 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m17:09:27.369308 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:09:27.370505 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m17:09:27.421372 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:09:27.422513 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m17:09:27.613903 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m17:09:27.668467 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m17:09:27.673935 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:27.674324 [debug] [MainThread]: On master: BEGIN
[0m17:09:27.674639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:29.912146 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m17:09:29.912596 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:29.912987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:30.172788 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:09:30.174379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f280c2-e2d5-440a-8036-2768601de861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a41294f0>]}
[0m17:09:30.174866 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:30.424236 [debug] [MainThread]: On master: Close
[0m17:09:30.427053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:30.428085 [info ] [MainThread]: 
[0m17:09:30.430943 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m17:09:30.431541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m17:09:30.431866 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m17:09:30.450606 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m17:09:30.451404 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m17:09:30.451824 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m17:09:30.460936 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m17:09:30.461931 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 17:09:30.452017 => 17:09:30.461506
[0m17:09:30.462333 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m17:09:30.463119 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 17:09:30.462566 => 17:09:30.462579
[0m17:09:30.467126 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m17:09:30.466212 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m17:09:30.467749 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m17:09:30.468055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:09:30.468823 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m17:09:30.469581 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m17:09:30.469910 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m17:09:30.473342 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m17:09:30.474724 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 17:09:30.470119 => 17:09:30.474291
[0m17:09:30.475180 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m17:09:30.476238 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 17:09:30.475931 => 17:09:30.475950
[0m17:09:30.477888 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m17:09:30.478468 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m17:09:30.481486 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m17:09:30.480197 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:30.479517 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m17:09:30.483476 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m17:09:30.482838 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m17:09:30.482083 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m17:09:30.488117 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m17:09:30.484311 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:30.483910 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m17:09:30.502395 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m17:09:30.505925 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m17:09:30.506795 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 17:09:30.484707 => 17:09:30.506496
[0m17:09:30.507601 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 17:09:30.488528 => 17:09:30.507298
[0m17:09:30.508157 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m17:09:30.508613 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:30.509142 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 17:09:30.508919 => 17:09:30.508933
[0m17:09:30.510839 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m17:09:30.509999 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 17:09:30.509788 => 17:09:30.509796
[0m17:09:30.512130 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:30.509542 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 17:09:30.499344 => 17:09:30.509347
[0m17:09:30.511295 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:30.512929 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m17:09:30.514066 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 17:09:30.513853 => 17:09:30.513861
[0m17:09:30.513587 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m17:09:30.514819 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m17:09:30.512529 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:30.515234 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:30.516242 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m17:09:30.524182 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:30.523719 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m17:09:30.515664 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:30.566640 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m17:09:30.565811 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m17:09:30.567028 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:30.570806 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m17:09:30.571682 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 17:09:30.567675 => 17:09:30.571397
[0m17:09:30.572341 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 17:09:30.516589 => 17:09:30.572044
[0m17:09:30.572757 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:30.573345 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 17:09:30.524440 => 17:09:30.573042
[0m17:09:30.574678 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:30.574276 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 17:09:30.574040 => 17:09:30.574052
[0m17:09:30.573742 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:30.576606 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 17:09:30.576398 => 17:09:30.576405
[0m17:09:30.576117 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:30.575150 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 17:09:30.574945 => 17:09:30.574952
[0m17:09:30.577373 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:30.578332 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:32.844973 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m17:09:32.845575 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m17:09:32.845978 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m17:09:33.094130 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m17:09:33.095997 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m17:09:33.096601 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 17:09:30.432062 => 17:09:33.096395
[0m17:09:33.096934 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m17:09:33.097331 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 17:09:33.097139 => 17:09:33.097149
[0m17:09:33.097655 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m17:09:33.342256 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m17:09:33.343607 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m17:09:33.345063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:33.345337 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m17:09:33.345570 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m17:09:33.345846 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m17:09:33.346074 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m17:09:33.347597 [debug] [MainThread]: Command end result
[0m17:09:33.355332 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 9.332962, "process_user_time": 2.347833, "process_kernel_time": 0.111351, "process_mem_max_rss": "113156", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m17:09:33.355874 [debug] [MainThread]: Command `dbt compile` succeeded at 17:09:33.355759 after 9.33 seconds
[0m17:09:33.356242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a7da0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a4422130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a42af640>]}
[0m17:09:33.356575 [debug] [MainThread]: Flushing usage events
[0m17:09:42.037861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0cb6eecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0c9645e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0c9645700>]}


============================== 17:09:42.039872 | a1617d70-d8b5-49d7-89b2-6e0503aad093 ==============================
[0m17:09:42.039872 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:09:42.040294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:42.040675 [info ] [MainThread]: dbt version: 1.7.4
[0m17:09:42.040973 [info ] [MainThread]: python version: 3.8.10
[0m17:09:42.041262 [info ] [MainThread]: python path: /usr/bin/python3
[0m17:09:42.041547 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m17:09:42.130174 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m17:09:42.130600 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m17:09:42.130879 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m17:09:42.131307 [info ] [MainThread]: adapter type: postgres
[0m17:09:42.131583 [info ] [MainThread]: adapter version: 1.7.4
[0m17:09:42.208619 [info ] [MainThread]: Configuration:
[0m17:09:42.209041 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:09:42.209327 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:09:42.209597 [info ] [MainThread]: Required dependencies:
[0m17:09:42.209887 [debug] [MainThread]: Executing "git --help"
[0m17:09:42.216297 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:09:42.217281 [debug] [MainThread]: STDERR: "b''"
[0m17:09:42.217621 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:09:42.217957 [info ] [MainThread]: Connection:
[0m17:09:42.218309 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m17:09:42.218793 [info ] [MainThread]:   port: 5432
[0m17:09:42.219057 [info ] [MainThread]:   user: postgres
[0m17:09:42.219317 [info ] [MainThread]:   database: postgres
[0m17:09:42.219611 [info ] [MainThread]:   schema: metrics_test
[0m17:09:42.219926 [info ] [MainThread]:   connect_timeout: 10
[0m17:09:42.220294 [info ] [MainThread]:   role: None
[0m17:09:42.220559 [info ] [MainThread]:   search_path: None
[0m17:09:42.220824 [info ] [MainThread]:   keepalives_idle: 0
[0m17:09:42.221088 [info ] [MainThread]:   sslmode: None
[0m17:09:42.221347 [info ] [MainThread]:   sslcert: None
[0m17:09:42.221609 [info ] [MainThread]:   sslkey: None
[0m17:09:42.221870 [info ] [MainThread]:   sslrootcert: None
[0m17:09:42.222222 [info ] [MainThread]:   application_name: dbt
[0m17:09:42.222508 [info ] [MainThread]:   retries: 1
[0m17:09:42.222980 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:09:42.223671 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:09:42.224012 [debug] [MainThread]: Using postgres connection "debug"
[0m17:09:42.224298 [debug] [MainThread]: On debug: select 1 as id
[0m17:09:42.224574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:45.464691 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m17:09:45.466405 [debug] [MainThread]: On debug: Close
[0m17:09:45.467441 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:09:45.468053 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:09:45.469527 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4743357, "process_user_time": 1.803639, "process_kernel_time": 0.079807, "process_mem_max_rss": "100020", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m17:09:45.470470 [debug] [MainThread]: Command `dbt debug` succeeded at 17:09:45.470283 after 3.48 seconds
[0m17:09:45.471037 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:09:45.471559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0cb6eecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0cbfd6a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0c7d947f0>]}
[0m17:09:45.472260 [debug] [MainThread]: Flushing usage events
[0m17:09:53.628714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea60c14f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5eb86d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5eb869a0>]}


============================== 17:09:53.631082 | 11c562fd-91da-4b55-a5df-55b2371353e9 ==============================
[0m17:09:53.631082 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:09:53.631796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m17:09:53.785584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11c562fd-91da-4b55-a5df-55b2371353e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5fe68280>]}
[0m17:09:53.861264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11c562fd-91da-4b55-a5df-55b2371353e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5d3043a0>]}
[0m17:09:53.861959 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:09:53.868932 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:09:53.892610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:53.893055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:53.898739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11c562fd-91da-4b55-a5df-55b2371353e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5cf83cd0>]}
[0m17:09:53.902062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11c562fd-91da-4b55-a5df-55b2371353e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5d031ac0>]}
[0m17:09:53.902585 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m17:09:53.902946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11c562fd-91da-4b55-a5df-55b2371353e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5d031b20>]}
[0m17:09:53.904331 [info ] [MainThread]: 
[0m17:09:53.905008 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:53.906058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m17:09:53.914768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m17:09:53.924204 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m17:09:53.926013 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m17:09:53.926597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:53.925616 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m17:09:53.928185 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m17:09:53.928706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:56.290842 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:09:56.291240 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m17:09:56.291510 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m17:09:56.297689 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:09:56.297992 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m17:09:56.298347 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m17:09:56.557404 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:09:56.557891 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:09:56.559164 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m17:09:56.560140 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m17:09:56.802647 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m17:09:56.805768 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m17:09:56.811089 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:56.811506 [debug] [MainThread]: On master: BEGIN
[0m17:09:56.812040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:59.161479 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m17:09:59.161924 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:59.162492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:59.426300 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:09:59.427668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11c562fd-91da-4b55-a5df-55b2371353e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5c73f400>]}
[0m17:09:59.428062 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:59.678491 [debug] [MainThread]: On master: Close
[0m17:09:59.680211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:59.680891 [info ] [MainThread]: 
[0m17:09:59.683270 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m17:09:59.683789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m17:09:59.684110 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m17:09:59.692719 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m17:09:59.693733 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m17:09:59.694300 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m17:09:59.699763 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m17:09:59.700929 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 17:09:59.694546 => 17:09:59.700588
[0m17:09:59.711975 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m17:09:59.712463 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 17:09:59.712250 => 17:09:59.712262
[0m17:09:59.713208 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m17:09:59.721880 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m17:09:59.722657 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m17:09:59.723177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:09:59.724197 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m17:09:59.725016 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m17:09:59.725352 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m17:09:59.728915 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m17:09:59.729369 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m17:09:59.729737 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m17:09:59.731599 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m17:09:59.732120 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m17:09:59.731098 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m17:09:59.735704 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m17:09:59.739899 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m17:09:59.735321 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m17:09:59.741351 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 17:09:59.732321 => 17:09:59.741098
[0m17:09:59.741746 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m17:09:59.742424 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 17:09:59.742027 => 17:09:59.742037
[0m17:09:59.743227 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m17:09:59.740743 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 17:09:59.735908 => 17:09:59.740443
[0m17:09:59.744780 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m17:09:59.745212 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 17:09:59.745024 => 17:09:59.745032
[0m17:09:59.745948 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m17:09:59.744295 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 17:09:59.725547 => 17:09:59.744037
[0m17:09:59.747052 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m17:09:59.747759 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 17:09:59.747502 => 17:09:59.747509
[0m17:09:59.748624 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m17:09:59.743641 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:59.749715 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m17:09:59.750059 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:59.746453 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:59.760132 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m17:09:59.760474 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:59.765583 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m17:09:59.759433 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:59.766882 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m17:09:59.767197 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:59.766376 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 17:09:59.760668 => 17:09:59.766072
[0m17:09:59.776702 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:59.777102 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 17:09:59.776905 => 17:09:59.776914
[0m17:09:59.777791 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m17:09:59.776263 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m17:09:59.779237 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 17:09:59.750334 => 17:09:59.778874
[0m17:09:59.779556 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:59.779971 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 17:09:59.779750 => 17:09:59.779757
[0m17:09:59.780657 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m17:09:59.778168 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:59.781235 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m17:09:59.781551 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:59.774783 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m17:09:59.787494 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 17:09:59.767540 => 17:09:59.787139
[0m17:09:59.787977 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:59.788522 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 17:09:59.788251 => 17:09:59.788262
[0m17:09:59.789577 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m17:09:59.786458 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m17:09:59.790580 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 17:09:59.781741 => 17:09:59.790248
[0m17:09:59.791026 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:09:59.791584 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 17:09:59.791318 => 17:09:59.791327
[0m17:09:59.792577 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m17:10:02.290181 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m17:10:02.290696 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m17:10:02.291114 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m17:10:02.535154 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m17:10:02.545306 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m17:10:02.546184 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 17:09:59.684296 => 17:10:02.545858
[0m17:10:02.546537 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m17:10:02.546953 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 17:10:02.546754 => 17:10:02.546764
[0m17:10:02.547285 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m17:10:02.789305 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m17:10:02.790764 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m17:10:02.792163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:02.792446 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m17:10:02.792684 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m17:10:02.792914 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m17:10:02.793178 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m17:10:02.794555 [debug] [MainThread]: Command end result
[0m17:10:02.808447 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:10:02.808947 [info ] [MainThread]: Building catalog
[0m17:10:02.810519 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m17:10:02.817552 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m17:10:02.817989 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m17:10:02.818322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:05.163470 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:10:05.163898 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m17:10:05.164265 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('metrics_test_windingflow') and
           upper(tbl.relname) = upper('purchase_items_day')) or (upper(sch.nspname) = upper('metrics_test') and
           upper(tbl.relname) = upper('purchase_sync')) or (upper(sch.nspname) = upper('metrics_test_windingflow') and
           upper(tbl.relname) = upper('purchase_items')) or (upper(sch.nspname) = upper('metrics_test_windingflow') and
           upper(tbl.relname) = upper('metricflow_time_spine')) or (upper(sch.nspname) = upper('metrics_test_windingflow') and
           upper(tbl.relname) = upper('purchase_items_week')) or (upper(sch.nspname) = upper('metrics_test') and
           upper(tbl.relname) = upper('stg_purchase')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:10:05.442811 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m17:10:05.448351 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m17:10:05.717261 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m17:10:05.727848 [info ] [MainThread]: Catalog written to /home/shaw/Projects/windingflow/windingflowdev/target/catalog.json
[0m17:10:05.728677 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 12.141016, "process_user_time": 2.065442, "process_kernel_time": 0.124086, "process_mem_max_rss": "109152", "process_in_blocks": "2944", "process_out_blocks": "4752"}
[0m17:10:05.729341 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:10:05.729224 after 12.14 seconds
[0m17:10:05.729662 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:10:05.729924 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m17:10:05.730246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea60c14f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5c64f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea5fe68280>]}
[0m17:10:05.730584 [debug] [MainThread]: Flushing usage events
[0m17:24:51.212013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d8c6bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d6bc5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d6bc52b0>]}


============================== 17:24:51.214161 | e6ae5672-157e-4fd6-93ed-741f8ed565ba ==============================
[0m17:24:51.214161 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:24:51.215177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:51.368940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ae5672-157e-4fd6-93ed-741f8ed565ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d7e85220>]}
[0m17:24:51.444276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ae5672-157e-4fd6-93ed-741f8ed565ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d52d1b80>]}
[0m18:13:59.077740 [error] [MainThread]: Encountered an error:

[0m18:13:59.080754 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:13:59.081861 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 2947.9111, "process_user_time": 2.239828, "process_kernel_time": 0.119393, "process_mem_max_rss": "98164", "process_in_blocks": "104", "process_out_blocks": "2960", "command_success": false}
[0m18:13:59.082605 [debug] [MainThread]: Command `dbt docs serve` failed at 18:13:59.082461 after 2947.91 seconds
[0m18:13:59.083125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d8c6bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d519b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d519b4f0>]}
[0m18:13:59.083718 [debug] [MainThread]: Flushing usage events
[0m18:14:04.723908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892687aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89247b7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89247b7220>]}


============================== 18:14:04.726237 | 3ed65f2e-e2b1-4864-896e-2b7ad7e19268 ==============================
[0m18:14:04.726237 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:14:04.726730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:14:04.879213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ed65f2e-e2b1-4864-896e-2b7ad7e19268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89282f2fa0>]}
[0m18:14:04.955337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ed65f2e-e2b1-4864-896e-2b7ad7e19268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8927163fd0>]}
[0m18:14:04.956028 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:14:04.962546 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:14:04.987868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:04.988420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:04.994277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ed65f2e-e2b1-4864-896e-2b7ad7e19268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8922bbfaf0>]}
[0m18:14:05.006867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ed65f2e-e2b1-4864-896e-2b7ad7e19268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8922cd9a30>]}
[0m18:14:05.007723 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:14:05.008098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ed65f2e-e2b1-4864-896e-2b7ad7e19268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8922eabd30>]}
[0m18:14:05.009670 [info ] [MainThread]: 
[0m18:14:05.010647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:05.012555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m18:14:05.031211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m18:14:05.037989 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:14:05.039006 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:14:05.039350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:05.038544 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:14:05.040720 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:14:05.041238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:09.693548 [debug] [ThreadPool]: SQL status: BEGIN in 5.0 seconds
[0m18:14:09.693971 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:14:09.694311 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:14:09.899999 [debug] [ThreadPool]: SQL status: BEGIN in 5.0 seconds
[0m18:14:09.900425 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:14:09.900702 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:14:09.931167 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:14:09.932371 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:14:10.155567 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:14:10.157077 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:14:10.166686 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:14:10.411687 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:14:10.417787 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:10.418198 [debug] [MainThread]: On master: BEGIN
[0m18:14:10.418700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:13.711728 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:14:13.712148 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:13.712538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:14:13.961578 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:14:13.962923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ed65f2e-e2b1-4864-896e-2b7ad7e19268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8922c1c340>]}
[0m18:14:13.963302 [debug] [MainThread]: On master: ROLLBACK
[0m18:14:14.200890 [debug] [MainThread]: On master: Close
[0m18:14:14.202270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:14.202901 [info ] [MainThread]: 
[0m18:14:14.205934 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:14:14.206537 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m18:14:14.206843 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:14:14.215435 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:14:14.216137 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m18:14:14.216530 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:14:14.221025 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:14:14.221944 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:14:14.216735 => 18:14:14.221572
[0m18:14:14.235703 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:14:14.236358 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:14:14.236059 => 18:14:14.236071
[0m18:14:14.237294 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:14:14.241778 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:14:14.242964 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:14:14.243349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:14:14.247017 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:14:14.247765 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:14:14.248095 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:14:14.250961 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:14:14.251747 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:14:14.248288 => 18:14:14.251464
[0m18:14:14.252073 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:14:14.252452 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:14:14.252266 => 18:14:14.252275
[0m18:14:14.254424 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:14:14.256965 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:14:14.257399 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:14:14.259517 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:14:14.258677 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:14:14.260310 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:14:14.260988 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:14:14.262668 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:14:14.262029 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m18:14:14.271112 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:14:14.270388 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:14:14.266657 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:14:14.277366 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:14:14.267051 => 18:14:14.277035
[0m18:14:14.282887 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:14:14.283492 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:14:14.283253 => 18:14:14.283279
[0m18:14:14.284647 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:14:14.288881 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:14:14.288106 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m18:14:14.291066 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m18:14:14.291889 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:14:14.263070 => 18:14:14.291491
[0m18:14:14.292590 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:14:14.293063 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:14:14.298707 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m18:14:14.299318 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:14:14.299060 => 18:14:14.299075
[0m18:14:14.301781 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:14:14.302805 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:14:14.302364 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 18:14:14.293456 => 18:14:14.302125
[0m18:14:14.303542 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m18:14:14.304437 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:14:14.304015 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:14:14.309749 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 18:14:14.309494 => 18:14:14.309507
[0m18:14:14.309140 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m18:14:14.299718 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 18:14:14.271396 => 18:14:14.299522
[0m18:14:14.310580 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:14:14.311277 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:14:14.311730 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:14:14.312553 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 18:14:14.304710 => 18:14:14.312280
[0m18:14:14.313045 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 18:14:14.312837 => 18:14:14.312845
[0m18:14:14.314865 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:14:14.313593 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m18:14:14.314071 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:14:14.315295 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:14:14.315899 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 18:14:14.315678 => 18:14:14.315686
[0m18:14:14.319536 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m18:14:14.320447 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:14:14.321206 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 18:14:14.316150 => 18:14:14.320929
[0m18:14:14.321853 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:14:14.322411 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 18:14:14.322088 => 18:14:14.322108
[0m18:14:14.323501 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:14:17.524502 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m18:14:17.525023 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:14:17.525423 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:14:17.845502 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:14:17.855465 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:14:17.856262 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:14:14.207062 => 18:14:17.855982
[0m18:14:17.856753 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:14:17.857166 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:14:17.856968 => 18:14:17.856978
[0m18:14:17.857500 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m18:14:18.183459 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:14:18.185691 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:14:18.187029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:18.187339 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m18:14:18.187602 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:14:18.187843 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m18:14:18.188077 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m18:14:18.189694 [debug] [MainThread]: Command end result
[0m18:14:18.197853 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 13.515926, "process_user_time": 2.109553, "process_kernel_time": 0.088738, "process_mem_max_rss": "109252", "process_out_blocks": "1776", "process_in_blocks": "0"}
[0m18:14:18.198494 [debug] [MainThread]: Command `dbt compile` succeeded at 18:14:18.198372 after 13.52 seconds
[0m18:14:18.198833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892687aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89202b2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8927163fd0>]}
[0m18:14:18.199182 [debug] [MainThread]: Flushing usage events
[0m18:19:05.546496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e5fdccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e3f30850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e3f302b0>]}


============================== 18:19:05.548787 | c9ea1b3f-9582-4399-9a1c-138407b43f28 ==============================
[0m18:19:05.548787 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:19:05.549247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:19:05.718593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e50ce5e0>]}
[0m18:19:05.797363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e262ab80>]}
[0m18:19:05.798058 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:19:05.804486 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:19:05.830260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:05.830980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:05.836781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e233bb20>]}
[0m18:19:05.850604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e2455af0>]}
[0m18:19:05.851075 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:19:05.851582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e2455bb0>]}
[0m18:19:05.853476 [info ] [MainThread]: 
[0m18:19:05.854325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:05.855503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:19:05.856218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:19:05.876208 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:19:05.886689 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:19:05.887259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:05.889400 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:19:05.890032 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:19:05.890355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:08.193064 [debug] [ThreadPool]: SQL status: SELECT 8 in 2.0 seconds
[0m18:19:08.194201 [debug] [ThreadPool]: On list_postgres: Close
[0m18:19:08.259204 [debug] [ThreadPool]: SQL status: SELECT 8 in 2.0 seconds
[0m18:19:08.260281 [debug] [ThreadPool]: On list_postgres: Close
[0m18:19:08.262308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m18:19:08.266896 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:19:08.267354 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:19:08.267683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:08.270304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m18:19:08.272123 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:19:08.272439 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:19:08.272714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:10.722373 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:19:10.722931 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:19:10.723571 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:19:10.963517 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m18:19:10.963994 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:19:10.964329 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:19:11.045708 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:19:11.047144 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:19:11.233839 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:19:11.235086 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:19:11.289222 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:19:11.472892 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:19:11.478956 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:11.479346 [debug] [MainThread]: On master: BEGIN
[0m18:19:11.479624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:15.400599 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m18:19:15.401008 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:15.401337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:15.747083 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:19:15.749253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e258f910>]}
[0m18:19:15.749767 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:16.082983 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:16.083619 [debug] [MainThread]: On master: BEGIN
[0m18:19:16.925510 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m18:19:16.926425 [debug] [MainThread]: On master: COMMIT
[0m18:19:16.927019 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:16.927565 [debug] [MainThread]: On master: COMMIT
[0m18:19:17.401930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:17.402447 [debug] [MainThread]: On master: Close
[0m18:19:17.403424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:17.404050 [info ] [MainThread]: 
[0m18:19:17.406504 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:19:17.406976 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m18:19:17.407602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m18:19:17.407960 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:19:17.415567 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:19:17.416218 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m18:19:17.416973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m18:19:17.417442 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:19:17.422725 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:19:17.423640 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:19:17.417667 => 18:19:17.423302
[0m18:19:17.433129 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:19:17.454538 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:19:17.462649 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:19:17.463118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:17.480660 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m18:19:17.482835 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:19:17.483695 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m18:19:17.484304 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:19:21.313336 [debug] [Thread-2  ]: SQL status: BEGIN in 4.0 seconds
[0m18:19:21.313850 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:19:21.314245 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m18:19:21.558530 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:19:21.566109 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:19:21.566692 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m18:19:21.795956 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:21.798815 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:19:21.799163 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m18:19:22.017327 [debug] [Thread-1  ]: SQL status: BEGIN in 5.0 seconds
[0m18:19:22.017887 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:19:22.018249 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:19:22.047565 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:22.062187 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m18:19:22.062933 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:19:22.063355 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m18:19:22.300175 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:19:22.310244 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:19:22.310705 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:19:22.317779 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m18:19:22.318342 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:19:17.408151 => 18:19:22.318117
[0m18:19:22.322083 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:19:22.322621 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:19:22.323136 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m18:19:22.341753 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m18:19:22.342495 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:19:22.342883 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m18:19:22.575309 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:19:22.576737 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:19:17.433431 => 18:19:22.576544
[0m18:19:22.577067 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m18:19:22.578128 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e0256a00>]}
[0m18:19:22.578904 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 5.16s]
[0m18:19:22.579617 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:19:22.580802 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:19:22.581637 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:19:22.582651 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:19:22.582254 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m18:19:22.583427 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m18:19:22.586881 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:19:22.587321 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:19:22.585827 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:19:22.591755 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:19:22.584099 [info ] [Thread-2  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m18:19:22.595617 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:19:22.591275 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:19:22.596676 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:19:22.597712 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:19:22.602227 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:19:22.603632 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:19:22.598156 => 18:19:22.603291
[0m18:19:22.604082 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:19:22.607947 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m18:19:22.608908 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:19:22.609301 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m18:19:22.609652 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:19:22.611422 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:19:22.587577 => 18:19:22.611090
[0m18:19:22.611773 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:19:22.617542 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m18:19:22.618979 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:19:22.592025 => 18:19:22.618617
[0m18:19:22.619598 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:19:22.628729 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m18:19:22.629855 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:19:22.630407 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m18:19:22.631109 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:19:22.631901 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:19:22.632503 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m18:19:22.632821 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:19:22.676214 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m18:19:22.679933 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:19:22.680627 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m18:19:22.938816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:22.945259 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m18:19:22.945698 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:19:22.946110 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m18:19:23.205576 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:19:23.208589 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m18:19:23.211158 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:19:23.211504 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m18:19:23.480225 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:23.481741 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:19:22.323457 => 18:19:23.481534
[0m18:19:23.482111 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:19:23.483165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e01eaa60>]}
[0m18:19:23.483902 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 6.08s]
[0m18:19:23.484494 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:19:25.587739 [debug] [Thread-4  ]: SQL status: BEGIN in 3.0 seconds
[0m18:19:25.588219 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:19:25.588578 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select *,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m18:19:25.634404 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m18:19:25.634889 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:19:25.635233 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m18:19:25.656846 [debug] [Thread-3  ]: SQL status: BEGIN in 3.0 seconds
[0m18:19:25.657212 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:19:25.657527 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m18:19:25.842958 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m18:19:25.846871 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:19:25.847218 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items" rename to "purchase_items__dbt_backup"
[0m18:19:25.892057 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m18:19:25.894998 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:19:25.895353 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week" rename to "purchase_items_week__dbt_backup"
[0m18:19:25.902878 [debug] [Thread-3  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:19:25.905696 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:19:25.906081 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day" rename to "purchase_items_day__dbt_backup"
[0m18:19:26.097365 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:26.100408 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:19:26.100790 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m18:19:26.151337 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:26.154241 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:19:26.154589 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m18:19:26.159729 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:26.162474 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:19:26.162881 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m18:19:26.348336 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:26.350739 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: COMMIT
[0m18:19:26.351116 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:19:26.351450 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: COMMIT
[0m18:19:26.406016 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:26.408025 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m18:19:26.408376 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:19:26.408769 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m18:19:26.409129 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:26.411399 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m18:19:26.411742 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:19:26.412053 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m18:19:26.600326 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:19:26.602895 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m18:19:26.603623 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:19:26.603974 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m18:19:26.654592 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:19:26.657326 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m18:19:26.658286 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:19:26.658669 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m18:19:26.668069 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:19:26.671466 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m18:19:26.672143 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:19:26.672506 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m18:19:26.849218 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:26.850795 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:19:22.619862 => 18:19:26.850594
[0m18:19:26.851170 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m18:19:26.852256 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e00e29d0>]}
[0m18:19:26.853094 [info ] [Thread-4  ]: 3 of 5 OK created sql table model metrics_test_windingflow.purchase_items ...... [[32mSELECT 15[0m in 4.27s]
[0m18:19:26.853961 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:19:26.908666 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:26.910361 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:19:22.612121 => 18:19:26.910083
[0m18:19:26.910790 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m18:19:26.911779 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e00f74c0>]}
[0m18:19:26.912843 [info ] [Thread-3  ]: 4 of 5 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 4.33s]
[0m18:19:26.913545 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:19:26.947731 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:26.949309 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:19:22.604329 => 18:19:26.949092
[0m18:19:26.949846 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m18:19:26.952068 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9ea1b3f-9582-4399-9a1c-138407b43f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e00fb370>]}
[0m18:19:26.953102 [info ] [Thread-2  ]: 5 of 5 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 10[0m in 4.36s]
[0m18:19:26.954920 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:19:26.961932 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:26.962378 [debug] [MainThread]: On master: BEGIN
[0m18:19:26.962890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:29.208033 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:19:29.208458 [debug] [MainThread]: On master: COMMIT
[0m18:19:29.208766 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:29.209045 [debug] [MainThread]: On master: COMMIT
[0m18:19:29.474233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:29.474665 [debug] [MainThread]: On master: Close
[0m18:19:29.475639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:29.476015 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m18:19:29.476553 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:19:29.476944 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m18:19:29.477293 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m18:19:29.477729 [info ] [MainThread]: 
[0m18:19:29.478148 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 23.62 seconds (23.62s).
[0m18:19:29.479234 [debug] [MainThread]: Command end result
[0m18:19:29.538323 [info ] [MainThread]: 
[0m18:19:29.538782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:29.539132 [info ] [MainThread]: 
[0m18:19:29.539478 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:19:29.540563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.037779, "process_user_time": 2.356801, "process_kernel_time": 0.140524, "process_mem_max_rss": "111612", "process_out_blocks": "1816", "process_in_blocks": "0"}
[0m18:19:29.541461 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:29.541244 after 24.04 seconds
[0m18:19:29.542135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e5fdccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e26308b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e2694f40>]}
[0m18:19:29.542683 [debug] [MainThread]: Flushing usage events
[0m18:20:23.100417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5e49e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5cf5f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5cf5f790>]}


============================== 18:20:23.102152 | 959b56d0-8e9c-4eb1-ad09-0f134047b5e6 ==============================
[0m18:20:23.102152 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:20:23.102610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list mettrics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:20:23.103034 [info ] [MainThread]: dbt version: 1.7.4
[0m18:20:23.103338 [info ] [MainThread]: python version: 3.8.10
[0m18:20:23.103656 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:20:23.103952 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:20:23.173330 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:20:23.173774 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:20:23.174508 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:20:23.174972 [info ] [MainThread]: adapter type: postgres
[0m18:20:23.175280 [info ] [MainThread]: adapter version: 1.7.4
[0m18:20:23.243563 [info ] [MainThread]: Configuration:
[0m18:20:23.244011 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:20:23.244342 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:20:23.244662 [info ] [MainThread]: Required dependencies:
[0m18:20:23.244991 [debug] [MainThread]: Executing "git --help"
[0m18:20:23.251344 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:20:23.251981 [debug] [MainThread]: STDERR: "b''"
[0m18:20:23.252683 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:20:23.253295 [info ] [MainThread]: Connection:
[0m18:20:23.253734 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:20:23.254038 [info ] [MainThread]:   port: 5432
[0m18:20:23.254376 [info ] [MainThread]:   user: postgres
[0m18:20:23.254674 [info ] [MainThread]:   database: postgres
[0m18:20:23.254970 [info ] [MainThread]:   schema: metrics_test
[0m18:20:23.255286 [info ] [MainThread]:   connect_timeout: 10
[0m18:20:23.255583 [info ] [MainThread]:   role: None
[0m18:20:23.255881 [info ] [MainThread]:   search_path: None
[0m18:20:23.256188 [info ] [MainThread]:   keepalives_idle: 0
[0m18:20:23.256485 [info ] [MainThread]:   sslmode: None
[0m18:20:23.256782 [info ] [MainThread]:   sslcert: None
[0m18:20:23.257077 [info ] [MainThread]:   sslkey: None
[0m18:20:23.257397 [info ] [MainThread]:   sslrootcert: None
[0m18:20:23.257691 [info ] [MainThread]:   application_name: dbt
[0m18:20:23.257989 [info ] [MainThread]:   retries: 1
[0m18:20:23.258505 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:20:23.259212 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:20:23.259613 [debug] [MainThread]: Using postgres connection "debug"
[0m18:20:23.259954 [debug] [MainThread]: On debug: select 1 as id
[0m18:20:23.260308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:25.874525 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m18:20:25.875850 [debug] [MainThread]: On debug: Close
[0m18:20:25.876536 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:20:25.876879 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:20:25.877936 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8229702, "process_user_time": 2.126509, "process_kernel_time": 0.183871, "process_mem_max_rss": "147928", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m18:20:25.878600 [debug] [MainThread]: Command `cli debug` succeeded at 18:20:25.878463 after 2.82 seconds
[0m18:20:25.878948 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:20:25.879311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5e49e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5cf4bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5b6904f0>]}
[0m18:20:25.879728 [debug] [MainThread]: Flushing usage events
[0m18:20:40.188116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61636c9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616218b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616218b790>]}


============================== 18:20:40.190552 | 4de93d51-d8b3-4c47-b275-3112c99588ff ==============================
[0m18:20:40.190552 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:20:40.190968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt list metrics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:20:40.191364 [info ] [MainThread]: dbt version: 1.7.4
[0m18:20:40.191652 [info ] [MainThread]: python version: 3.8.10
[0m18:20:40.191924 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:20:40.192201 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:20:40.263417 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:20:40.263865 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:20:40.264164 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:20:40.264631 [info ] [MainThread]: adapter type: postgres
[0m18:20:40.264919 [info ] [MainThread]: adapter version: 1.7.4
[0m18:20:40.335628 [info ] [MainThread]: Configuration:
[0m18:20:40.336047 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:20:40.336345 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:20:40.336644 [info ] [MainThread]: Required dependencies:
[0m18:20:40.336941 [debug] [MainThread]: Executing "git --help"
[0m18:20:40.343830 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:20:40.344455 [debug] [MainThread]: STDERR: "b''"
[0m18:20:40.344802 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:20:40.345101 [info ] [MainThread]: Connection:
[0m18:20:40.345433 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:20:40.345706 [info ] [MainThread]:   port: 5432
[0m18:20:40.345977 [info ] [MainThread]:   user: postgres
[0m18:20:40.346258 [info ] [MainThread]:   database: postgres
[0m18:20:40.346524 [info ] [MainThread]:   schema: metrics_test
[0m18:20:40.346790 [info ] [MainThread]:   connect_timeout: 10
[0m18:20:40.347313 [info ] [MainThread]:   role: None
[0m18:20:40.347849 [info ] [MainThread]:   search_path: None
[0m18:20:40.348310 [info ] [MainThread]:   keepalives_idle: 0
[0m18:20:40.348733 [info ] [MainThread]:   sslmode: None
[0m18:20:40.349210 [info ] [MainThread]:   sslcert: None
[0m18:20:40.349622 [info ] [MainThread]:   sslkey: None
[0m18:20:40.350052 [info ] [MainThread]:   sslrootcert: None
[0m18:20:40.350363 [info ] [MainThread]:   application_name: dbt
[0m18:20:40.350630 [info ] [MainThread]:   retries: 1
[0m18:20:40.351128 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:20:40.351811 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:20:40.352250 [debug] [MainThread]: Using postgres connection "debug"
[0m18:20:40.352566 [debug] [MainThread]: On debug: select 1 as id
[0m18:20:40.352900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:43.138194 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m18:20:43.139357 [debug] [MainThread]: On debug: Close
[0m18:20:43.140332 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:20:43.140621 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:20:43.141817 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9958405, "process_user_time": 2.114503, "process_kernel_time": 0.168199, "process_mem_max_rss": "147544", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m18:20:43.142472 [debug] [MainThread]: Command `cli debug` succeeded at 18:20:43.142340 after 3.00 seconds
[0m18:20:43.142846 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:20:43.143205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61636c9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6162177d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61608be4f0>]}
[0m18:20:43.143602 [debug] [MainThread]: Flushing usage events
[0m18:21:30.385669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a747437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a732057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a73205700>]}


============================== 18:21:30.387516 | 015205e6-7d87-434d-bc20-5b1c2ea1a110 ==============================
[0m18:21:30.387516 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:21:30.387930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt list dimensions', 'send_anonymous_usage_stats': 'True'}
[0m18:21:30.388340 [info ] [MainThread]: dbt version: 1.7.4
[0m18:21:30.388627 [info ] [MainThread]: python version: 3.8.10
[0m18:21:30.388906 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:21:30.389191 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:21:30.462002 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:21:30.462451 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:21:30.463054 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:21:30.463505 [info ] [MainThread]: adapter type: postgres
[0m18:21:30.463793 [info ] [MainThread]: adapter version: 1.7.4
[0m18:21:30.533249 [info ] [MainThread]: Configuration:
[0m18:21:30.533673 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:21:30.533966 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:21:30.534285 [info ] [MainThread]: Required dependencies:
[0m18:21:30.534603 [debug] [MainThread]: Executing "git --help"
[0m18:21:30.541580 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:21:30.542351 [debug] [MainThread]: STDERR: "b''"
[0m18:21:30.542723 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:21:30.543039 [info ] [MainThread]: Connection:
[0m18:21:30.543381 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:21:30.543661 [info ] [MainThread]:   port: 5432
[0m18:21:30.543931 [info ] [MainThread]:   user: postgres
[0m18:21:30.544201 [info ] [MainThread]:   database: postgres
[0m18:21:30.544469 [info ] [MainThread]:   schema: metrics_test
[0m18:21:30.544738 [info ] [MainThread]:   connect_timeout: 10
[0m18:21:30.545009 [info ] [MainThread]:   role: None
[0m18:21:30.545282 [info ] [MainThread]:   search_path: None
[0m18:21:30.545548 [info ] [MainThread]:   keepalives_idle: 0
[0m18:21:30.545820 [info ] [MainThread]:   sslmode: None
[0m18:21:30.546086 [info ] [MainThread]:   sslcert: None
[0m18:21:30.546379 [info ] [MainThread]:   sslkey: None
[0m18:21:30.546684 [info ] [MainThread]:   sslrootcert: None
[0m18:21:30.546951 [info ] [MainThread]:   application_name: dbt
[0m18:21:30.547302 [info ] [MainThread]:   retries: 1
[0m18:21:30.547765 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:21:30.548417 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:21:30.548789 [debug] [MainThread]: Using postgres connection "debug"
[0m18:21:30.549111 [debug] [MainThread]: On debug: select 1 as id
[0m18:21:30.549413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:33.385007 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m18:21:33.386262 [debug] [MainThread]: On debug: Close
[0m18:21:33.387093 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:21:33.387634 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:21:33.388927 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.047719, "process_user_time": 2.122272, "process_kernel_time": 0.159869, "process_mem_max_rss": "147428", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m18:21:33.389599 [debug] [MainThread]: Command `cli debug` succeeded at 18:21:33.389450 after 3.05 seconds
[0m18:21:33.389991 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:21:33.390421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a747437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a718b0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a731c6b80>]}
[0m18:21:33.390857 [debug] [MainThread]: Flushing usage events
[0m18:21:41.923278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd7618790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd60d9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd60d9790>]}


============================== 18:21:41.925226 | 3260fff0-3ad4-4f91-90eb-aa8f19416cfb ==============================
[0m18:21:41.925226 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:21:41.925671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt list dimensions --help', 'send_anonymous_usage_stats': 'True'}
[0m18:21:41.926124 [info ] [MainThread]: dbt version: 1.7.4
[0m18:21:41.926429 [info ] [MainThread]: python version: 3.8.10
[0m18:21:41.926756 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:21:41.927049 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:21:41.999824 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:21:42.000455 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:21:42.000756 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:21:42.001196 [info ] [MainThread]: adapter type: postgres
[0m18:21:42.001519 [info ] [MainThread]: adapter version: 1.7.4
[0m18:21:42.069328 [info ] [MainThread]: Configuration:
[0m18:21:42.069773 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:21:42.070066 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:21:42.070368 [info ] [MainThread]: Required dependencies:
[0m18:21:42.070670 [debug] [MainThread]: Executing "git --help"
[0m18:21:42.077056 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:21:42.077721 [debug] [MainThread]: STDERR: "b''"
[0m18:21:42.078103 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:21:42.078421 [info ] [MainThread]: Connection:
[0m18:21:42.078929 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:21:42.079277 [info ] [MainThread]:   port: 5432
[0m18:21:42.079599 [info ] [MainThread]:   user: postgres
[0m18:21:42.079880 [info ] [MainThread]:   database: postgres
[0m18:21:42.080158 [info ] [MainThread]:   schema: metrics_test
[0m18:21:42.080548 [info ] [MainThread]:   connect_timeout: 10
[0m18:21:42.080847 [info ] [MainThread]:   role: None
[0m18:21:42.081125 [info ] [MainThread]:   search_path: None
[0m18:21:42.081402 [info ] [MainThread]:   keepalives_idle: 0
[0m18:21:42.081684 [info ] [MainThread]:   sslmode: None
[0m18:21:42.081960 [info ] [MainThread]:   sslcert: None
[0m18:21:42.082285 [info ] [MainThread]:   sslkey: None
[0m18:21:42.082578 [info ] [MainThread]:   sslrootcert: None
[0m18:21:42.082931 [info ] [MainThread]:   application_name: dbt
[0m18:21:42.083212 [info ] [MainThread]:   retries: 1
[0m18:21:42.083682 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:21:42.084378 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:21:42.084773 [debug] [MainThread]: Using postgres connection "debug"
[0m18:21:42.085100 [debug] [MainThread]: On debug: select 1 as id
[0m18:21:42.085412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:44.775868 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m18:21:44.777459 [debug] [MainThread]: On debug: Close
[0m18:21:44.778686 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:21:44.779406 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:21:44.780476 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9151044, "process_user_time": 2.141844, "process_kernel_time": 0.180155, "process_mem_max_rss": "147632", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m18:21:44.781226 [debug] [MainThread]: Command `cli debug` succeeded at 18:21:44.781040 after 2.92 seconds
[0m18:21:44.781694 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:21:44.782126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd7618790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd60c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd480c4f0>]}
[0m18:21:44.782662 [debug] [MainThread]: Flushing usage events
[0m18:22:31.065838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bfb915790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bfa3d6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bfa3d6790>]}


============================== 18:22:31.068105 | 636e17d2-bf3c-41de-a7b8-40a15d2ce33f ==============================
[0m18:22:31.068105 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:22:31.068500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt list dimensions --metrics purchase_total_metrics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:22:31.068887 [info ] [MainThread]: dbt version: 1.7.4
[0m18:22:31.069142 [info ] [MainThread]: python version: 3.8.10
[0m18:22:31.069384 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:22:31.069626 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:22:31.140881 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:22:31.141260 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:22:31.141529 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:22:31.141968 [info ] [MainThread]: adapter type: postgres
[0m18:22:31.142260 [info ] [MainThread]: adapter version: 1.7.4
[0m18:22:31.209037 [info ] [MainThread]: Configuration:
[0m18:22:31.209457 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:22:31.209722 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:22:31.209972 [info ] [MainThread]: Required dependencies:
[0m18:22:31.210249 [debug] [MainThread]: Executing "git --help"
[0m18:22:31.217536 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:22:31.218185 [debug] [MainThread]: STDERR: "b''"
[0m18:22:31.218587 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:22:31.218888 [info ] [MainThread]: Connection:
[0m18:22:31.219237 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:22:31.219518 [info ] [MainThread]:   port: 5432
[0m18:22:31.219768 [info ] [MainThread]:   user: postgres
[0m18:22:31.220015 [info ] [MainThread]:   database: postgres
[0m18:22:31.220285 [info ] [MainThread]:   schema: metrics_test
[0m18:22:31.220650 [info ] [MainThread]:   connect_timeout: 10
[0m18:22:31.220892 [info ] [MainThread]:   role: None
[0m18:22:31.221133 [info ] [MainThread]:   search_path: None
[0m18:22:31.221569 [info ] [MainThread]:   keepalives_idle: 0
[0m18:22:31.221834 [info ] [MainThread]:   sslmode: None
[0m18:22:31.222097 [info ] [MainThread]:   sslcert: None
[0m18:22:31.222352 [info ] [MainThread]:   sslkey: None
[0m18:22:31.222615 [info ] [MainThread]:   sslrootcert: None
[0m18:22:31.222858 [info ] [MainThread]:   application_name: dbt
[0m18:22:31.223098 [info ] [MainThread]:   retries: 1
[0m18:22:31.223535 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:22:31.224167 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:22:31.224518 [debug] [MainThread]: Using postgres connection "debug"
[0m18:22:31.224814 [debug] [MainThread]: On debug: select 1 as id
[0m18:22:31.225088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:33.669421 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m18:22:33.670640 [debug] [MainThread]: On debug: Close
[0m18:22:33.671658 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:22:33.672249 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:22:33.673288 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6534204, "process_user_time": 2.205201, "process_kernel_time": 0.120283, "process_mem_max_rss": "147568", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m18:22:33.673916 [debug] [MainThread]: Command `cli debug` succeeded at 18:22:33.673782 after 2.65 seconds
[0m18:22:33.674288 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:22:33.674658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bfb915790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bfa3c2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf8b184f0>]}
[0m18:22:33.675076 [debug] [MainThread]: Flushing usage events
[0m18:23:36.642419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb6301790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb4dc8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb4dc87c0>]}


============================== 18:23:36.644471 | 994a7e89-05fc-4630-84be-37df66784f57 ==============================
[0m18:23:36.644471 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:23:36.644891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt query --metrics purchase_total_metrics --group-by purchase_id__create_at', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:36.645341 [info ] [MainThread]: dbt version: 1.7.4
[0m18:23:36.645621 [info ] [MainThread]: python version: 3.8.10
[0m18:23:36.645889 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:23:36.646219 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:23:36.716510 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:23:36.716953 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:23:36.717241 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:23:36.717679 [info ] [MainThread]: adapter type: postgres
[0m18:23:36.717964 [info ] [MainThread]: adapter version: 1.7.4
[0m18:23:36.786197 [info ] [MainThread]: Configuration:
[0m18:23:36.786613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:23:36.786911 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:23:36.787194 [info ] [MainThread]: Required dependencies:
[0m18:23:36.787491 [debug] [MainThread]: Executing "git --help"
[0m18:23:36.793730 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:23:36.794444 [debug] [MainThread]: STDERR: "b''"
[0m18:23:36.794817 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:23:36.795121 [info ] [MainThread]: Connection:
[0m18:23:36.795473 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:23:36.795764 [info ] [MainThread]:   port: 5432
[0m18:23:36.796037 [info ] [MainThread]:   user: postgres
[0m18:23:36.796352 [info ] [MainThread]:   database: postgres
[0m18:23:36.796628 [info ] [MainThread]:   schema: metrics_test
[0m18:23:36.796901 [info ] [MainThread]:   connect_timeout: 10
[0m18:23:36.797179 [info ] [MainThread]:   role: None
[0m18:23:36.797453 [info ] [MainThread]:   search_path: None
[0m18:23:36.797727 [info ] [MainThread]:   keepalives_idle: 0
[0m18:23:36.797998 [info ] [MainThread]:   sslmode: None
[0m18:23:36.798448 [info ] [MainThread]:   sslcert: None
[0m18:23:36.798730 [info ] [MainThread]:   sslkey: None
[0m18:23:36.799005 [info ] [MainThread]:   sslrootcert: None
[0m18:23:36.799279 [info ] [MainThread]:   application_name: dbt
[0m18:23:36.799550 [info ] [MainThread]:   retries: 1
[0m18:23:36.800011 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:23:36.800700 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:23:36.801119 [debug] [MainThread]: Using postgres connection "debug"
[0m18:23:36.801442 [debug] [MainThread]: On debug: select 1 as id
[0m18:23:36.801752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:39.285449 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m18:23:39.286791 [debug] [MainThread]: On debug: Close
[0m18:23:39.287533 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:23:39.287924 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:23:39.288976 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6911125, "process_user_time": 2.167253, "process_kernel_time": 0.131769, "process_mem_max_rss": "147576", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m18:23:39.289606 [debug] [MainThread]: Command `cli debug` succeeded at 18:23:39.289469 after 2.69 seconds
[0m18:23:39.289949 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:23:39.290337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb6301790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeba31d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb346de20>]}
[0m18:23:39.290745 [debug] [MainThread]: Flushing usage events
[0m18:23:40.599697 [debug] [MainThread]: Acquiring new postgres connection 'MetricFlow_request_mf_rid__vtn7ea3k'
[0m18:23:40.600100 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__vtn7ea3k"
[0m18:23:40.600408 [debug] [MainThread]: On MetricFlow_request_mf_rid__vtn7ea3k: BEGIN
[0m18:23:40.600699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:42.905517 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:23:42.905934 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__vtn7ea3k"
[0m18:23:42.906260 [debug] [MainThread]: On MetricFlow_request_mf_rid__vtn7ea3k: -- Read Elements From Semantic Model 'purchase_items'
-- Metric Time Dimension 'create_at'
-- Pass Only Elements:
--   ['purchase_total', 'purchase_id__create_at__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', create_at) AS purchase_id__create_at__day
  , SUM(purchase_amount_usd) AS purchase_total_metrics
FROM "postgres"."metrics_test_windingflow"."purchase_items" purchase_items_src_0
GROUP BY
  DATE_TRUNC('day', create_at)
-- MF_REQUEST_METADATA: {"tag_dict": {"MF_REQUEST_ID": "mf_rid__vtn7ea3k"}}
[0m18:23:43.157466 [debug] [MainThread]: Postgres adapter: Postgres error: column "create_at" does not exist
LINE 8:   DATE_TRUNC('day', create_at) AS purchase_id__create_at__da...
                            ^
HINT:  Perhaps you meant to reference the column "purchase_items_src_0.createat".

[0m18:23:43.158011 [debug] [MainThread]: On MetricFlow_request_mf_rid__vtn7ea3k: ROLLBACK
[0m18:23:43.395285 [debug] [MainThread]: On MetricFlow_request_mf_rid__vtn7ea3k: Close
[0m18:26:37.149914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d436dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d224db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d22c4fd0>]}


============================== 18:26:37.152170 | 702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b ==============================
[0m18:26:37.152170 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:26:37.152666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:37.335599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d2254f40>]}
[0m18:26:37.414312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d4c5de20>]}
[0m18:26:37.414974 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:26:37.421506 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:26:37.445822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:37.447036 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/purchase/purchase_items.sql
[0m18:26:37.703069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cbf57730>]}
[0m18:26:37.711809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d07d6940>]}
[0m18:26:37.712253 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:26:37.712587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d07d6ac0>]}
[0m18:26:37.713879 [info ] [MainThread]: 
[0m18:26:37.714530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:26:37.715541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m18:26:37.734750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m18:26:37.745595 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:26:37.750435 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:26:37.750701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:37.750043 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:26:37.751951 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:26:37.752245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:39.896979 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:26:39.897379 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:26:39.897668 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:26:40.227558 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:26:40.227958 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:26:40.228454 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:26:40.233339 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:26:40.234473 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:26:40.460819 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:26:40.503660 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:26:40.504841 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:26:40.742303 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:26:40.748248 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:40.748608 [debug] [MainThread]: On master: BEGIN
[0m18:26:40.748889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:43.573988 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:26:43.574414 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:43.574870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:43.853149 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:26:43.854877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '702bc9d5-a2b1-4e9e-a47e-907e9d58cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cbf88b50>]}
[0m18:26:43.855350 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:44.115382 [debug] [MainThread]: On master: Close
[0m18:26:44.116810 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:44.117483 [info ] [MainThread]: 
[0m18:26:44.120274 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:26:44.120863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m18:26:44.121186 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:26:44.142675 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:26:44.143367 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m18:26:44.143705 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:26:44.150480 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:26:44.158979 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:26:44.143895 => 18:26:44.158616
[0m18:26:44.159357 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:26:44.159754 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:26:44.159560 => 18:26:44.159571
[0m18:26:44.160620 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:26:44.161163 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:26:44.161531 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:26:44.161840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:26:44.163454 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:26:44.164194 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:26:44.164526 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:26:44.171031 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:26:44.171929 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:26:44.172406 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:26:44.177360 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:26:44.178219 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:26:44.173106 => 18:26:44.177928
[0m18:26:44.178686 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:26:44.179292 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:26:44.179092 => 18:26:44.179103
[0m18:26:44.180019 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:26:44.180435 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:26:44.181023 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now model.windingflowdev.purchase_items_week)
[0m18:26:44.181471 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:26:44.187105 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:26:44.187556 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:26:44.188226 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m18:26:44.191094 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:26:44.192725 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:26:44.193232 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:26:44.181685 => 18:26:44.192993
[0m18:26:44.204990 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:26:44.207106 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:26:44.206887 => 18:26:44.206899
[0m18:26:44.206657 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m18:26:44.207937 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:26:44.199424 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:26:44.164717 => 18:26:44.199040
[0m18:26:44.209105 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:26:44.209740 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:26:44.209431 => 18:26:44.209439
[0m18:26:44.210467 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:26:44.208666 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:26:44.211115 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m18:26:44.212214 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:26:44.211872 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:26:44.212693 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 18:26:44.193875 => 18:26:44.212478
[0m18:26:44.254788 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m18:26:44.259822 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m18:26:44.260592 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:26:44.261402 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:26:44.262668 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 18:26:44.262385 => 18:26:44.262399
[0m18:26:44.266748 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m18:26:44.268556 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 18:26:44.212900 => 18:26:44.267261
[0m18:26:44.270550 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:26:44.270204 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 18:26:44.263080 => 18:26:44.269913
[0m18:26:44.271383 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:26:44.271017 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 18:26:44.270815 => 18:26:44.270823
[0m18:26:44.272582 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:26:44.271796 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 18:26:44.271601 => 18:26:44.271608
[0m18:26:44.269456 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:26:44.273010 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:26:44.273867 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:26:44.274607 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m18:26:44.275199 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:26:44.280217 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m18:26:44.281415 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 18:26:44.275616 => 18:26:44.281066
[0m18:26:44.281836 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:26:44.282344 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 18:26:44.282082 => 18:26:44.282117
[0m18:26:44.283164 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:26:46.667867 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m18:26:46.668624 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:26:46.668954 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:26:46.958837 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.969829 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:26:46.971008 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:26:44.121376 => 18:26:46.970604
[0m18:26:46.971555 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:26:46.972161 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:26:46.971863 => 18:26:46.971878
[0m18:26:46.972656 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m18:26:47.269797 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:26:47.271200 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:26:47.272485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:47.272770 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m18:26:47.273008 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:26:47.273244 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m18:26:47.273474 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m18:26:47.274863 [debug] [MainThread]: Command end result
[0m18:26:47.283118 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 10.178124, "process_user_time": 2.388231, "process_kernel_time": 0.120415, "process_mem_max_rss": "113824", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m18:26:47.283668 [debug] [MainThread]: Command `dbt compile` succeeded at 18:26:47.283552 after 10.18 seconds
[0m18:26:47.284001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d436dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d4c5de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d08861f0>]}
[0m18:26:47.284335 [debug] [MainThread]: Flushing usage events
[0m18:46:51.882720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e46acdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e45bc4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e44a205e0>]}


============================== 18:46:51.885011 | cc6bde28-183b-4475-b233-4c860fcb64e8 ==============================
[0m18:46:51.885011 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:46:51.885500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:46:52.048221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc6bde28-183b-4475-b233-4c860fcb64e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e449b22e0>]}
[0m18:46:52.126955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc6bde28-183b-4475-b233-4c860fcb64e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e449ad8b0>]}
[0m18:46:52.127683 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:46:52.135418 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:46:52.159789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:52.160908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:52.167344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc6bde28-183b-4475-b233-4c860fcb64e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e42e19b50>]}
[0m18:46:52.178641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc6bde28-183b-4475-b233-4c860fcb64e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e42f33b20>]}
[0m18:46:52.179121 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:46:52.179478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6bde28-183b-4475-b233-4c860fcb64e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e42f33ac0>]}
[0m18:46:52.181954 [info ] [MainThread]: 
[0m18:46:52.182717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:46:52.183885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m18:46:52.189983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m18:46:52.194982 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:46:52.197302 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:46:52.206922 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:46:52.207259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:52.206428 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:46:52.208784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:54.631456 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:46:54.631945 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:46:54.632261 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:46:54.890909 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:46:54.892111 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:46:55.147748 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:46:55.216535 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m18:46:55.216921 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:46:55.217195 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:46:55.499704 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:46:55.500812 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:46:55.800177 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:46:55.805740 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:55.806161 [debug] [MainThread]: On master: BEGIN
[0m18:46:55.806457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:58.238351 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:46:58.238764 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:58.239331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:46:58.492754 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:46:58.494225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6bde28-183b-4475-b233-4c860fcb64e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e42e74430>]}
[0m18:46:58.494748 [debug] [MainThread]: On master: ROLLBACK
[0m18:46:58.779047 [debug] [MainThread]: On master: Close
[0m18:46:58.780197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:58.780721 [info ] [MainThread]: 
[0m18:46:58.783829 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:46:58.784490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m18:46:58.784813 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:46:58.798419 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:46:58.799244 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m18:46:58.799683 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:46:58.842659 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:46:58.843252 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:46:58.844574 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:46:58.854546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:58.855385 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:46:58.799973 => 18:46:58.855108
[0m18:46:58.855726 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:46:58.856116 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:46:58.855919 => 18:46:58.855931
[0m18:46:58.857165 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:46:58.862595 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:46:58.863566 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:46:58.863904 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:46:58.866682 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:46:58.867063 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:46:58.867436 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:46:58.870680 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:46:58.872457 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:46:58.871333 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:46:58.864099 => 18:46:58.871085
[0m18:46:58.877462 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:46:58.877905 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:46:58.877696 => 18:46:58.877706
[0m18:46:58.871842 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:46:58.879509 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:46:58.876962 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:46:58.879059 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:46:58.888662 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:46:58.891512 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m18:46:58.890482 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:46:58.872853 => 18:46:58.889894
[0m18:46:58.892606 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:46:58.892060 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:46:58.887276 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:46:58.893257 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:46:58.892912 => 18:46:58.892927
[0m18:46:58.911323 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:46:58.912867 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:46:58.913684 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:46:58.879749 => 18:46:58.913390
[0m18:46:58.923498 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:46:58.922932 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m18:46:58.924198 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:46:58.923849 => 18:46:58.923863
[0m18:46:58.925793 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:46:58.924786 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:46:58.926448 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:46:58.933485 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m18:46:58.938355 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:46:58.944916 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m18:46:58.941500 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m18:46:58.945877 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 18:46:58.926934 => 18:46:58.945471
[0m18:46:58.922025 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m18:46:58.946223 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:46:58.947384 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 18:46:58.947174 => 18:46:58.947185
[0m18:46:58.948259 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:46:58.948676 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:46:58.946921 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 18:46:58.893571 => 18:46:58.946613
[0m18:46:58.952746 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:46:58.952322 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m18:46:58.953180 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 18:46:58.952971 => 18:46:58.952980
[0m18:46:58.954469 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:46:58.953577 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:46:58.950741 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 18:46:58.941779 => 18:46:58.950442
[0m18:46:58.958612 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:46:58.959041 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 18:46:58.958831 => 18:46:58.958840
[0m18:46:58.959784 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:46:58.958186 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m18:46:58.960746 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 18:46:58.954821 => 18:46:58.960438
[0m18:46:58.961095 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:46:58.961530 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 18:46:58.961315 => 18:46:58.961322
[0m18:46:58.962286 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:47:01.507518 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m18:47:01.508095 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:47:01.508489 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:47:01.767019 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:47:01.778657 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:47:01.779697 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:46:58.784999 => 18:47:01.779442
[0m18:47:01.780071 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:47:01.780494 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:47:01.780294 => 18:47:01.780304
[0m18:47:01.780832 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m18:47:02.095247 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:47:02.097519 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:47:02.098804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:02.099095 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:47:02.099356 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m18:47:02.099595 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m18:47:02.099832 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m18:47:02.101530 [debug] [MainThread]: Command end result
[0m18:47:02.109219 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 10.2700615, "process_user_time": 2.096555, "process_kernel_time": 0.104827, "process_mem_max_rss": "109036", "process_out_blocks": "1776", "process_in_blocks": "0"}
[0m18:47:02.109782 [debug] [MainThread]: Command `dbt compile` succeeded at 18:47:02.109658 after 10.27 seconds
[0m18:47:02.110233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e46acdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e449ad8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e41d85f40>]}
[0m18:47:02.110667 [debug] [MainThread]: Flushing usage events
[0m18:51:58.065559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd09af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22baf93bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bb006d00>]}


============================== 18:51:58.067680 | d2d3c487-c0bb-4410-9d16-5a4e06390a98 ==============================
[0m18:51:58.067680 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:51:58.068138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:58.230347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22baf933a0>]}
[0m18:51:58.309310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd988e80>]}
[0m18:51:58.310062 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:51:58.318148 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:51:58.348131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:58.348560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:58.354746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b93ffbb0>]}
[0m18:51:58.366621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b94b5c40>]}
[0m18:51:58.367899 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:51:58.368308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b94b5b50>]}
[0m18:51:58.370663 [info ] [MainThread]: 
[0m18:51:58.371517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:58.372789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:51:58.373954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:51:58.402223 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:51:58.402656 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:51:58.403015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:58.411080 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:51:58.411514 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:51:58.411805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:01.184566 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m18:52:01.186253 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:01.481096 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m18:52:01.482291 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:01.485046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m18:52:01.489831 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:52:01.490436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m18:52:01.491399 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:52:01.492906 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:52:01.493306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:01.493616 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:52:01.494465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:03.747019 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:52:03.747475 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:52:03.747778 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:52:03.801504 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:52:03.801891 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:52:03.802202 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:52:03.992257 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:52:03.993381 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:52:04.051798 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:52:04.052911 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:52:04.233630 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:52:04.297937 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:52:04.303758 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:04.304078 [debug] [MainThread]: On master: BEGIN
[0m18:52:04.304324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:06.939264 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:52:06.939722 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:06.940048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:07.319321 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:52:07.320817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b9671a60>]}
[0m18:52:07.321210 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:07.690006 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:07.690417 [debug] [MainThread]: On master: BEGIN
[0m18:52:08.479398 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m18:52:08.479811 [debug] [MainThread]: On master: COMMIT
[0m18:52:08.480080 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:08.480336 [debug] [MainThread]: On master: COMMIT
[0m18:52:08.885351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:08.885770 [debug] [MainThread]: On master: Close
[0m18:52:08.886798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:08.887144 [info ] [MainThread]: 
[0m18:52:08.890545 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:52:08.891601 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:52:08.891288 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m18:52:08.892534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m18:52:08.892845 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:52:08.891967 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m18:52:08.906710 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m18:52:08.907145 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:52:08.912062 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:52:08.930200 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:08.930886 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:52:08.907377 => 18:52:08.930615
[0m18:52:08.931213 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:52:08.931608 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:52:08.931983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:08.991901 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m18:52:08.992989 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:52:08.993435 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m18:52:08.993856 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:11.132814 [debug] [Thread-2  ]: SQL status: BEGIN in 2.0 seconds
[0m18:52:11.133431 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:52:11.133838 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from source
  );
[0m18:52:11.363554 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:11.370766 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:52:11.371184 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m18:52:11.560578 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m18:52:11.561018 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:11.561329 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:52:11.600835 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:11.603780 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:52:11.604152 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m18:52:11.805232 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:52:11.815564 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:52:11.816479 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:52:08.893080 => 18:52:11.816159
[0m18:52:11.816824 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:52:11.836661 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m18:52:11.837196 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:11.856430 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m18:52:11.856921 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:52:11.857489 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:11.857932 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m18:52:11.858505 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m18:52:12.085904 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:12.091715 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m18:52:12.096289 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:52:12.096694 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m18:52:12.144182 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m18:52:12.147428 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:12.147849 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m18:52:12.326657 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:12.328424 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:52:08.932209 => 18:52:12.328220
[0m18:52:12.328814 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m18:52:12.330461 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b83362b0>]}
[0m18:52:12.331044 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.42s]
[0m18:52:12.331611 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:52:12.332312 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:52:12.332746 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m18:52:12.333400 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:52:12.333739 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:52:12.336701 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:52:12.338111 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:52:12.333950 => 18:52:12.337834
[0m18:52:12.338486 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:52:12.337193 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:52:12.345687 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m18:52:12.346459 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres, now model.windingflowdev.purchase_items_day)
[0m18:52:12.346933 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:52:12.348189 [info ] [Thread-2  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m18:52:12.347623 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:52:12.348779 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:52:12.353813 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:52:12.345200 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m18:52:12.360513 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:52:12.360859 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m18:52:12.359634 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:52:12.352718 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:52:12.362641 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:52:12.349030 => 18:52:12.362376
[0m18:52:12.362970 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:52:12.361979 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:52:12.354064 => 18:52:12.361633
[0m18:52:12.361203 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:52:12.370445 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:52:12.375971 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m18:52:12.369114 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m18:52:12.377506 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:52:12.377846 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m18:52:12.378183 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:12.376857 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:52:12.378828 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m18:52:12.379163 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:12.395210 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:12.398744 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:12.399211 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m18:52:12.664703 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:12.672951 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m18:52:12.673546 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:12.673910 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m18:52:12.931100 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:12.933934 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m18:52:12.938075 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:52:12.938578 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m18:52:13.183241 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:13.184735 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:52:11.817269 => 18:52:13.184536
[0m18:52:13.185137 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:52:13.186659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b828f2e0>]}
[0m18:52:13.187687 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 4.29s]
[0m18:52:13.188283 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:52:14.774498 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m18:52:14.774943 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:52:14.775263 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m18:52:14.867093 [debug] [Thread-4  ]: SQL status: BEGIN in 3.0 seconds
[0m18:52:14.867544 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:52:14.867888 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select purchase_id,
    nubmer,
    tenant_id,
    app_id,
    sku,
    qty,
    amount,
    amount_rmb,
    unit,
    create_at,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m18:52:15.024672 [debug] [Thread-3  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:52:15.027625 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:52:15.027970 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day" rename to "purchase_items_day__dbt_backup"
[0m18:52:15.122788 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column "purchase_id" does not exist
LINE 23:     select purchase_id,
                    ^

[0m18:52:15.123238 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: ROLLBACK
[0m18:52:15.165691 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m18:52:15.166215 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:52:15.166556 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m18:52:15.266201 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:15.269138 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:52:15.269691 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m18:52:15.378369 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:52:12.338725 => 18:52:15.377943
[0m18:52:15.378783 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m18:52:15.384220 [debug] [Thread-4  ]: Database Error in model purchase_items (models/purchase/purchase_items.sql)
  column "purchase_id" does not exist
  LINE 23:     select purchase_id,
                      ^
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m18:52:15.384739 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b8387820>]}
[0m18:52:15.385255 [error] [Thread-4  ]: 3 of 5 ERROR creating sql table model metrics_test_windingflow.purchase_items .. [[31mERROR[0m in 3.05s]
[0m18:52:15.385792 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:52:15.491003 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m18:52:15.494545 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:52:15.494951 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week" rename to "purchase_items_week__dbt_backup"
[0m18:52:15.507166 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:15.509643 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m18:52:15.510133 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:52:15.510531 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m18:52:15.752775 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:15.755600 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m18:52:15.756476 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:52:15.756821 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m18:52:15.842483 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:15.845281 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:52:15.845621 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m18:52:16.003245 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:16.004840 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:52:12.363164 => 18:52:16.004629
[0m18:52:16.005219 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m18:52:16.006083 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b81fb460>]}
[0m18:52:16.006707 [info ] [Thread-3  ]: 4 of 5 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 3.66s]
[0m18:52:16.007293 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:52:16.177446 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:16.179711 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m18:52:16.180136 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:52:16.180481 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m18:52:16.476900 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:16.479629 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m18:52:16.480403 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:52:16.480730 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m18:52:16.739996 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:16.741463 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:52:12.370875 => 18:52:16.741270
[0m18:52:16.741814 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m18:52:16.742887 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d3c487-c0bb-4410-9d16-5a4e06390a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b93de070>]}
[0m18:52:16.743659 [info ] [Thread-2  ]: 5 of 5 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 10[0m in 4.39s]
[0m18:52:16.744210 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:52:16.745583 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:16.745875 [debug] [MainThread]: On master: BEGIN
[0m18:52:16.746220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:19.758893 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:52:19.759339 [debug] [MainThread]: On master: COMMIT
[0m18:52:19.759652 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:19.759940 [debug] [MainThread]: On master: COMMIT
[0m18:52:20.105290 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:20.105892 [debug] [MainThread]: On master: Close
[0m18:52:20.107463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:20.107995 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m18:52:20.108260 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m18:52:20.108517 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:52:20.108772 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m18:52:20.109119 [info ] [MainThread]: 
[0m18:52:20.109449 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 21.74 seconds (21.74s).
[0m18:52:20.110558 [debug] [MainThread]: Command end result
[0m18:52:20.119142 [info ] [MainThread]: 
[0m18:52:20.119569 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:52:20.119866 [info ] [MainThread]: 
[0m18:52:20.120160 [error] [MainThread]:   Database Error in model purchase_items (models/purchase/purchase_items.sql)
  column "purchase_id" does not exist
  LINE 23:     select purchase_id,
                      ^
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m18:52:20.120742 [info ] [MainThread]: 
[0m18:52:20.121479 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:52:20.122345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.099264, "process_user_time": 2.263513, "process_kernel_time": 0.158564, "process_mem_max_rss": "112108", "process_in_blocks": "224", "process_out_blocks": "1824", "command_success": false}
[0m18:52:20.122843 [debug] [MainThread]: Command `dbt run` failed at 18:52:20.122722 after 22.10 seconds
[0m18:52:20.123182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd09af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b837fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b94b5ac0>]}
[0m18:52:20.123520 [debug] [MainThread]: Flushing usage events
[0m18:52:53.553925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37029d7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37008aebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3700921d30>]}


============================== 18:52:53.556678 | 8a28ca63-29ca-47c7-a5ff-544f5bc3eff7 ==============================
[0m18:52:53.556678 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:52:53.557462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:53.712213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a28ca63-29ca-47c7-a5ff-544f5bc3eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3701c08df0>]}
[0m18:52:53.791442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a28ca63-29ca-47c7-a5ff-544f5bc3eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ff00ae50>]}
[0m18:52:53.792481 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:52:53.799345 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:52:53.824243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:53.824908 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/staging/stg_purchase.sql
[0m18:52:54.082867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a28ca63-29ca-47c7-a5ff-544f5bc3eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36fea2bb80>]}
[0m18:52:54.091846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a28ca63-29ca-47c7-a5ff-544f5bc3eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36fee34a60>]}
[0m18:52:54.092291 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:52:54.092916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a28ca63-29ca-47c7-a5ff-544f5bc3eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36fee34b80>]}
[0m18:52:54.094546 [info ] [MainThread]: 
[0m18:52:54.095253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:54.096318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m18:52:54.105562 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:52:54.106470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m18:52:54.106793 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:52:54.114685 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:52:54.115159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:54.115535 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:52:54.116037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:57.425860 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m18:52:57.426252 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:52:57.426522 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:52:57.668518 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:52:57.669715 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:52:57.909455 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:52:59.044076 [debug] [ThreadPool]: SQL status: BEGIN in 5.0 seconds
[0m18:52:59.044481 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:52:59.044770 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:52:59.489206 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:52:59.490414 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:52:59.927457 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:52:59.934665 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:59.935052 [debug] [MainThread]: On master: BEGIN
[0m18:52:59.935335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:03.314354 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:53:03.314784 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:03.315112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:03.618927 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:53:03.620396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a28ca63-29ca-47c7-a5ff-544f5bc3eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36fd970e20>]}
[0m18:53:03.620784 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:03.870728 [debug] [MainThread]: On master: Close
[0m18:53:03.872317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:03.872908 [info ] [MainThread]: 
[0m18:53:03.875740 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:53:03.876380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m18:53:03.876709 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:53:03.886431 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:53:03.887134 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m18:53:03.887488 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:53:03.891407 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:53:03.892342 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:53:03.887691 => 18:53:03.892053
[0m18:53:03.907801 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:53:03.908425 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:53:03.908196 => 18:53:03.908211
[0m18:53:03.909262 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:53:03.912086 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:53:03.912431 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:53:03.912745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:03.914131 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:53:03.914885 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:53:03.915227 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:53:03.918053 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:53:03.918507 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:53:03.919568 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:53:03.919894 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:53:03.918842 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:53:03.926375 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:53:03.927060 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:53:03.930682 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:53:03.931233 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:53:03.915429 => 18:53:03.930942
[0m18:53:03.931715 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:53:03.932126 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:53:03.931926 => 18:53:03.931937
[0m18:53:03.925427 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:53:03.933089 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:53:03.934669 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:53:03.927439 => 18:53:03.933701
[0m18:53:03.936121 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:53:03.935405 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:53:03.936706 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:53:03.936407 => 18:53:03.936417
[0m18:53:03.937128 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:53:03.920100 => 18:53:03.936905
[0m18:53:03.938564 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m18:53:03.940728 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:53:03.940203 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:53:03.951967 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:53:03.951662 => 18:53:03.951679
[0m18:53:03.952806 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:53:03.953236 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:53:03.939569 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:53:03.954067 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m18:53:03.956753 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:53:03.956301 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m18:53:03.957239 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:53:03.957854 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m18:53:04.001884 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:53:04.001590 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m18:53:04.005475 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m18:53:04.006285 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 18:53:03.958308 => 18:53:04.006011
[0m18:53:04.006934 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 18:53:03.940968 => 18:53:04.006621
[0m18:53:04.007625 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 18:53:04.002440 => 18:53:04.007383
[0m18:53:04.007992 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:53:04.009467 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 18:53:04.009246 => 18:53:04.009258
[0m18:53:04.008906 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:53:04.008467 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:53:04.011353 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 18:53:04.011133 => 18:53:04.011141
[0m18:53:04.010809 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 18:53:04.010589 => 18:53:04.010597
[0m18:53:04.012953 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:53:04.012132 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:53:04.010291 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:53:04.013500 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:53:04.014610 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m18:53:04.014972 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:53:04.018601 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m18:53:04.019325 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 18:53:04.015196 => 18:53:04.019079
[0m18:53:04.019678 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:53:04.020108 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 18:53:04.019902 => 18:53:04.019911
[0m18:53:04.020829 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:53:07.164756 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m18:53:07.165293 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:53:07.165705 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:53:07.400622 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:53:07.411859 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:53:07.412854 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:53:03.876907 => 18:53:07.412442
[0m18:53:07.413356 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:53:07.413815 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:53:07.413604 => 18:53:07.413616
[0m18:53:07.414214 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m18:53:07.647432 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:53:07.649083 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:53:07.650588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:07.650928 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:53:07.651196 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m18:53:07.651458 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m18:53:07.651714 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m18:53:07.653245 [debug] [MainThread]: Command end result
[0m18:53:07.661264 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 14.149662, "process_user_time": 2.392402, "process_kernel_time": 0.099517, "process_mem_max_rss": "113592", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m18:53:07.661843 [debug] [MainThread]: Command `dbt compile` succeeded at 18:53:07.661719 after 14.15 seconds
[0m18:53:07.662252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37029d7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36fc0e68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ff063130>]}
[0m18:53:07.662609 [debug] [MainThread]: Flushing usage events
[0m18:55:06.627914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b43174ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b410b0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b410b0220>]}


============================== 18:55:06.630490 | a8ef0c3a-eb7e-4b28-97ae-92dc2506916a ==============================
[0m18:55:06.630490 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:55:06.630983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:55:06.782643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ef0c3a-eb7e-4b28-97ae-92dc2506916a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b44bebfa0>]}
[0m18:55:06.859681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ef0c3a-eb7e-4b28-97ae-92dc2506916a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b43a5cfd0>]}
[0m18:55:06.860331 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:55:06.867580 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:55:06.892596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:06.893085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:06.899700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ef0c3a-eb7e-4b28-97ae-92dc2506916a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3f4b8af0>]}
[0m18:55:06.910962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ef0c3a-eb7e-4b28-97ae-92dc2506916a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3f56ea30>]}
[0m18:55:06.911473 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:55:06.911876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ef0c3a-eb7e-4b28-97ae-92dc2506916a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3f7a1d30>]}
[0m18:55:06.913529 [info ] [MainThread]: 
[0m18:55:06.914344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:06.915420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m18:55:06.926897 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:55:06.927649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m18:55:06.930080 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:55:06.930532 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:55:06.930782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:06.928019 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:55:06.931727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:09.463812 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m18:55:09.464204 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:55:09.464478 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:55:09.717265 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:55:09.718587 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:55:09.962542 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:55:10.145225 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m18:55:10.145962 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:55:10.146447 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:55:10.501166 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:55:10.502431 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:55:10.826436 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:55:10.832581 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:10.832952 [debug] [MainThread]: On master: BEGIN
[0m18:55:10.833264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:13.171327 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:55:13.171795 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:13.172149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:13.432962 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:55:13.434356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ef0c3a-eb7e-4b28-97ae-92dc2506916a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3f4b8b50>]}
[0m18:55:13.434849 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:13.683531 [debug] [MainThread]: On master: Close
[0m18:55:13.686048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:13.686858 [info ] [MainThread]: 
[0m18:55:13.691229 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:55:13.691836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m18:55:13.692153 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:55:13.699887 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:55:13.701041 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m18:55:13.701593 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:55:13.706677 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:55:13.721447 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:55:13.701832 => 18:55:13.720076
[0m18:55:13.730109 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:55:13.730588 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:55:13.730376 => 18:55:13.730388
[0m18:55:13.731862 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:55:13.727942 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:55:13.732745 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:55:13.733251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:13.735889 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:55:13.736685 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:55:13.737021 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:55:13.741570 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:55:13.742202 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:55:13.743061 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:55:13.745324 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:55:13.744590 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:55:13.743865 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:55:13.737217 => 18:55:13.743552
[0m18:55:13.746647 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:55:13.746093 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:55:13.745724 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:55:13.747180 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:55:13.746969 => 18:55:13.746982
[0m18:55:13.751935 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:55:13.756223 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:55:13.756880 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:55:13.755334 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:55:13.757750 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m18:55:13.758968 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:55:13.765034 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:55:13.752326 => 18:55:13.764620
[0m18:55:13.773380 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:55:13.772927 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m18:55:13.765509 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:55:13.747502 => 18:55:13.765291
[0m18:55:13.773877 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:55:13.773632 => 18:55:13.773643
[0m18:55:13.774582 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:55:13.776946 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:55:13.776737 => 18:55:13.776745
[0m18:55:13.776448 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 18:55:13.759434 => 18:55:13.776211
[0m18:55:13.777734 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:55:13.775712 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:55:13.778207 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:55:13.779635 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:55:13.780776 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m18:55:13.780214 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 18:55:13.780004 => 18:55:13.780012
[0m18:55:13.781143 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:55:13.785492 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m18:55:13.781969 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m18:55:13.779103 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:55:13.786449 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 18:55:13.782243 => 18:55:13.786069
[0m18:55:13.788194 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:55:13.787734 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m18:55:13.787042 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:55:13.789648 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m18:55:13.789081 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:55:13.788677 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 18:55:13.788473 => 18:55:13.788484
[0m18:55:13.796609 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m18:55:13.795691 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m18:55:13.790028 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:55:13.797557 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 18:55:13.790336 => 18:55:13.797253
[0m18:55:13.801050 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m18:55:13.801455 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:55:13.802109 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 18:55:13.801896 => 18:55:13.801904
[0m18:55:13.802831 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m18:55:13.803707 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 18:55:13.797889 => 18:55:13.803472
[0m18:55:13.804064 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:55:13.804524 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 18:55:13.804328 => 18:55:13.804335
[0m18:55:13.805267 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m18:55:17.313431 [debug] [Thread-1  ]: SQL status: BEGIN in 4.0 seconds
[0m18:55:17.313920 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:55:17.314290 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:55:17.680440 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:55:17.691326 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:55:17.692637 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:55:13.692340 => 18:55:17.691958
[0m18:55:17.693047 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:55:17.693475 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:55:17.693270 => 18:55:17.693282
[0m18:55:17.693808 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m18:55:18.074337 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:55:18.076445 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:55:18.077598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:18.077913 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:55:18.078290 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m18:55:18.078626 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m18:55:18.078923 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m18:55:18.082362 [debug] [MainThread]: Command end result
[0m18:55:18.090496 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 11.505505, "process_user_time": 2.149355, "process_kernel_time": 0.11963, "process_mem_max_rss": "109416", "process_out_blocks": "1776", "process_in_blocks": "0"}
[0m18:55:18.091079 [debug] [MainThread]: Command `dbt compile` succeeded at 18:55:18.090960 after 11.51 seconds
[0m18:55:18.091452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b43174ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3f6756d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b43a5cfd0>]}
[0m18:55:18.091830 [debug] [MainThread]: Flushing usage events
[0m18:55:25.560291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702562cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702358a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702358a6a0>]}


============================== 18:55:25.562727 | c961f73a-9373-4be2-89ec-2803afcd22e8 ==============================
[0m18:55:25.562727 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:55:25.563471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:55:25.564182 [info ] [MainThread]: dbt version: 1.7.4
[0m18:55:25.564609 [info ] [MainThread]: python version: 3.8.10
[0m18:55:25.564979 [info ] [MainThread]: python path: /usr/bin/python3
[0m18:55:25.565419 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m18:55:25.649263 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m18:55:25.649759 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m18:55:25.650169 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m18:55:25.650714 [info ] [MainThread]: adapter type: postgres
[0m18:55:25.651075 [info ] [MainThread]: adapter version: 1.7.4
[0m18:55:25.727416 [info ] [MainThread]: Configuration:
[0m18:55:25.727990 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:55:25.728397 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:55:25.728755 [info ] [MainThread]: Required dependencies:
[0m18:55:25.729119 [debug] [MainThread]: Executing "git --help"
[0m18:55:25.735026 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:55:25.735777 [debug] [MainThread]: STDERR: "b''"
[0m18:55:25.736398 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:55:25.737337 [info ] [MainThread]: Connection:
[0m18:55:25.739368 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m18:55:25.739953 [info ] [MainThread]:   port: 5432
[0m18:55:25.740433 [info ] [MainThread]:   user: postgres
[0m18:55:25.740788 [info ] [MainThread]:   database: postgres
[0m18:55:25.742066 [info ] [MainThread]:   schema: metrics_test
[0m18:55:25.742878 [info ] [MainThread]:   connect_timeout: 10
[0m18:55:25.743489 [info ] [MainThread]:   role: None
[0m18:55:25.744782 [info ] [MainThread]:   search_path: None
[0m18:55:25.745162 [info ] [MainThread]:   keepalives_idle: 0
[0m18:55:25.745515 [info ] [MainThread]:   sslmode: None
[0m18:55:25.745862 [info ] [MainThread]:   sslcert: None
[0m18:55:25.746273 [info ] [MainThread]:   sslkey: None
[0m18:55:25.746816 [info ] [MainThread]:   sslrootcert: None
[0m18:55:25.747215 [info ] [MainThread]:   application_name: dbt
[0m18:55:25.747754 [info ] [MainThread]:   retries: 1
[0m18:55:25.748350 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:55:25.749151 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:55:25.749570 [debug] [MainThread]: Using postgres connection "debug"
[0m18:55:25.749928 [debug] [MainThread]: On debug: select 1 as id
[0m18:55:25.750292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:28.724616 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m18:55:28.725749 [debug] [MainThread]: On debug: Close
[0m18:55:28.726793 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:55:28.727340 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:55:28.729121 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.2116184, "process_user_time": 1.764538, "process_kernel_time": 0.120036, "process_mem_max_rss": "99740", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m18:55:28.729972 [debug] [MainThread]: Command `dbt debug` succeeded at 18:55:28.729837 after 3.21 seconds
[0m18:55:28.730372 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:55:28.730782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702562cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702480cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7021d237c0>]}
[0m18:55:28.731208 [debug] [MainThread]: Flushing usage events
[0m18:59:01.604222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560bb94cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5609ae8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5609ae82b0>]}


============================== 18:59:01.606268 | 80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3 ==============================
[0m18:59:01.606268 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:59:01.606665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:59:01.762724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560ac8d5e0>]}
[0m18:59:01.841021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56081f4b80>]}
[0m18:59:01.841678 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m18:59:01.849429 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:59:01.874035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:59:01.874495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:59:01.882843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5607ef3b20>]}
[0m18:59:01.892699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560800aaf0>]}
[0m18:59:01.893353 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m18:59:01.894084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560800abb0>]}
[0m18:59:01.896586 [info ] [MainThread]: 
[0m18:59:01.897452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:59:01.898598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:59:01.918372 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:59:01.919044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:59:01.921374 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:59:01.921667 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:59:01.921920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:01.919546 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:59:01.925178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:05.768058 [debug] [ThreadPool]: SQL status: SELECT 8 in 4.0 seconds
[0m18:59:05.769252 [debug] [ThreadPool]: On list_postgres: Close
[0m18:59:05.820280 [debug] [ThreadPool]: SQL status: SELECT 8 in 4.0 seconds
[0m18:59:05.821379 [debug] [ThreadPool]: On list_postgres: Close
[0m18:59:05.823649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m18:59:05.828552 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:59:05.828947 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m18:59:05.829485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m18:59:05.829843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:05.832053 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:59:05.832980 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m18:59:05.833472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:09.376116 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m18:59:09.376988 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m18:59:09.377468 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m18:59:09.495606 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m18:59:09.496020 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m18:59:09.496569 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m18:59:09.752062 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:59:09.753322 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m18:59:09.879025 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:59:09.880194 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m18:59:10.105575 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m18:59:10.247955 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m18:59:10.253465 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:10.253812 [debug] [MainThread]: On master: BEGIN
[0m18:59:10.254136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:13.095053 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:59:13.095463 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:13.095799 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:59:13.409966 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:59:13.411520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5607efc280>]}
[0m18:59:13.411957 [debug] [MainThread]: On master: ROLLBACK
[0m18:59:13.711001 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:13.711423 [debug] [MainThread]: On master: BEGIN
[0m18:59:14.366600 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m18:59:14.367038 [debug] [MainThread]: On master: COMMIT
[0m18:59:14.367325 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:14.367600 [debug] [MainThread]: On master: COMMIT
[0m18:59:14.665982 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:14.666438 [debug] [MainThread]: On master: Close
[0m18:59:14.667972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:14.668682 [info ] [MainThread]: 
[0m18:59:14.671089 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m18:59:14.671553 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m18:59:14.672261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m18:59:14.672598 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m18:59:14.679441 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m18:59:14.679940 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m18:59:14.680506 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m18:59:14.680828 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m18:59:14.685612 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m18:59:14.704280 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:14.704930 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m18:59:14.705297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:14.706373 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 18:59:14.681041 => 18:59:14.706132
[0m18:59:14.706709 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m18:59:14.769727 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m18:59:14.770879 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:59:14.771298 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m18:59:14.771683 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:59:17.050404 [debug] [Thread-2  ]: SQL status: BEGIN in 2.0 seconds
[0m18:59:17.050824 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:59:17.051139 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from renamed
  );
[0m18:59:17.294492 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:59:17.301089 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:59:17.301466 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m18:59:17.541147 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:17.543959 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:59:17.544301 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m18:59:17.792294 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:17.805343 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m18:59:17.805764 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:59:17.806125 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m18:59:18.044831 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:59:18.050328 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m18:59:18.053824 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m18:59:18.054163 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m18:59:18.310818 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:59:18.312246 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 18:59:14.706904 => 18:59:18.312055
[0m18:59:18.312593 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m18:59:18.313892 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56045c3fd0>]}
[0m18:59:18.314792 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.63s]
[0m18:59:18.315626 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m18:59:18.316315 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m18:59:18.316725 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m18:59:18.317373 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m18:59:18.317767 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m18:59:18.320873 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m18:59:18.321721 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 18:59:18.317982 => 18:59:18.321359
[0m18:59:18.322060 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m18:59:18.335742 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m18:59:18.336857 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m18:59:18.337834 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m18:59:18.338185 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m18:59:18.341588 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m18:59:18.349606 [debug] [Thread-1  ]: SQL status: BEGIN in 4.0 seconds
[0m18:59:18.351579 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:18.351964 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m18:59:18.343209 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m18:59:18.351203 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m18:59:18.352500 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 18:59:18.338391 => 18:59:18.352271
[0m18:59:18.355105 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m18:59:18.354715 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:59:18.353361 [info ] [Thread-2  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m18:59:18.360504 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m18:59:18.366515 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:59:18.365935 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m18:59:18.367259 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m18:59:18.370962 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m18:59:18.360037 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m18:59:18.375959 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:59:18.376311 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m18:59:18.376604 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:59:18.375123 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 18:59:18.367645 => 18:59:18.371642
[0m18:59:18.377148 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m18:59:18.381056 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m18:59:18.386212 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:59:18.386657 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m18:59:18.387003 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:59:18.721630 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:59:18.733029 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m18:59:18.734003 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 18:59:14.672837 => 18:59:18.733676
[0m18:59:18.734413 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m18:59:18.738085 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m18:59:18.738838 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:18.739233 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m18:59:19.142655 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m18:59:19.145769 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:19.146167 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m18:59:19.541508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:19.544438 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:19.544837 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m18:59:19.982565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:59:19.987985 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m18:59:19.988395 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:19.988728 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m18:59:20.427256 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:59:20.429863 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m18:59:20.432947 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m18:59:20.433299 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m18:59:20.569824 [debug] [Thread-4  ]: SQL status: BEGIN in 2.0 seconds
[0m18:59:20.570293 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m18:59:20.570644 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select purchase_id,
    nubmer,
    tenant_id,
    app_id,
    sku,
    qty,
    amount,
    amount_rmb,
    unit,
    create_at,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m18:59:20.698728 [debug] [Thread-2  ]: SQL status: BEGIN in 2.0 seconds
[0m18:59:20.699165 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m18:59:20.699491 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m18:59:20.705483 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m18:59:20.705933 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m18:59:20.706304 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', createat) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m18:59:20.805869 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column "nubmer" does not exist
LINE 24:     nubmer,
             ^
HINT:  Perhaps you meant to reference the column "purchase_items.number".

[0m18:59:20.806385 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: ROLLBACK
[0m18:59:20.870389 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:59:20.871878 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 18:59:18.734626 => 18:59:20.871683
[0m18:59:20.872233 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m18:59:20.873131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5606e4deb0>]}
[0m18:59:20.873711 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 6.20s]
[0m18:59:20.874364 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m18:59:20.949515 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "createat" does not exist
LINE 25:     date_trunc('week', createat) as create_at,
                                ^
HINT:  Perhaps you meant to reference the column "purchase_items.create_at".

[0m18:59:20.949993 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: ROLLBACK
[0m18:59:20.959394 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "createat" does not exist
LINE 25:     date_trunc('day', createat) as create_at,
                               ^
HINT:  Perhaps you meant to reference the column "purchase_items.create_at".

[0m18:59:20.959910 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: ROLLBACK
[0m18:59:21.037147 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 18:59:18.322270 => 18:59:21.036791
[0m18:59:21.037595 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m18:59:21.041128 [debug] [Thread-4  ]: Database Error in model purchase_items (models/purchase/purchase_items.sql)
  column "nubmer" does not exist
  LINE 24:     nubmer,
               ^
  HINT:  Perhaps you meant to reference the column "purchase_items.number".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m18:59:21.042015 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5604555880>]}
[0m18:59:21.043096 [error] [Thread-4  ]: 3 of 5 ERROR creating sql table model metrics_test_windingflow.purchase_items .. [[31mERROR[0m in 2.72s]
[0m18:59:21.044235 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m18:59:21.195013 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 18:59:18.377363 => 18:59:21.194660
[0m18:59:21.195466 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m18:59:21.196796 [debug] [Thread-2  ]: Database Error in model purchase_items_week (models/purchase/purchase_items_week.sql)
  column "createat" does not exist
  LINE 25:     date_trunc('week', createat) as create_at,
                                  ^
  HINT:  Perhaps you meant to reference the column "purchase_items.create_at".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items_week.sql
[0m18:59:21.197328 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560456dee0>]}
[0m18:59:21.197897 [error] [Thread-2  ]: 5 of 5 ERROR creating sql table model metrics_test_windingflow.purchase_items_week  [[31mERROR[0m in 2.83s]
[0m18:59:21.198545 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m18:59:21.206435 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 18:59:18.355347 => 18:59:21.206056
[0m18:59:21.206951 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m18:59:21.208288 [debug] [Thread-3  ]: Database Error in model purchase_items_day (models/purchase/purchase_items_day.sql)
  column "createat" does not exist
  LINE 25:     date_trunc('day', createat) as create_at,
                                 ^
  HINT:  Perhaps you meant to reference the column "purchase_items.create_at".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items_day.sql
[0m18:59:21.208866 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bf79c1-cd5b-4ca9-b3dc-e25f573f8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56045d0610>]}
[0m18:59:21.209676 [error] [Thread-3  ]: 4 of 5 ERROR creating sql table model metrics_test_windingflow.purchase_items_day  [[31mERROR[0m in 2.87s]
[0m18:59:21.210511 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m18:59:21.212266 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:21.212700 [debug] [MainThread]: On master: BEGIN
[0m18:59:21.213012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:23.811614 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m18:59:23.812211 [debug] [MainThread]: On master: COMMIT
[0m18:59:23.812613 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:23.812959 [debug] [MainThread]: On master: COMMIT
[0m18:59:24.073984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:24.074491 [debug] [MainThread]: On master: Close
[0m18:59:24.076113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:24.076633 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m18:59:24.076905 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m18:59:24.077153 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m18:59:24.077398 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m18:59:24.077749 [info ] [MainThread]: 
[0m18:59:24.078200 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 22.18 seconds (22.18s).
[0m18:59:24.079377 [debug] [MainThread]: Command end result
[0m18:59:24.088336 [info ] [MainThread]: 
[0m18:59:24.088795 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:59:24.089281 [info ] [MainThread]: 
[0m18:59:24.089749 [error] [MainThread]:   Database Error in model purchase_items (models/purchase/purchase_items.sql)
  column "nubmer" does not exist
  LINE 24:     nubmer,
               ^
  HINT:  Perhaps you meant to reference the column "purchase_items.number".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m18:59:24.090782 [info ] [MainThread]: 
[0m18:59:24.091265 [error] [MainThread]:   Database Error in model purchase_items_week (models/purchase/purchase_items_week.sql)
  column "createat" does not exist
  LINE 25:     date_trunc('week', createat) as create_at,
                                  ^
  HINT:  Perhaps you meant to reference the column "purchase_items.create_at".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items_week.sql
[0m18:59:24.092240 [info ] [MainThread]: 
[0m18:59:24.092705 [error] [MainThread]:   Database Error in model purchase_items_day (models/purchase/purchase_items_day.sql)
  column "createat" does not exist
  LINE 25:     date_trunc('day', createat) as create_at,
                                 ^
  HINT:  Perhaps you meant to reference the column "purchase_items.create_at".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items_day.sql
[0m18:59:24.093932 [info ] [MainThread]: 
[0m18:59:24.094577 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m18:59:24.095473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.534492, "process_user_time": 2.233502, "process_kernel_time": 0.147834, "process_mem_max_rss": "111764", "process_out_blocks": "1816", "command_success": false, "process_in_blocks": "0"}
[0m18:59:24.096041 [debug] [MainThread]: Command `dbt run` failed at 18:59:24.095911 after 22.54 seconds
[0m18:59:24.096398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560bb94cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56081f4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560814fc10>]}
[0m18:59:24.096955 [debug] [MainThread]: Flushing usage events
[0m19:00:08.517484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f5b11fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f5a123430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f59076610>]}


============================== 19:00:08.519503 | 3b1fee26-0d94-4674-8809-c10160b05eae ==============================
[0m19:00:08.519503 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:00:08.519913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:00:08.675119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1fee26-0d94-4674-8809-c10160b05eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f590062e0>]}
[0m19:00:08.753758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1fee26-0d94-4674-8809-c10160b05eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f58fff8b0>]}
[0m19:00:08.754440 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:00:08.761120 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:00:08.787076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:00:08.787677 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/purchase/purchase_items_week.sql
[0m19:00:08.788457 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/purchase/purchase_items_day.sql
[0m19:00:08.966408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1fee26-0d94-4674-8809-c10160b05eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f571dd310>]}
[0m19:00:08.975334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1fee26-0d94-4674-8809-c10160b05eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f573a3f10>]}
[0m19:00:08.975762 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:00:08.976092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1fee26-0d94-4674-8809-c10160b05eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f573a3bb0>]}
[0m19:00:08.977368 [info ] [MainThread]: 
[0m19:00:08.977968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:08.979615 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m19:00:08.988629 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:00:08.989071 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:00:08.989374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:08.990616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m19:00:08.992586 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:00:08.992906 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:00:08.993230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:12.834163 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m19:00:12.834557 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:00:12.834833 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:00:13.148414 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:00:13.149607 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:00:13.480056 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:00:13.720067 [debug] [ThreadPool]: SQL status: BEGIN in 5.0 seconds
[0m19:00:13.720478 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:00:13.720776 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:00:14.153781 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:00:14.155107 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:00:14.559896 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:00:14.565654 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:14.566036 [debug] [MainThread]: On master: BEGIN
[0m19:00:14.566329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:18.023465 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:00:18.023860 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:18.024170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:18.460491 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:00:18.461946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1fee26-0d94-4674-8809-c10160b05eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f5761b940>]}
[0m19:00:18.462331 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:18.929193 [debug] [MainThread]: On master: Close
[0m19:00:18.930576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:18.931124 [info ] [MainThread]: 
[0m19:00:18.933259 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:00:18.933840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m19:00:18.934178 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:00:18.934737 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:00:18.945044 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m19:00:18.945492 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:00:18.948808 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:00:18.949735 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:00:18.945709 => 19:00:18.949396
[0m19:00:18.950139 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:00:18.950573 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:00:18.950363 => 19:00:18.950376
[0m19:00:18.951325 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:00:18.966444 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:00:18.966898 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:00:18.967233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:18.968935 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:00:18.969820 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:00:18.970209 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:00:18.973191 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:00:18.974035 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:00:18.970421 => 19:00:18.973703
[0m19:00:18.974523 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:00:18.976096 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m19:00:18.976424 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:00:18.979830 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:00:18.974980 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:00:18.981660 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m19:00:18.982020 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:00:18.987700 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:00:18.980707 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:00:18.976615 => 19:00:18.980356
[0m19:00:18.991027 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:00:18.991660 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:00:18.991421 => 19:00:18.991434
[0m19:00:18.992444 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:00:18.975375 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:00:18.996905 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:00:18.996685 => 19:00:18.996696
[0m19:00:18.997801 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:00:18.988954 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:00:18.982304 => 19:00:18.988368
[0m19:00:18.998607 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:00:18.999001 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:00:18.998806 => 19:00:18.998813
[0m19:00:18.999683 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:00:18.998219 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:00:19.000278 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m19:00:19.000602 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:00:18.996297 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:00:19.012909 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m19:00:19.011784 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:00:19.014729 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m19:00:19.015089 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:00:19.014021 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:00:19.045335 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m19:00:19.056716 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m19:00:19.057954 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m19:00:19.058748 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 19:00:19.000794 => 19:00:19.058482
[0m19:00:19.062692 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 19:00:19.015296 => 19:00:19.062363
[0m19:00:19.063152 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:00:19.063779 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 19:00:19.026357 => 19:00:19.063470
[0m19:00:19.064945 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:00:19.064588 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 19:00:19.064363 => 19:00:19.064376
[0m19:00:19.065358 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 19:00:19.065157 => 19:00:19.065166
[0m19:00:19.066960 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:00:19.064120 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:00:19.067833 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 19:00:19.067627 => 19:00:19.067634
[0m19:00:19.068694 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:00:19.067361 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:00:19.069338 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m19:00:19.069714 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:00:19.066194 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:00:19.074176 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m19:00:19.077087 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 19:00:19.069920 => 19:00:19.076577
[0m19:00:19.077430 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:00:19.077839 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 19:00:19.077635 => 19:00:19.077645
[0m19:00:19.078671 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:00:22.541376 [debug] [Thread-1  ]: SQL status: BEGIN in 4.0 seconds
[0m19:00:22.541843 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:00:22.542195 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:00:22.929149 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:00:22.939414 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:00:22.940310 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:00:18.934960 => 19:00:22.940004
[0m19:00:22.940655 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:00:22.941058 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:00:22.940864 => 19:00:22.940875
[0m19:00:22.941393 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m19:00:23.336684 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:00:23.338760 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:00:23.340012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:23.340332 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m19:00:23.340585 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m19:00:23.340830 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m19:00:23.341066 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m19:00:23.342645 [debug] [MainThread]: Command end result
[0m19:00:23.388350 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 14.914617, "process_user_time": 2.304719, "process_kernel_time": 0.107367, "process_mem_max_rss": "112408", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m19:00:23.388935 [debug] [MainThread]: Command `dbt compile` succeeded at 19:00:23.388809 after 14.92 seconds
[0m19:00:23.389319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f5b11fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f57737a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f540f9d60>]}
[0m19:00:23.389668 [debug] [MainThread]: Flushing usage events
[0m19:01:12.276701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22a884f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2287c77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2287c7700>]}


============================== 19:01:12.279064 | b47109e6-a292-4a1e-a450-f24e9b22fb21 ==============================
[0m19:01:12.279064 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:01:12.279580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:01:12.280022 [info ] [MainThread]: dbt version: 1.7.4
[0m19:01:12.280393 [info ] [MainThread]: python version: 3.8.10
[0m19:01:12.281076 [info ] [MainThread]: python path: /usr/bin/python3
[0m19:01:12.281664 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m19:01:12.377939 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m19:01:12.378593 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m19:01:12.378936 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m19:01:12.379422 [info ] [MainThread]: adapter type: postgres
[0m19:01:12.379748 [info ] [MainThread]: adapter version: 1.7.4
[0m19:01:12.463035 [info ] [MainThread]: Configuration:
[0m19:01:12.463556 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:01:12.463925 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:01:12.464332 [info ] [MainThread]: Required dependencies:
[0m19:01:12.464761 [debug] [MainThread]: Executing "git --help"
[0m19:01:12.476028 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:01:12.476858 [debug] [MainThread]: STDERR: "b''"
[0m19:01:12.477252 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:01:12.477696 [info ] [MainThread]: Connection:
[0m19:01:12.478076 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m19:01:12.478404 [info ] [MainThread]:   port: 5432
[0m19:01:12.478690 [info ] [MainThread]:   user: postgres
[0m19:01:12.478971 [info ] [MainThread]:   database: postgres
[0m19:01:12.479252 [info ] [MainThread]:   schema: metrics_test
[0m19:01:12.479533 [info ] [MainThread]:   connect_timeout: 10
[0m19:01:12.479857 [info ] [MainThread]:   role: None
[0m19:01:12.480209 [info ] [MainThread]:   search_path: None
[0m19:01:12.482539 [info ] [MainThread]:   keepalives_idle: 0
[0m19:01:12.482930 [info ] [MainThread]:   sslmode: None
[0m19:01:12.483281 [info ] [MainThread]:   sslcert: None
[0m19:01:12.483617 [info ] [MainThread]:   sslkey: None
[0m19:01:12.483987 [info ] [MainThread]:   sslrootcert: None
[0m19:01:12.484441 [info ] [MainThread]:   application_name: dbt
[0m19:01:12.484787 [info ] [MainThread]:   retries: 1
[0m19:01:12.485658 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:01:12.486678 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:01:12.487198 [debug] [MainThread]: Using postgres connection "debug"
[0m19:01:12.487575 [debug] [MainThread]: On debug: select 1 as id
[0m19:01:12.487917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:16.999096 [debug] [MainThread]: SQL status: SELECT 1 in 5.0 seconds
[0m19:01:17.000200 [debug] [MainThread]: On debug: Close
[0m19:01:17.001161 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:01:17.001545 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:01:17.002860 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.777618, "process_user_time": 1.899589, "process_kernel_time": 0.068272, "process_mem_max_rss": "100044", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m19:01:17.003464 [debug] [MainThread]: Command `dbt debug` succeeded at 19:01:17.003336 after 4.78 seconds
[0m19:01:17.003810 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:01:17.004153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22a884f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff229ac4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff226f3d610>]}
[0m19:01:17.004546 [debug] [MainThread]: Flushing usage events
[0m19:03:20.182366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65738beee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6571833b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f657182afd0>]}


============================== 19:03:20.184602 | 6b41f518-74f3-4c9c-b1db-468a321f4b10 ==============================
[0m19:03:20.184602 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:03:20.185029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:03:20.342278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65717bef40>]}
[0m19:03:20.423144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65741ace20>]}
[0m19:03:20.423912 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:03:20.430811 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:03:20.456896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:20.458515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:20.468062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656fc22b80>]}
[0m19:03:20.486569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656fd3ab50>]}
[0m19:03:20.487131 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:03:20.487455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656fd3aaf0>]}
[0m19:03:20.489216 [info ] [MainThread]: 
[0m19:03:20.489887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:03:20.491663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:03:20.498264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:03:20.520614 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:03:20.521024 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:03:20.521321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:20.519045 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:03:20.521896 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:03:20.522300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:22.788848 [debug] [ThreadPool]: SQL status: SELECT 8 in 2.0 seconds
[0m19:03:22.789987 [debug] [ThreadPool]: On list_postgres: Close
[0m19:03:24.352005 [debug] [ThreadPool]: SQL status: SELECT 8 in 4.0 seconds
[0m19:03:24.353222 [debug] [ThreadPool]: On list_postgres: Close
[0m19:03:24.356022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m19:03:24.361220 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:03:24.361827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m19:03:24.362195 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:03:24.363861 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:03:24.364189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:24.364541 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:03:24.365056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:26.632062 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m19:03:26.632473 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:03:26.632779 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:03:26.882979 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:03:26.884154 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:03:27.127457 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:03:27.538611 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:03:27.539211 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:03:27.539691 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:03:27.882980 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:03:27.884139 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:03:28.214866 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:03:28.220494 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:28.221132 [debug] [MainThread]: On master: BEGIN
[0m19:03:28.221485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:30.758906 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:03:30.759367 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:30.759813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:03:31.057709 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:03:31.059089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656ff6c2b0>]}
[0m19:03:31.059551 [debug] [MainThread]: On master: ROLLBACK
[0m19:03:31.347832 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:31.348327 [debug] [MainThread]: On master: BEGIN
[0m19:03:31.887836 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m19:03:31.889249 [debug] [MainThread]: On master: COMMIT
[0m19:03:31.889920 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:31.890313 [debug] [MainThread]: On master: COMMIT
[0m19:03:32.147096 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:03:32.147559 [debug] [MainThread]: On master: Close
[0m19:03:32.149168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:32.150134 [info ] [MainThread]: 
[0m19:03:32.152972 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:03:32.153416 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m19:03:32.153959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m19:03:32.154280 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:03:32.167312 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:03:32.168307 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m19:03:32.169388 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m19:03:32.169848 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:03:32.175376 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:03:32.190930 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:03:32.170104 => 19:03:32.190546
[0m19:03:32.191340 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:03:32.201876 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:32.202364 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:03:32.202680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:03:32.237437 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m19:03:32.238560 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:03:32.238962 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m19:03:32.239286 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:03:34.503492 [debug] [Thread-2  ]: SQL status: BEGIN in 2.0 seconds
[0m19:03:34.503991 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:03:34.504350 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from renamed
  );
[0m19:03:34.621804 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m19:03:34.622535 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:34.622955 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:03:34.747098 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:34.753409 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:03:34.753860 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m19:03:34.870216 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:03:34.881943 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:03:34.882849 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:03:32.154528 => 19:03:34.882540
[0m19:03:34.883200 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:03:34.902022 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m19:03:34.902819 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:34.903211 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m19:03:34.998240 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:35.001072 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:03:35.001396 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m19:03:35.202573 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m19:03:35.205626 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:35.205996 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m19:03:35.245682 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:35.259640 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m19:03:35.260003 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:03:35.260361 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m19:03:35.482031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:35.484929 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:35.485280 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m19:03:35.503370 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:03:35.509377 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m19:03:35.513471 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:03:35.513884 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m19:03:35.747180 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:35.752354 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:03:35.752717 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:35.753066 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:03:35.756710 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:35.758063 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:03:32.191536 => 19:03:35.757836
[0m19:03:35.758439 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m19:03:35.759394 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2320d0>]}
[0m19:03:35.760318 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.59s]
[0m19:03:35.761159 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:03:35.761898 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:03:35.762328 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:03:35.762836 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m19:03:35.764518 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:03:35.763692 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m19:03:35.765485 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m19:03:35.764895 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:03:35.769514 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:03:35.765820 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:03:35.763254 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:03:35.773330 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:03:35.784027 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:03:35.770192 => 19:03:35.783706
[0m19:03:35.784416 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:03:35.783012 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:03:35.766132 => 19:03:35.782712
[0m19:03:35.789592 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:03:35.782299 [info ] [Thread-2  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m19:03:35.788766 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m19:03:35.797424 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:03:35.795754 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m19:03:35.797970 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m19:03:35.798793 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:03:35.798383 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:03:35.795086 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m19:03:35.805551 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:03:35.805907 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m19:03:35.804351 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:03:35.808265 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:03:35.799247 => 19:03:35.807826
[0m19:03:35.808806 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:03:35.807135 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:03:35.816629 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m19:03:35.817964 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:03:35.818383 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m19:03:35.818706 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:03:36.013318 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:03:36.016762 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m19:03:36.019111 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:03:36.019457 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m19:03:36.270672 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:03:36.272153 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:03:34.883413 => 19:03:36.271959
[0m19:03:36.272510 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:03:36.273600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2488b0>]}
[0m19:03:36.274422 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 4.12s]
[0m19:03:36.275631 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:03:38.396554 [debug] [Thread-3  ]: SQL status: BEGIN in 3.0 seconds
[0m19:03:38.396991 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:03:38.397310 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m19:03:38.645683 [debug] [Thread-3  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:03:38.648656 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:03:38.648999 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day" rename to "purchase_items_day__dbt_backup"
[0m19:03:38.887151 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:38.890351 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:03:38.890738 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m19:03:39.090451 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m19:03:39.090896 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:03:39.091214 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m19:03:39.128829 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:39.130967 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m19:03:39.131327 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:03:39.131723 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m19:03:39.223068 [debug] [Thread-4  ]: SQL status: BEGIN in 3.0 seconds
[0m19:03:39.223528 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:03:39.223851 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select purchase_id,
    nubmer,
    tenant_id,
    app_id,
    sku,
    qty,
    amount,
    amount_rmb,
    unit,
    create_at,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m19:03:39.373114 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:03:39.375728 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m19:03:39.376444 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:03:39.376777 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m19:03:39.438828 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:03:39.441898 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:03:39.442282 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week" rename to "purchase_items_week__dbt_backup"
[0m19:03:39.526221 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column "nubmer" does not exist
LINE 24:     nubmer,
             ^
HINT:  Perhaps you meant to reference the column "purchase_items.number".

[0m19:03:39.526771 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: ROLLBACK
[0m19:03:39.618285 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:03:39.620065 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:03:35.784660 => 19:03:39.619850
[0m19:03:39.620451 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m19:03:39.621473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2308b0>]}
[0m19:03:39.622177 [info ] [Thread-3  ]: 4 of 5 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 3.86s]
[0m19:03:39.622749 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:03:39.772033 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:39.775277 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:03:39.775852 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m19:03:40.076241 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:03:35.789833 => 19:03:40.075920
[0m19:03:40.076663 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m19:03:40.079442 [debug] [Thread-4  ]: Database Error in model purchase_items (models/purchase/purchase_items.sql)
  column "nubmer" does not exist
  LINE 24:     nubmer,
               ^
  HINT:  Perhaps you meant to reference the column "purchase_items.number".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m19:03:40.079944 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c27cd00>]}
[0m19:03:40.080526 [error] [Thread-4  ]: 3 of 5 ERROR creating sql table model metrics_test_windingflow.purchase_items .. [[31mERROR[0m in 4.32s]
[0m19:03:40.081346 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:03:40.103790 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:40.105780 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m19:03:40.106623 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:03:40.107106 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m19:03:40.422330 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:03:40.425158 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m19:03:40.425876 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:03:40.426225 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m19:03:40.755740 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:03:40.757186 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:03:35.809055 => 19:03:40.756997
[0m19:03:40.757531 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m19:03:40.758814 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b41f518-74f3-4c9c-b1db-468a321f4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656c2b61f0>]}
[0m19:03:40.759675 [info ] [Thread-2  ]: 5 of 5 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 14[0m in 4.96s]
[0m19:03:40.760477 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:03:40.762819 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:40.763255 [debug] [MainThread]: On master: BEGIN
[0m19:03:40.763580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:43.025655 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m19:03:43.026137 [debug] [MainThread]: On master: COMMIT
[0m19:03:43.026424 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:43.026713 [debug] [MainThread]: On master: COMMIT
[0m19:03:43.268566 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:03:43.269007 [debug] [MainThread]: On master: Close
[0m19:03:43.270477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:43.271129 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m19:03:43.271390 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m19:03:43.271677 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m19:03:43.271927 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m19:03:43.272268 [info ] [MainThread]: 
[0m19:03:43.272608 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 22.78 seconds (22.78s).
[0m19:03:43.274041 [debug] [MainThread]: Command end result
[0m19:03:43.330461 [info ] [MainThread]: 
[0m19:03:43.330931 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:03:43.331281 [info ] [MainThread]: 
[0m19:03:43.331687 [error] [MainThread]:   Database Error in model purchase_items (models/purchase/purchase_items.sql)
  column "nubmer" does not exist
  LINE 24:     nubmer,
               ^
  HINT:  Perhaps you meant to reference the column "purchase_items.number".
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m19:03:43.332088 [info ] [MainThread]: 
[0m19:03:43.332948 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:03:43.334183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.19758, "process_user_time": 2.384207, "process_kernel_time": 0.163192, "process_mem_max_rss": "111472", "process_out_blocks": "1824", "command_success": false, "process_in_blocks": "0"}
[0m19:03:43.334719 [debug] [MainThread]: Command `dbt run` failed at 19:03:43.334599 after 23.20 seconds
[0m19:03:43.335160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65738beee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65741ace20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f656fe3e220>]}
[0m19:03:43.335669 [debug] [MainThread]: Flushing usage events
[0m19:04:32.630687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d92b28ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90a06b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90a79fd0>]}


============================== 19:04:32.633019 | 5ba68a97-8f05-4f6d-8c50-5d455f07abd9 ==============================
[0m19:04:32.633019 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:04:32.633567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:32.793229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ba68a97-8f05-4f6d-8c50-5d455f07abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90a0df40>]}
[0m19:04:32.874172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ba68a97-8f05-4f6d-8c50-5d455f07abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d93416e20>]}
[0m19:04:32.875010 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:04:32.883792 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:04:32.910918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:04:32.911825 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/purchase/purchase_items.sql
[0m19:04:32.912404 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/staging/stg_purchase.sql
[0m19:04:33.186821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ba68a97-8f05-4f6d-8c50-5d455f07abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8e782b50>]}
[0m19:04:33.195807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ba68a97-8f05-4f6d-8c50-5d455f07abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ef28a00>]}
[0m19:04:33.196272 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:04:33.196656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ba68a97-8f05-4f6d-8c50-5d455f07abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ef28af0>]}
[0m19:04:33.197966 [info ] [MainThread]: 
[0m19:04:33.198653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:04:33.199682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m19:04:33.208786 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:04:33.209266 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:04:33.209657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:33.211233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m19:04:33.213152 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:04:33.214353 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:04:33.214641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:35.598926 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m19:04:35.599472 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:04:35.599775 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:04:35.854010 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:04:35.855605 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:04:36.106906 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:04:36.179412 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:04:36.179905 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:04:36.180192 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:04:36.481233 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:04:36.482582 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:04:36.771831 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:04:36.778051 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:36.778484 [debug] [MainThread]: On master: BEGIN
[0m19:04:36.778810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:40.011167 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:04:40.011577 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:40.011929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:04:40.316642 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:04:40.318256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ba68a97-8f05-4f6d-8c50-5d455f07abd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ef28760>]}
[0m19:04:40.318701 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:40.627293 [debug] [MainThread]: On master: Close
[0m19:04:40.630157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:40.630613 [info ] [MainThread]: 
[0m19:04:40.633864 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:04:40.634347 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:04:40.635146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m19:04:40.635848 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m19:04:40.636341 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:04:40.637241 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:04:40.659342 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:04:40.660763 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:04:40.649424 => 19:04:40.660461
[0m19:04:40.661149 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:04:40.661562 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:04:40.661357 => 19:04:40.661371
[0m19:04:40.662418 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:04:40.680651 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:04:40.681197 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:04:40.681535 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:04:40.688434 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m19:04:40.687746 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m19:04:40.685878 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:04:40.682486 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:04:40.688874 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:04:40.689249 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:04:40.689753 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:04:40.690141 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:04:40.693409 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:04:40.697486 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:04:40.697948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:40.744467 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:04:40.746043 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:04:40.693715 => 19:04:40.745616
[0m19:04:40.746977 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:04:40.690428 => 19:04:40.746580
[0m19:04:40.747778 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:04:40.748696 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:04:40.698291 => 19:04:40.748391
[0m19:04:40.749083 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:04:40.749638 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:04:40.749397 => 19:04:40.749410
[0m19:04:40.750069 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:04:40.751559 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:04:40.752942 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:04:40.752309 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:04:40.751881 => 19:04:40.751891
[0m19:04:40.750622 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:04:40.750392 => 19:04:40.750402
[0m19:04:40.753837 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m19:04:40.754788 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:04:40.756071 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:04:40.755649 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:04:40.756531 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:04:40.769510 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m19:04:40.768207 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m19:04:40.769910 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:04:40.768680 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:04:40.779036 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m19:04:40.777899 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m19:04:40.781267 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 19:04:40.770397 => 19:04:40.780913
[0m19:04:40.780066 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:04:40.779675 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 19:04:40.757048 => 19:04:40.779383
[0m19:04:40.787198 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:04:40.786538 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m19:04:40.787816 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 19:04:40.787543 => 19:04:40.787556
[0m19:04:40.781861 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:04:40.789115 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:04:40.790103 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 19:04:40.789692 => 19:04:40.789707
[0m19:04:40.790616 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 19:04:40.782173 => 19:04:40.790361
[0m19:04:40.792834 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:04:40.792393 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:04:40.793332 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 19:04:40.793110 => 19:04:40.793121
[0m19:04:40.791184 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:04:40.794569 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:04:40.795351 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m19:04:40.795988 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:04:40.800066 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m19:04:40.801412 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 19:04:40.796271 => 19:04:40.801015
[0m19:04:40.801931 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:04:40.802486 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 19:04:40.802254 => 19:04:40.802265
[0m19:04:40.803389 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:04:44.197327 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m19:04:44.197812 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:04:44.198211 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:04:44.525601 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:04:44.535467 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:04:44.536290 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:04:40.637507 => 19:04:44.535995
[0m19:04:44.537083 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:04:44.537931 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:04:44.537507 => 19:04:44.537518
[0m19:04:44.538542 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m19:04:45.102298 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:04:45.103722 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:04:45.104944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:45.105239 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m19:04:45.105483 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m19:04:45.105717 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m19:04:45.105951 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m19:04:45.107394 [debug] [MainThread]: Command end result
[0m19:04:45.116562 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 12.531012, "process_user_time": 2.476257, "process_kernel_time": 0.107059, "process_mem_max_rss": "113624", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m19:04:45.117137 [debug] [MainThread]: Command `dbt compile` succeeded at 19:04:45.117013 after 12.53 seconds
[0m19:04:45.117493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d92b28ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8d6c7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8f15e160>]}
[0m19:04:45.117834 [debug] [MainThread]: Flushing usage events
[0m19:05:27.995056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda3ea1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1e18bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1e10d00>]}


============================== 19:05:27.997524 | 332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a ==============================
[0m19:05:27.997524 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:05:27.997944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:28.155646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda1e183a0>]}
[0m19:05:28.231920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda478ee80>]}
[0m19:05:28.232578 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:05:28.239706 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:05:28.264360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:28.264715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:28.271783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda0204bb0>]}
[0m19:05:28.282752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda031cc40>]}
[0m19:05:28.283221 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:05:28.283631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda031cb50>]}
[0m19:05:28.285340 [info ] [MainThread]: 
[0m19:05:28.286188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:05:28.287412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:28.288295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:28.306498 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:28.306977 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:28.307304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:28.328300 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:28.328924 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:28.329317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:30.841030 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m19:05:30.842358 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:31.724942 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m19:05:31.726018 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:31.728426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m19:05:31.733679 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:05:31.734271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m19:05:31.735187 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:05:31.736864 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:05:31.737231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:31.737653 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:05:31.738170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:34.750906 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:05:34.751327 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:05:34.751639 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:05:34.770555 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:05:34.770937 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:05:34.771221 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:05:35.054079 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:05:35.055243 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:05:35.067787 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:05:35.068847 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:05:35.370758 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:05:35.385197 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:05:35.390668 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:35.391078 [debug] [MainThread]: On master: BEGIN
[0m19:05:35.391404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:38.717439 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:05:38.717971 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:38.718335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:39.068903 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:05:39.070557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda0261d60>]}
[0m19:05:39.071030 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:39.403397 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:39.403852 [debug] [MainThread]: On master: BEGIN
[0m19:05:40.124715 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m19:05:40.125153 [debug] [MainThread]: On master: COMMIT
[0m19:05:40.125460 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:40.125775 [debug] [MainThread]: On master: COMMIT
[0m19:05:40.497504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:40.497938 [debug] [MainThread]: On master: Close
[0m19:05:40.499407 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:40.500089 [info ] [MainThread]: 
[0m19:05:40.502075 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:05:40.502491 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:05:40.502930 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m19:05:40.503419 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m19:05:40.504014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m19:05:40.504560 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m19:05:40.504912 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:05:40.505670 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:05:40.520066 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:05:40.520914 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:05:40.515302 => 19:05:40.520624
[0m19:05:40.521241 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:05:40.576800 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:40.580204 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m19:05:40.580615 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:05:40.581275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:40.581898 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:05:40.582796 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m19:05:40.583127 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:05:43.196402 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m19:05:43.196845 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:05:43.197184 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as `number`,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from renamed
  );
[0m19:05:43.439222 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "`"
LINE 14:         no as `number`,
                       ^

[0m19:05:43.439694 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: ROLLBACK
[0m19:05:43.679865 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:05:40.521427 => 19:05:43.679556
[0m19:05:43.680274 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m19:05:43.682667 [debug] [Thread-2  ]: Database Error in model stg_purchase (models/staging/stg_purchase.sql)
  syntax error at or near "`"
  LINE 14:         no as `number`,
                         ^
  compiled Code at target/run/windingflowdev/models/staging/stg_purchase.sql
[0m19:05:43.683116 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9c939f10>]}
[0m19:05:43.683641 [error] [Thread-2  ]: 2 of 5 ERROR creating sql view model metrics_test.stg_purchase ................. [[31mERROR[0m in 3.18s]
[0m19:05:43.684184 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:05:43.684895 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:05:43.685608 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:05:43.685261 [info ] [Thread-4  ]: 3 of 5 SKIP relation metrics_test_windingflow.purchase_items ................... [[33mSKIP[0m]
[0m19:05:43.686931 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:05:43.686483 [info ] [Thread-3  ]: 4 of 5 SKIP relation metrics_test_windingflow.purchase_items_day ............... [[33mSKIP[0m]
[0m19:05:43.686066 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:05:43.687456 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:05:43.687902 [info ] [Thread-2  ]: 5 of 5 SKIP relation metrics_test_windingflow.purchase_items_week .............. [[33mSKIP[0m]
[0m19:05:43.688830 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:05:43.748627 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m19:05:43.749147 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:43.749531 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:05:44.039905 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:05:44.049539 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:05:44.050621 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:05:40.506158 => 19:05:44.050151
[0m19:05:44.051311 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:05:44.069624 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m19:05:44.070396 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:44.070798 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m19:05:44.408416 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m19:05:44.413900 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:44.414332 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m19:05:44.732026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:44.734969 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:44.735397 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m19:05:45.022079 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:45.039178 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:05:45.039712 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:45.040140 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:05:45.342687 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:45.348368 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m19:05:45.352560 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:05:45.352967 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m19:05:45.651811 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:05:45.653375 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:05:44.051712 => 19:05:45.653177
[0m19:05:45.653777 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:05:45.655173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332b8a4a-0a1f-4e7d-9c96-5708c1dc2d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9f184a90>]}
[0m19:05:45.656004 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 5.15s]
[0m19:05:45.656641 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:05:45.658050 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:45.658452 [debug] [MainThread]: On master: BEGIN
[0m19:05:45.658772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:48.823775 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:05:48.824236 [debug] [MainThread]: On master: COMMIT
[0m19:05:48.824508 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:48.824771 [debug] [MainThread]: On master: COMMIT
[0m19:05:49.192929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:49.193391 [debug] [MainThread]: On master: Close
[0m19:05:49.194768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:49.195338 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m19:05:49.195619 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m19:05:49.195976 [info ] [MainThread]: 
[0m19:05:49.196334 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 20.91 seconds (20.91s).
[0m19:05:49.197195 [debug] [MainThread]: Command end result
[0m19:05:49.207094 [info ] [MainThread]: 
[0m19:05:49.207547 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:05:49.207869 [info ] [MainThread]: 
[0m19:05:49.208189 [error] [MainThread]:   Database Error in model stg_purchase (models/staging/stg_purchase.sql)
  syntax error at or near "`"
  LINE 14:         no as `number`,
                         ^
  compiled Code at target/run/windingflowdev/models/staging/stg_purchase.sql
[0m19:05:49.208524 [info ] [MainThread]: 
[0m19:05:49.208855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m19:05:49.209604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 21.25687, "process_user_time": 2.169594, "process_kernel_time": 0.103314, "process_mem_max_rss": "109996", "process_out_blocks": "1736", "command_success": false, "process_in_blocks": "0"}
[0m19:05:49.210145 [debug] [MainThread]: Command `dbt run` failed at 19:05:49.210000 after 21.26 seconds
[0m19:05:49.210509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda3ea1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9c7a5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9c7a5550>]}
[0m19:05:49.210865 [debug] [MainThread]: Flushing usage events
[0m19:06:09.222144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82767d9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82746b7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827472efd0>]}


============================== 19:06:09.224488 | 16c4338d-55ec-4862-8a6d-91aa2de925c4 ==============================
[0m19:06:09.224488 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:06:09.224950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m19:06:09.396730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16c4338d-55ec-4862-8a6d-91aa2de925c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82746bcf40>]}
[0m19:06:09.481430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16c4338d-55ec-4862-8a6d-91aa2de925c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82770c7e20>]}
[0m19:06:09.482182 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:06:09.488897 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:06:09.514387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:06:09.515088 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/staging/stg_purchase.sql
[0m19:06:09.781218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16c4338d-55ec-4862-8a6d-91aa2de925c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272835b20>]}
[0m19:06:09.789699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16c4338d-55ec-4862-8a6d-91aa2de925c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272bd6a30>]}
[0m19:06:09.790174 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:06:09.790538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c4338d-55ec-4862-8a6d-91aa2de925c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272bd6af0>]}
[0m19:06:09.791869 [info ] [MainThread]: 
[0m19:06:09.792518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:06:09.793575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m19:06:09.805071 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:06:09.805476 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:06:09.805753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:09.806945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m19:06:09.808917 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:06:09.809266 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:06:09.809530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:12.223285 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m19:06:12.223690 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:06:12.223973 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:06:12.542499 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:06:12.543797 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:06:12.800978 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:06:13.128267 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:06:13.128762 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:06:13.129076 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:06:13.490500 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:06:13.491701 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:06:13.849100 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:06:13.855031 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:13.855413 [debug] [MainThread]: On master: BEGIN
[0m19:06:13.855748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:17.335984 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:06:17.336389 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:17.336912 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:17.754918 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:06:17.756330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c4338d-55ec-4862-8a6d-91aa2de925c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272e600d0>]}
[0m19:06:17.756723 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:18.183799 [debug] [MainThread]: On master: Close
[0m19:06:18.184959 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:18.185454 [info ] [MainThread]: 
[0m19:06:18.187496 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:06:18.188065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m19:06:18.188388 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:06:18.216749 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:06:18.217649 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m19:06:18.218010 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:06:18.221433 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:06:18.222202 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:06:18.218220 => 19:06:18.221908
[0m19:06:18.222524 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:06:18.222907 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:06:18.222715 => 19:06:18.222727
[0m19:06:18.223646 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:06:18.234147 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:06:18.234593 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:06:18.234898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:06:18.242224 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:06:18.243030 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:06:18.243372 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:06:18.246823 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:06:18.247645 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:06:18.243775 => 19:06:18.247335
[0m19:06:18.247966 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:06:18.248354 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:06:18.248159 => 19:06:18.248169
[0m19:06:18.249067 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:06:18.249439 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:06:18.250861 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now model.windingflowdev.purchase_items_day)
[0m19:06:18.250366 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:06:18.251901 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m19:06:18.252303 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:06:18.249907 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:06:18.270816 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_week'
[0m19:06:18.251207 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:06:18.274587 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:06:18.271267 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:06:18.281328 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:06:18.276376 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:06:18.271610 => 19:06:18.275580
[0m19:06:18.281873 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:06:18.282307 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:06:18.282100 => 19:06:18.282111
[0m19:06:18.283059 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:06:18.269442 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m19:06:18.294864 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 19:06:18.252501 => 19:06:18.294492
[0m19:06:18.295666 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:06:18.296067 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 19:06:18.295871 => 19:06:18.295880
[0m19:06:18.295332 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:06:18.277051 => 19:06:18.295100
[0m19:06:18.296815 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:06:18.283431 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:06:18.297160 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:06:18.298395 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m19:06:18.299167 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:06:18.298840 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:06:18.298629 => 19:06:18.298638
[0m19:06:18.297757 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:06:18.366514 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:06:18.367246 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m19:06:18.368350 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:06:18.367905 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:06:18.372308 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m19:06:18.374155 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 19:06:18.368570 => 19:06:18.373883
[0m19:06:18.372992 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m19:06:18.374525 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:06:18.375563 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 19:06:18.375321 => 19:06:18.375335
[0m19:06:18.374895 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:06:18.365724 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m19:06:18.381133 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 19:06:18.299376 => 19:06:18.380683
[0m19:06:18.381483 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:06:18.381893 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 19:06:18.381688 => 19:06:18.381698
[0m19:06:18.380125 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m19:06:18.382723 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:06:18.376423 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:06:18.387082 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 19:06:18.376656 => 19:06:18.386730
[0m19:06:18.388290 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:06:18.388753 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 19:06:18.388538 => 19:06:18.388547
[0m19:06:18.389558 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:06:22.189538 [debug] [Thread-1  ]: SQL status: BEGIN in 4.0 seconds
[0m19:06:22.189970 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:06:22.190327 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:06:22.608427 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:06:22.620676 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:06:22.621584 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:06:18.188580 => 19:06:22.621262
[0m19:06:22.621935 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:06:22.622355 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:06:22.622156 => 19:06:22.622166
[0m19:06:22.622716 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m19:06:23.048522 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:06:23.050674 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:06:23.051855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:23.052151 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m19:06:23.052405 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m19:06:23.052647 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m19:06:23.052891 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m19:06:23.054380 [debug] [MainThread]: Command end result
[0m19:06:23.063101 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 13.888488, "process_user_time": 2.583206, "process_kernel_time": 0.119325, "process_mem_max_rss": "113420", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m19:06:23.063705 [debug] [MainThread]: Command `dbt compile` succeeded at 19:06:23.063579 after 13.89 seconds
[0m19:06:23.064077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82767d9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272cf01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272e0cee0>]}
[0m19:06:23.064450 [debug] [MainThread]: Flushing usage events
[0m19:09:02.421709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1392616ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f139058eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1390582fd0>]}


============================== 19:09:02.423901 | 3892bdce-80a2-4260-a98b-179bc259bc5e ==============================
[0m19:09:02.423901 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:09:02.424332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:09:02.584527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1390514f40>]}
[0m19:09:02.663940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1392f04e20>]}
[0m19:09:02.664654 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:09:02.671402 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:09:02.697129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:02.697566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:02.703366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e97ab80>]}
[0m19:09:02.715404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138ea92b50>]}
[0m19:09:02.715905 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:09:02.716282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138ea92af0>]}
[0m19:09:02.717888 [info ] [MainThread]: 
[0m19:09:02.718794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:09:02.719975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:09:02.721306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:09:02.737600 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:09:02.740199 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:09:02.740589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:02.739878 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:09:02.743482 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:09:02.743878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:04.949998 [debug] [ThreadPool]: SQL status: SELECT 8 in 2.0 seconds
[0m19:09:04.951137 [debug] [ThreadPool]: On list_postgres: Close
[0m19:09:05.045071 [debug] [ThreadPool]: SQL status: SELECT 8 in 2.0 seconds
[0m19:09:05.046357 [debug] [ThreadPool]: On list_postgres: Close
[0m19:09:05.049750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m19:09:05.054594 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:09:05.055204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m19:09:05.056129 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:09:05.057731 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:09:05.058160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:05.058528 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:09:05.059469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:07.313752 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m19:09:07.314169 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:09:07.314474 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:09:07.555074 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:09:07.556312 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:09:07.796115 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:09:08.242150 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:09:08.242543 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:09:08.242816 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:09:08.635638 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:09:08.636808 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:09:09.011085 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:09:09.016742 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:09.017075 [debug] [MainThread]: On master: BEGIN
[0m19:09:09.017340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:12.190679 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:09:12.191087 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:12.191404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:09:12.517238 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:09:12.518808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e983eb0>]}
[0m19:09:12.519211 [debug] [MainThread]: On master: ROLLBACK
[0m19:09:12.831762 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:12.832214 [debug] [MainThread]: On master: BEGIN
[0m19:09:13.493107 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m19:09:13.493570 [debug] [MainThread]: On master: COMMIT
[0m19:09:13.493873 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:13.494177 [debug] [MainThread]: On master: COMMIT
[0m19:09:13.766168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:09:13.766671 [debug] [MainThread]: On master: Close
[0m19:09:13.768252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:09:13.768848 [info ] [MainThread]: 
[0m19:09:13.771676 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:09:13.772106 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m19:09:13.772701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m19:09:13.773008 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:09:13.784700 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:09:13.786839 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m19:09:13.787608 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m19:09:13.787994 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:09:13.794008 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:09:13.814310 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:09:13.788194 => 19:09:13.813949
[0m19:09:13.814668 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:09:13.812706 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:13.830469 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:09:13.831203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:09:13.908192 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m19:09:13.909326 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:09:13.909714 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m19:09:13.910129 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:09:16.849544 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m19:09:16.849970 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:16.850338 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:09:17.057552 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m19:09:17.057984 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:09:17.058446 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from renamed
  );
[0m19:09:17.164502 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:09:17.175740 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:09:17.176564 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:09:13.773194 => 19:09:17.176265
[0m19:09:17.176914 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:09:17.195676 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m19:09:17.196562 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:17.196970 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m19:09:17.397799 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:09:17.403424 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:09:17.403782 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m19:09:17.555379 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m19:09:17.558464 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:17.558880 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m19:09:17.761045 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:17.763906 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:09:17.764247 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m19:09:17.881116 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:17.884437 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:17.884798 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m19:09:18.134018 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:18.147206 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m19:09:18.147584 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:09:18.147905 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m19:09:18.203185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:18.207808 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:09:18.208192 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:18.208531 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:09:18.530242 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:09:18.535719 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m19:09:18.541036 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:09:18.541499 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:09:18.541922 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m19:09:18.544428 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m19:09:18.547158 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:18.547537 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m19:09:18.839458 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:09:18.840964 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:09:17.177144 => 19:09:18.840771
[0m19:09:18.841335 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:09:18.842483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e958160>]}
[0m19:09:18.843243 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 5.07s]
[0m19:09:18.843834 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:09:18.879647 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:09:18.881169 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:09:13.814864 => 19:09:18.880967
[0m19:09:18.881522 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m19:09:18.883862 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138c087d60>]}
[0m19:09:18.884518 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 5.10s]
[0m19:09:18.885101 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:09:18.886138 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:09:18.886623 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:09:18.887063 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m19:09:18.887521 [debug] [Thread-1  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:09:18.888849 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:09:18.888074 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m19:09:18.889750 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:09:18.890419 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m19:09:18.896830 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:09:18.896301 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:09:18.900140 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:09:18.902249 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:09:18.897079 => 19:09:18.901844
[0m19:09:18.902619 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:09:18.889436 [info ] [Thread-1  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m19:09:18.901316 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:09:18.890914 => 19:09:18.900696
[0m19:09:18.910656 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:09:18.909718 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.metricflow_time_spine, now model.windingflowdev.purchase_items_week)
[0m19:09:18.916066 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:09:18.908231 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m19:09:18.921487 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:09:18.921895 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m19:09:18.922344 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:09:18.920261 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:09:18.924271 [debug] [Thread-1  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:09:18.916350 => 19:09:18.923444
[0m19:09:18.925140 [debug] [Thread-1  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:09:18.915529 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m19:09:18.932143 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:09:18.932596 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m19:09:18.932985 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:09:18.933983 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m19:09:18.934866 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:09:18.935289 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m19:09:18.936091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:09:21.184516 [debug] [Thread-3  ]: SQL status: BEGIN in 2.0 seconds
[0m19:09:21.184949 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:09:21.185280 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m19:09:21.219363 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m19:09:21.219800 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:09:21.220120 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m19:09:21.439787 [debug] [Thread-3  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:09:21.442971 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:09:21.443320 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day" rename to "purchase_items_day__dbt_backup"
[0m19:09:21.466484 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:09:21.469336 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:09:21.469710 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week" rename to "purchase_items_week__dbt_backup"
[0m19:09:21.680577 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:21.683318 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:09:21.683663 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m19:09:21.715491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:21.718339 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:09:21.718683 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m19:09:21.925619 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:21.928097 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m19:09:21.928681 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:09:21.929121 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m19:09:21.997784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:09:21.999867 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m19:09:22.000215 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:09:22.000578 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m19:09:22.174688 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:09:22.177500 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m19:09:22.178266 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:09:22.178648 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m19:09:22.263523 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:09:22.266779 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m19:09:22.267651 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:09:22.268049 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m19:09:22.418457 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:09:22.419948 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:09:18.902843 => 19:09:22.419748
[0m19:09:22.420313 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m19:09:22.421350 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138c052280>]}
[0m19:09:22.422208 [info ] [Thread-3  ]: 4 of 5 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 3.53s]
[0m19:09:22.423133 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:09:22.508939 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:09:22.510474 [debug] [Thread-1  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:09:18.925909 => 19:09:22.510278
[0m19:09:22.510834 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: Close
[0m19:09:22.512589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138d8e8cd0>]}
[0m19:09:22.513348 [info ] [Thread-1  ]: 5 of 5 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 14[0m in 3.60s]
[0m19:09:22.514416 [debug] [Thread-1  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:09:22.731112 [debug] [Thread-4  ]: SQL status: BEGIN in 4.0 seconds
[0m19:09:22.731556 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:09:22.731891 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select purchase_id,
    `number`,
    tenant_id,
    app_id,
    sku,
    qty,
    amount,
    amount_rmb,
    unit,
    create_at,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m19:09:23.099429 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 24:     `number`,
                     ^

[0m19:09:23.099894 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: ROLLBACK
[0m19:09:23.482302 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:09:18.910944 => 19:09:23.481962
[0m19:09:23.482929 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m19:09:23.485861 [debug] [Thread-4  ]: Database Error in model purchase_items (models/purchase/purchase_items.sql)
  syntax error at or near ","
  LINE 24:     `number`,
                       ^
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m19:09:23.486384 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3892bdce-80a2-4260-a98b-179bc259bc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e958160>]}
[0m19:09:23.486905 [error] [Thread-4  ]: 3 of 5 ERROR creating sql table model metrics_test_windingflow.purchase_items .. [[31mERROR[0m in 4.60s]
[0m19:09:23.487444 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:09:23.488804 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:23.489108 [debug] [MainThread]: On master: BEGIN
[0m19:09:23.489384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:09:27.248959 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m19:09:27.249392 [debug] [MainThread]: On master: COMMIT
[0m19:09:27.249754 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:27.250032 [debug] [MainThread]: On master: COMMIT
[0m19:09:27.690785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:09:27.691219 [debug] [MainThread]: On master: Close
[0m19:09:27.692594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:27.693226 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m19:09:27.693550 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m19:09:27.693802 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m19:09:27.694050 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m19:09:27.694473 [info ] [MainThread]: 
[0m19:09:27.694851 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 24.98 seconds (24.98s).
[0m19:09:27.695911 [debug] [MainThread]: Command end result
[0m19:09:27.706207 [info ] [MainThread]: 
[0m19:09:27.706618 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:09:27.706896 [info ] [MainThread]: 
[0m19:09:27.707168 [error] [MainThread]:   Database Error in model purchase_items (models/purchase/purchase_items.sql)
  syntax error at or near ","
  LINE 24:     `number`,
                       ^
  compiled Code at target/run/windingflowdev/models/purchase/purchase_items.sql
[0m19:09:27.707523 [info ] [MainThread]: 
[0m19:09:27.707822 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:09:27.708475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.330435, "process_user_time": 2.396771, "process_kernel_time": 0.100119, "process_mem_max_rss": "112332", "process_out_blocks": "1824", "command_success": false, "process_in_blocks": "0"}
[0m19:09:27.708941 [debug] [MainThread]: Command `dbt run` failed at 19:09:27.708828 after 25.33 seconds
[0m19:09:27.709253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1392616ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138ecbb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1392f04e20>]}
[0m19:09:27.709569 [debug] [MainThread]: Flushing usage events
[0m19:09:50.992452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0c245d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0b247430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a1955e0>]}


============================== 19:09:50.995552 | e682a776-fa4c-4387-afa4-e8f4110aebed ==============================
[0m19:09:50.995552 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:09:50.996025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:09:51.179022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e682a776-fa4c-4387-afa4-e8f4110aebed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a1282e0>]}
[0m19:09:51.292648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e682a776-fa4c-4387-afa4-e8f4110aebed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a1228b0>]}
[0m19:09:51.293480 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:09:51.304108 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:09:51.332331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:09:51.333136 [debug] [MainThread]: Partial parsing: updated file: windingflowdev://models/purchase/purchase_items.sql
[0m19:09:51.616347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e682a776-fa4c-4387-afa4-e8f4110aebed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd03e72700>]}
[0m19:09:51.626316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e682a776-fa4c-4387-afa4-e8f4110aebed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd086a8910>]}
[0m19:09:51.626780 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:09:51.627153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e682a776-fa4c-4387-afa4-e8f4110aebed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd086a8a90>]}
[0m19:09:51.628451 [info ] [MainThread]: 
[0m19:09:51.629107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:09:51.630176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m19:09:51.641795 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:09:51.642270 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:09:51.642594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:51.644266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m19:09:51.646369 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:09:51.646759 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:09:51.647058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:54.288732 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:09:54.289366 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:09:54.289992 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:09:54.509399 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m19:09:54.509790 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:09:54.510072 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:09:54.556715 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:09:54.558137 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:09:54.812210 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:09:54.819769 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:09:54.820998 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:09:55.127191 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:09:55.133178 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:55.133519 [debug] [MainThread]: On master: BEGIN
[0m19:09:55.133798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:58.564628 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:09:58.565066 [debug] [MainThread]: Using postgres connection "master"
[0m19:09:58.565406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:09:58.935248 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:09:58.936610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e682a776-fa4c-4387-afa4-e8f4110aebed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd03e065e0>]}
[0m19:09:58.936979 [debug] [MainThread]: On master: ROLLBACK
[0m19:09:59.325681 [debug] [MainThread]: On master: Close
[0m19:09:59.327695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:09:59.328438 [info ] [MainThread]: 
[0m19:09:59.330684 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:09:59.331247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m19:09:59.331572 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:09:59.339582 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:09:59.346528 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m19:09:59.346982 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:09:59.358805 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:09:59.369849 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:09:59.370691 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:09:59.371078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:09:59.372324 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:09:59.347184 => 19:09:59.371938
[0m19:09:59.372782 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:09:59.373354 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:09:59.373120 => 19:09:59.373134
[0m19:09:59.374397 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:09:59.375907 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:09:59.377301 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:09:59.377682 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:09:59.380860 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:09:59.376498 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:09:59.381254 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:09:59.382201 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m19:09:59.383148 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:09:59.377919 => 19:09:59.382897
[0m19:09:59.385534 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:09:59.385113 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:09:59.383945 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m19:09:59.386014 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:09:59.385791 => 19:09:59.385802
[0m19:09:59.389370 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:09:59.392539 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:09:59.386278 => 19:09:59.392207
[0m19:09:59.391665 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:09:59.392896 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:09:59.393928 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:09:59.393720 => 19:09:59.393728
[0m19:09:59.393393 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:09:59.390764 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:09:59.394957 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:09:59.395575 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m19:09:59.402952 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:09:59.404059 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:09:59.403601 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:09:59.416241 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m19:09:59.417329 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:09:59.398123 => 19:09:59.416952
[0m19:09:59.418754 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:09:59.419295 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:09:59.419041 => 19:09:59.419052
[0m19:09:59.420289 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:09:59.420987 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:09:59.417940 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m19:09:59.421565 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 19:09:59.404437 => 19:09:59.421347
[0m19:09:59.422506 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:09:59.422067 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m19:09:59.468462 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:09:59.468044 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m19:09:59.423002 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:09:59.472967 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 19:09:59.472754 => 19:09:59.472766
[0m19:09:59.472441 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 19:09:59.423292 => 19:09:59.472124
[0m19:09:59.471583 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m19:09:59.473741 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m19:09:59.474186 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:09:59.474785 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:09:59.475332 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 19:09:59.475116 => 19:09:59.475125
[0m19:09:59.475941 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m19:09:59.476728 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m19:09:59.477174 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:09:59.480803 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m19:09:59.481420 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 19:09:59.468759 => 19:09:59.481187
[0m19:09:59.481961 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:09:59.482427 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 19:09:59.482229 => 19:09:59.482238
[0m19:09:59.483156 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m19:09:59.483892 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 19:09:59.477634 => 19:09:59.483671
[0m19:09:59.484246 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:09:59.484672 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 19:09:59.484479 => 19:09:59.484485
[0m19:09:59.485378 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m19:10:02.789989 [debug] [Thread-1  ]: SQL status: BEGIN in 3.0 seconds
[0m19:10:02.790476 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:02.790789 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:10:03.176499 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:10:03.185988 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:10:03.186728 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:09:59.331780 => 19:10:03.186486
[0m19:10:03.187069 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:10:03.187525 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:10:03.187276 => 19:10:03.187287
[0m19:10:03.188119 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m19:10:03.571297 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:10:03.572726 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:10:03.574194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:03.574466 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m19:10:03.574699 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m19:10:03.574961 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m19:10:03.575194 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m19:10:03.576557 [debug] [MainThread]: Command end result
[0m19:10:03.585220 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 12.653409, "process_user_time": 2.515514, "process_kernel_time": 0.135114, "process_mem_max_rss": "113780", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m19:10:03.585805 [debug] [MainThread]: Command `dbt compile` succeeded at 19:10:03.585687 after 12.65 seconds
[0m19:10:03.586608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0c245d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0a1228b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd087a6100>]}
[0m19:10:03.586970 [debug] [MainThread]: Flushing usage events
[0m19:10:26.008116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eaae21d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea9f31430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8d8d610>]}


============================== 19:10:26.011545 | 4a89f53d-4e9a-4a11-b8c6-6319c61838ae ==============================
[0m19:10:26.011545 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:10:26.012105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:10:26.202544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8d212e0>]}
[0m19:10:26.288735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8d998b0>]}
[0m19:10:26.289602 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:10:26.296836 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:10:26.327534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:10:26.327934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:10:26.334713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea7185b50>]}
[0m19:10:26.347977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea723db20>]}
[0m19:10:26.348443 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m19:10:26.348791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea723dac0>]}
[0m19:10:26.350235 [info ] [MainThread]: 
[0m19:10:26.350888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:10:26.352058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:10:26.359970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:10:26.369498 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:10:26.372961 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:10:26.373648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:26.372147 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:10:26.375298 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:10:26.375732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:29.282800 [debug] [ThreadPool]: SQL status: SELECT 8 in 3.0 seconds
[0m19:10:29.284063 [debug] [ThreadPool]: On list_postgres: Close
[0m19:10:30.258621 [debug] [ThreadPool]: SQL status: SELECT 8 in 4.0 seconds
[0m19:10:30.259682 [debug] [ThreadPool]: On list_postgres: Close
[0m19:10:30.262404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m19:10:30.267053 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:10:30.267579 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m19:10:30.268389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:30.269491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m19:10:30.271274 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:10:30.271619 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m19:10:30.271900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:32.764783 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m19:10:32.765194 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m19:10:32.765493 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m19:10:33.012591 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:10:33.013726 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m19:10:33.253193 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m19:10:34.027342 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m19:10:34.027739 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m19:10:34.028011 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m19:10:34.368557 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:10:34.369655 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m19:10:34.720007 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m19:10:34.725548 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:34.725859 [debug] [MainThread]: On master: BEGIN
[0m19:10:34.726156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:38.183945 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:10:38.184360 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:38.184765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:10:38.449966 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:10:38.451520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea714a550>]}
[0m19:10:38.451924 [debug] [MainThread]: On master: ROLLBACK
[0m19:10:38.703375 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:38.703821 [debug] [MainThread]: On master: BEGIN
[0m19:10:39.254826 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m19:10:39.255342 [debug] [MainThread]: On master: COMMIT
[0m19:10:39.255700 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:39.256005 [debug] [MainThread]: On master: COMMIT
[0m19:10:39.520012 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:10:39.520581 [debug] [MainThread]: On master: Close
[0m19:10:39.521816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:39.522474 [info ] [MainThread]: 
[0m19:10:39.524909 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m19:10:39.525343 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m19:10:39.525911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.metricflow_time_spine)
[0m19:10:39.526240 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m19:10:39.526629 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m19:10:39.550063 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m19:10:39.550701 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.stg_purchase)
[0m19:10:39.551042 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m19:10:39.562211 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m19:10:39.563085 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 19:10:39.551242 => 19:10:39.562768
[0m19:10:39.563429 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m19:10:39.548599 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:39.571481 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m19:10:39.571904 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:10:39.605221 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m19:10:39.606232 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:10:39.606682 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m19:10:39.607067 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:10:41.766766 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m19:10:41.767208 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:41.767532 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m19:10:42.000905 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m19:10:42.010656 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m19:10:42.011449 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 19:10:39.526906 => 19:10:42.011170
[0m19:10:42.011797 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m19:10:42.031181 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m19:10:42.031973 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:42.032369 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m19:10:42.255312 [debug] [Thread-2  ]: SQL status: BEGIN in 3.0 seconds
[0m19:10:42.255762 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:10:42.256106 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from renamed
  );
[0m19:10:42.335296 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m19:10:42.340570 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:42.341022 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m19:10:42.530868 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:10:42.534078 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:10:42.534535 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m19:10:42.573952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:42.576756 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:42.577106 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m19:10:42.784859 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:42.788538 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:10:42.789112 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m19:10:42.809774 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:42.830690 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:10:42.831248 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:42.831636 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m19:10:43.048926 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:43.050887 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m19:10:43.051251 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:10:43.051573 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m19:10:43.063879 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:10:43.071719 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m19:10:43.076286 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m19:10:43.076725 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m19:10:43.307182 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:10:43.309950 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m19:10:43.312847 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m19:10:43.313296 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m19:10:43.313775 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:10:43.315431 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 19:10:42.012184 => 19:10:43.315223
[0m19:10:43.315796 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m19:10:43.316946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea7155fd0>]}
[0m19:10:43.317674 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 3.79s]
[0m19:10:43.318356 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m19:10:43.604402 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:10:43.605918 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 19:10:39.563632 => 19:10:43.605723
[0m19:10:43.606326 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m19:10:43.607676 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea4060fd0>]}
[0m19:10:43.608595 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 4.06s]
[0m19:10:43.609172 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m19:10:43.610038 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m19:10:43.610811 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m19:10:43.611228 [debug] [Thread-1  ]: Began running node model.windingflowdev.purchase_items_week
[0m19:10:43.610492 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m19:10:43.612854 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m19:10:43.612188 [info ] [Thread-1  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m19:10:43.613705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.windingflowdev.metricflow_time_spine, now model.windingflowdev.purchase_items_week)
[0m19:10:43.614029 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m19:10:43.611620 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m19:10:43.618037 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres, now model.windingflowdev.purchase_items_day)
[0m19:10:43.618458 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m19:10:43.617442 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m19:10:43.613196 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m19:10:43.626417 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m19:10:43.627163 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 19:10:43.623893 => 19:10:43.626885
[0m19:10:43.627512 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m19:10:43.622520 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m19:10:43.633113 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 19:10:43.618657 => 19:10:43.632771
[0m19:10:43.633576 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m19:10:43.632163 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m19:10:43.639911 [debug] [Thread-1  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 19:10:43.614275 => 19:10:43.639550
[0m19:10:43.640475 [debug] [Thread-1  ]: Began executing node model.windingflowdev.purchase_items_week
[0m19:10:43.639067 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m19:10:43.648242 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:10:43.648768 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m19:10:43.649087 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:10:43.650285 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:10:43.650663 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m19:10:43.650998 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:10:43.647193 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m19:10:43.651999 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:10:43.652338 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m19:10:43.652644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:10:45.902614 [debug] [Thread-4  ]: SQL status: BEGIN in 2.0 seconds
[0m19:10:45.903064 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:10:45.903412 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select purchase_id,
    number,
    tenant_id,
    app_id,
    sku,
    qty,
    amount,
    amount_rmb,
    unit,
    create_at,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m19:10:46.146139 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m19:10:46.148959 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:10:46.149298 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items" rename to "purchase_items__dbt_backup"
[0m19:10:46.387914 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:46.390955 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:10:46.391300 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m19:10:46.625366 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:46.627400 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: COMMIT
[0m19:10:46.627751 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:10:46.628067 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: COMMIT
[0m19:10:46.865094 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:10:46.868196 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m19:10:46.868909 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m19:10:46.869243 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m19:10:47.105500 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:10:47.106981 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 19:10:43.627701 => 19:10:47.106788
[0m19:10:47.107327 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m19:10:47.108531 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8f7c7e80>]}
[0m19:10:47.109433 [info ] [Thread-4  ]: 3 of 5 OK created sql table model metrics_test_windingflow.purchase_items ...... [[32mSELECT 15[0m in 3.50s]
[0m19:10:47.110026 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m19:10:47.122543 [debug] [Thread-3  ]: SQL status: BEGIN in 3.0 seconds
[0m19:10:47.123000 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:10:47.123418 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m19:10:47.238006 [debug] [Thread-1  ]: SQL status: BEGIN in 4.0 seconds
[0m19:10:47.238529 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:10:47.238866 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m19:10:47.471208 [debug] [Thread-3  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:10:47.474972 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:10:47.475354 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day" rename to "purchase_items_day__dbt_backup"
[0m19:10:47.649523 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:10:47.652548 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:10:47.652962 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week" rename to "purchase_items_week__dbt_backup"
[0m19:10:47.846522 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:47.849918 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:10:47.850295 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m19:10:48.031392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:48.034474 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:10:48.034815 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m19:10:48.229595 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:48.231595 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m19:10:48.231942 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:10:48.232253 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m19:10:48.388732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:10:48.390874 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m19:10:48.391224 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:10:48.391535 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m19:10:48.626863 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:10:48.630441 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m19:10:48.631156 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m19:10:48.631485 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m19:10:48.758019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:10:48.795303 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m19:10:48.796096 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m19:10:48.796445 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m19:10:49.011899 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:10:49.013350 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 19:10:43.633852 => 19:10:49.013155
[0m19:10:49.013701 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m19:10:49.014914 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8f707dc0>]}
[0m19:10:49.015900 [info ] [Thread-3  ]: 4 of 5 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 5.40s]
[0m19:10:49.016595 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m19:10:49.182621 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:10:49.184077 [debug] [Thread-1  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 19:10:43.640790 => 19:10:49.183880
[0m19:10:49.184431 [debug] [Thread-1  ]: On model.windingflowdev.purchase_items_week: Close
[0m19:10:49.185671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a89f53d-4e9a-4a11-b8c6-6319c61838ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8f707be0>]}
[0m19:10:49.186571 [info ] [Thread-1  ]: 5 of 5 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 14[0m in 5.57s]
[0m19:10:49.187147 [debug] [Thread-1  ]: Finished running node model.windingflowdev.purchase_items_week
[0m19:10:49.189104 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:49.189395 [debug] [MainThread]: On master: BEGIN
[0m19:10:49.189643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:51.482788 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m19:10:51.483248 [debug] [MainThread]: On master: COMMIT
[0m19:10:51.483516 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:51.483769 [debug] [MainThread]: On master: COMMIT
[0m19:10:51.745111 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:10:51.745525 [debug] [MainThread]: On master: Close
[0m19:10:51.746615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:51.747128 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m19:10:51.747480 [debug] [MainThread]: Connection 'model.windingflowdev.stg_purchase' was properly closed.
[0m19:10:51.747849 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m19:10:51.748213 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m19:10:51.748570 [info ] [MainThread]: 
[0m19:10:51.748920 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 25.40 seconds (25.40s).
[0m19:10:51.749956 [debug] [MainThread]: Command end result
[0m19:10:51.758143 [info ] [MainThread]: 
[0m19:10:51.758553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:10:51.758843 [info ] [MainThread]: 
[0m19:10:51.759152 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:10:51.759786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.80317, "process_user_time": 2.416193, "process_kernel_time": 0.157314, "process_mem_max_rss": "111528", "process_out_blocks": "1816", "process_in_blocks": "0"}
[0m19:10:51.760257 [debug] [MainThread]: Command `dbt run` succeeded at 19:10:51.760142 after 25.80 seconds
[0m19:10:51.760574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eaae21d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea73e26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea73d7e20>]}
[0m19:10:51.760886 [debug] [MainThread]: Flushing usage events
[0m19:11:03.871205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80562d37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8054d95820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8054d95220>]}


============================== 19:11:03.872732 | 15233da7-1c63-46bb-8d93-dd11f903c6d1 ==============================
[0m19:11:03.872732 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:11:03.873143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt query --metrics purchase_total_metrics --group-by purchase_id__create_at', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:03.873510 [info ] [MainThread]: dbt version: 1.7.4
[0m19:11:03.873771 [info ] [MainThread]: python version: 3.8.10
[0m19:11:03.874021 [info ] [MainThread]: python path: /usr/bin/python3
[0m19:11:03.874281 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m19:11:03.950807 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m19:11:03.951284 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m19:11:03.951616 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m19:11:03.952078 [info ] [MainThread]: adapter type: postgres
[0m19:11:03.952338 [info ] [MainThread]: adapter version: 1.7.4
[0m19:11:04.025060 [info ] [MainThread]: Configuration:
[0m19:11:04.025441 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:11:04.025719 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:11:04.025980 [info ] [MainThread]: Required dependencies:
[0m19:11:04.026302 [debug] [MainThread]: Executing "git --help"
[0m19:11:04.031727 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:11:04.032409 [debug] [MainThread]: STDERR: "b''"
[0m19:11:04.032744 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:11:04.033016 [info ] [MainThread]: Connection:
[0m19:11:04.033342 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m19:11:04.033597 [info ] [MainThread]:   port: 5432
[0m19:11:04.033840 [info ] [MainThread]:   user: postgres
[0m19:11:04.034083 [info ] [MainThread]:   database: postgres
[0m19:11:04.034349 [info ] [MainThread]:   schema: metrics_test
[0m19:11:04.034591 [info ] [MainThread]:   connect_timeout: 10
[0m19:11:04.034839 [info ] [MainThread]:   role: None
[0m19:11:04.035081 [info ] [MainThread]:   search_path: None
[0m19:11:04.035337 [info ] [MainThread]:   keepalives_idle: 0
[0m19:11:04.035580 [info ] [MainThread]:   sslmode: None
[0m19:11:04.035822 [info ] [MainThread]:   sslcert: None
[0m19:11:04.036063 [info ] [MainThread]:   sslkey: None
[0m19:11:04.036384 [info ] [MainThread]:   sslrootcert: None
[0m19:11:04.036821 [info ] [MainThread]:   application_name: dbt
[0m19:11:04.037237 [info ] [MainThread]:   retries: 1
[0m19:11:04.037845 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:11:04.038517 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:11:04.038865 [debug] [MainThread]: Using postgres connection "debug"
[0m19:11:04.039166 [debug] [MainThread]: On debug: select 1 as id
[0m19:11:04.039473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:07.355939 [debug] [MainThread]: SQL status: SELECT 1 in 3.0 seconds
[0m19:11:07.357260 [debug] [MainThread]: On debug: Close
[0m19:11:07.358538 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:11:07.359106 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:11:07.360390 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.53232, "process_user_time": 2.135876, "process_kernel_time": 0.16029, "process_mem_max_rss": "147360", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m19:11:07.360989 [debug] [MainThread]: Command `cli debug` succeeded at 19:11:07.360857 after 3.53 seconds
[0m19:11:07.361313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:11:07.361665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80562d37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8053439c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8053461850>]}
[0m19:11:07.362066 [debug] [MainThread]: Flushing usage events
[0m19:11:09.205205 [debug] [MainThread]: Acquiring new postgres connection 'MetricFlow_request_mf_rid__drnu7ve5'
[0m19:11:09.205623 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__drnu7ve5"
[0m19:11:09.205912 [debug] [MainThread]: On MetricFlow_request_mf_rid__drnu7ve5: BEGIN
[0m19:11:09.206248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:12.586392 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m19:11:12.586805 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__drnu7ve5"
[0m19:11:12.587163 [debug] [MainThread]: On MetricFlow_request_mf_rid__drnu7ve5: -- Read Elements From Semantic Model 'purchase_items'
-- Metric Time Dimension 'create_at'
-- Pass Only Elements:
--   ['purchase_total', 'purchase_id__create_at__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', create_at) AS purchase_id__create_at__day
  , SUM(purchase_amount_usd) AS purchase_total_metrics
FROM "postgres"."metrics_test_windingflow"."purchase_items" purchase_items_src_0
GROUP BY
  DATE_TRUNC('day', create_at)
-- MF_REQUEST_METADATA: {"tag_dict": {"MF_REQUEST_ID": "mf_rid__drnu7ve5"}}
[0m19:11:12.898441 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:11:12.899768 [debug] [MainThread]: On MetricFlow_request_mf_rid__drnu7ve5: ROLLBACK
[0m19:11:13.251115 [debug] [MainThread]: On MetricFlow_request_mf_rid__drnu7ve5: Close
[0m19:11:27.259949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964d22700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9637e3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9637e3730>]}


============================== 19:11:27.261517 | 8aadc43a-ce2c-42bc-a02a-a724381e452f ==============================
[0m19:11:27.261517 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:11:27.261890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'invocation_command': 'dbt query --metrics purchase_total_metrics --group-by purchase_id__sku', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:27.262291 [info ] [MainThread]: dbt version: 1.7.4
[0m19:11:27.262552 [info ] [MainThread]: python version: 3.8.10
[0m19:11:27.262803 [info ] [MainThread]: python path: /usr/bin/python3
[0m19:11:27.263089 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m19:11:27.332907 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m19:11:27.333274 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m19:11:27.333573 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m19:11:27.333969 [info ] [MainThread]: adapter type: postgres
[0m19:11:27.334253 [info ] [MainThread]: adapter version: 1.7.4
[0m19:11:27.400148 [info ] [MainThread]: Configuration:
[0m19:11:27.400520 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:11:27.400781 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:11:27.401033 [info ] [MainThread]: Required dependencies:
[0m19:11:27.401300 [debug] [MainThread]: Executing "git --help"
[0m19:11:27.406725 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:11:27.407325 [debug] [MainThread]: STDERR: "b''"
[0m19:11:27.407661 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:11:27.407933 [info ] [MainThread]: Connection:
[0m19:11:27.408247 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m19:11:27.408554 [info ] [MainThread]:   port: 5432
[0m19:11:27.408817 [info ] [MainThread]:   user: postgres
[0m19:11:27.409061 [info ] [MainThread]:   database: postgres
[0m19:11:27.409303 [info ] [MainThread]:   schema: metrics_test
[0m19:11:27.409659 [info ] [MainThread]:   connect_timeout: 10
[0m19:11:27.409996 [info ] [MainThread]:   role: None
[0m19:11:27.410422 [info ] [MainThread]:   search_path: None
[0m19:11:27.410736 [info ] [MainThread]:   keepalives_idle: 0
[0m19:11:27.411125 [info ] [MainThread]:   sslmode: None
[0m19:11:27.411572 [info ] [MainThread]:   sslcert: None
[0m19:11:27.411840 [info ] [MainThread]:   sslkey: None
[0m19:11:27.412089 [info ] [MainThread]:   sslrootcert: None
[0m19:11:27.412338 [info ] [MainThread]:   application_name: dbt
[0m19:11:27.412587 [info ] [MainThread]:   retries: 1
[0m19:11:27.413010 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m19:11:27.413742 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:11:27.414086 [debug] [MainThread]: Using postgres connection "debug"
[0m19:11:27.414395 [debug] [MainThread]: On debug: select 1 as id
[0m19:11:27.414675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:29.608949 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m19:11:29.610122 [debug] [MainThread]: On debug: Close
[0m19:11:29.611026 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:11:29.611379 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:11:29.612597 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3962204, "process_user_time": 2.094621, "process_kernel_time": 0.16425, "process_mem_max_rss": "147656", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m19:11:29.613207 [debug] [MainThread]: Command `cli debug` succeeded at 19:11:29.613078 after 2.40 seconds
[0m19:11:29.613534 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:11:29.613885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964d22700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc961f25280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964768520>]}
[0m19:11:29.614298 [debug] [MainThread]: Flushing usage events
[0m19:11:30.845077 [debug] [MainThread]: Acquiring new postgres connection 'MetricFlow_request_mf_rid__81l9et2b'
[0m19:11:30.845518 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__81l9et2b"
[0m19:11:30.845833 [debug] [MainThread]: On MetricFlow_request_mf_rid__81l9et2b: BEGIN
[0m19:11:30.846172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:34.347944 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m19:11:34.348424 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__81l9et2b"
[0m19:11:34.348698 [debug] [MainThread]: On MetricFlow_request_mf_rid__81l9et2b: -- Read Elements From Semantic Model 'purchase_items'
-- Metric Time Dimension 'create_at'
-- Pass Only Elements:
--   ['purchase_total', 'purchase_id__sku']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  sku AS purchase_id__sku
  , SUM(purchase_amount_usd) AS purchase_total_metrics
FROM "postgres"."metrics_test_windingflow"."purchase_items" purchase_items_src_0
GROUP BY
  sku
-- MF_REQUEST_METADATA: {"tag_dict": {"MF_REQUEST_ID": "mf_rid__81l9et2b"}}
[0m19:11:34.709849 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m19:11:34.711031 [debug] [MainThread]: On MetricFlow_request_mf_rid__81l9et2b: ROLLBACK
[0m19:11:35.057070 [debug] [MainThread]: On MetricFlow_request_mf_rid__81l9et2b: Close
[0m20:16:12.412521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb48fe5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb47aa7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb47aa7160>]}


============================== 20:16:12.414211 | 038207c3-856b-48f4-8f16-13c2c30e4534 ==============================
[0m20:16:12.414211 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:16:12.414653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt list dimensions --metrics purchase_total_metrics', 'send_anonymous_usage_stats': 'True'}
[0m20:16:12.415058 [info ] [MainThread]: dbt version: 1.7.4
[0m20:16:12.415420 [info ] [MainThread]: python version: 3.8.10
[0m20:16:12.415710 [info ] [MainThread]: python path: /usr/bin/python3
[0m20:16:12.415998 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m20:16:12.486711 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m20:16:12.487183 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m20:16:12.487510 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m20:16:12.488030 [info ] [MainThread]: adapter type: postgres
[0m20:16:12.488361 [info ] [MainThread]: adapter version: 1.7.4
[0m20:16:12.556433 [info ] [MainThread]: Configuration:
[0m20:16:12.556871 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:16:12.557186 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:16:12.557484 [info ] [MainThread]: Required dependencies:
[0m20:16:12.557835 [debug] [MainThread]: Executing "git --help"
[0m20:16:12.565515 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:16:12.566357 [debug] [MainThread]: STDERR: "b''"
[0m20:16:12.566793 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:16:12.567157 [info ] [MainThread]: Connection:
[0m20:16:12.567550 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m20:16:12.567898 [info ] [MainThread]:   port: 5432
[0m20:16:12.568221 [info ] [MainThread]:   user: postgres
[0m20:16:12.568543 [info ] [MainThread]:   database: postgres
[0m20:16:12.568884 [info ] [MainThread]:   schema: metrics_test
[0m20:16:12.569206 [info ] [MainThread]:   connect_timeout: 10
[0m20:16:12.569531 [info ] [MainThread]:   role: None
[0m20:16:12.569869 [info ] [MainThread]:   search_path: None
[0m20:16:12.570207 [info ] [MainThread]:   keepalives_idle: 0
[0m20:16:12.570531 [info ] [MainThread]:   sslmode: None
[0m20:16:12.570871 [info ] [MainThread]:   sslcert: None
[0m20:16:12.571201 [info ] [MainThread]:   sslkey: None
[0m20:16:12.571521 [info ] [MainThread]:   sslrootcert: None
[0m20:16:12.571819 [info ] [MainThread]:   application_name: dbt
[0m20:16:12.572107 [info ] [MainThread]:   retries: 1
[0m20:16:12.572565 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m20:16:12.573253 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:16:12.573643 [debug] [MainThread]: Using postgres connection "debug"
[0m20:16:12.573997 [debug] [MainThread]: On debug: select 1 as id
[0m20:16:12.574329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:17.789337 [debug] [MainThread]: SQL status: SELECT 1 in 5.0 seconds
[0m20:16:17.790682 [debug] [MainThread]: On debug: Close
[0m20:16:17.791489 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:16:17.791848 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:16:17.793086 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.4249053, "process_user_time": 2.128434, "process_kernel_time": 0.148309, "process_mem_max_rss": "147708", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m20:16:17.793831 [debug] [MainThread]: Command `cli debug` succeeded at 20:16:17.793676 after 5.43 seconds
[0m20:16:17.794268 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:16:17.794709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb48fe5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb48bbb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb46152e20>]}
[0m20:16:17.795195 [debug] [MainThread]: Flushing usage events
[0m20:16:33.923275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76093817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607e42880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607e42190>]}


============================== 20:16:33.924890 | f0d6e474-088c-4fa8-9c6a-11cb48884ef5 ==============================
[0m20:16:33.924890 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:16:33.925284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt query --metrics purchase_total_metrics --group-by metric_time', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:33.925676 [info ] [MainThread]: dbt version: 1.7.4
[0m20:16:33.925948 [info ] [MainThread]: python version: 3.8.10
[0m20:16:33.926212 [info ] [MainThread]: python path: /usr/bin/python3
[0m20:16:33.926470 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m20:16:34.001127 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m20:16:34.001712 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m20:16:34.001967 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m20:16:34.002468 [info ] [MainThread]: adapter type: postgres
[0m20:16:34.002749 [info ] [MainThread]: adapter version: 1.7.4
[0m20:16:34.071449 [info ] [MainThread]: Configuration:
[0m20:16:34.071843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:16:34.072125 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:16:34.072386 [info ] [MainThread]: Required dependencies:
[0m20:16:34.072702 [debug] [MainThread]: Executing "git --help"
[0m20:16:34.079404 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:16:34.080496 [debug] [MainThread]: STDERR: "b''"
[0m20:16:34.080968 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:16:34.081305 [info ] [MainThread]: Connection:
[0m20:16:34.081730 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m20:16:34.082050 [info ] [MainThread]:   port: 5432
[0m20:16:34.082384 [info ] [MainThread]:   user: postgres
[0m20:16:34.082662 [info ] [MainThread]:   database: postgres
[0m20:16:34.082947 [info ] [MainThread]:   schema: metrics_test
[0m20:16:34.083295 [info ] [MainThread]:   connect_timeout: 10
[0m20:16:34.083620 [info ] [MainThread]:   role: None
[0m20:16:34.083889 [info ] [MainThread]:   search_path: None
[0m20:16:34.084177 [info ] [MainThread]:   keepalives_idle: 0
[0m20:16:34.084429 [info ] [MainThread]:   sslmode: None
[0m20:16:34.084716 [info ] [MainThread]:   sslcert: None
[0m20:16:34.084966 [info ] [MainThread]:   sslkey: None
[0m20:16:34.085216 [info ] [MainThread]:   sslrootcert: None
[0m20:16:34.085467 [info ] [MainThread]:   application_name: dbt
[0m20:16:34.085717 [info ] [MainThread]:   retries: 1
[0m20:16:34.086173 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m20:16:34.086870 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:16:34.087213 [debug] [MainThread]: Using postgres connection "debug"
[0m20:16:34.087517 [debug] [MainThread]: On debug: select 1 as id
[0m20:16:34.087853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:38.202315 [debug] [MainThread]: SQL status: SELECT 1 in 4.0 seconds
[0m20:16:38.203580 [debug] [MainThread]: On debug: Close
[0m20:16:38.204696 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:16:38.205061 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:16:38.206304 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.328108, "process_user_time": 2.162442, "process_kernel_time": 0.159589, "process_mem_max_rss": "147492", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m20:16:38.206924 [debug] [MainThread]: Command `cli debug` succeeded at 20:16:38.206789 after 4.33 seconds
[0m20:16:38.207267 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:16:38.207632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76093817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7608f8d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76064eec70>]}
[0m20:16:38.208041 [debug] [MainThread]: Flushing usage events
[0m20:16:43.315785 [debug] [MainThread]: Acquiring new postgres connection 'MetricFlow_request_mf_rid__s2f3173r'
[0m20:16:43.316485 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__s2f3173r"
[0m20:16:43.316872 [debug] [MainThread]: On MetricFlow_request_mf_rid__s2f3173r: BEGIN
[0m20:16:43.317206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:47.456482 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m20:16:47.456926 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__s2f3173r"
[0m20:16:47.457245 [debug] [MainThread]: On MetricFlow_request_mf_rid__s2f3173r: -- Read Elements From Semantic Model 'purchase_items'
-- Metric Time Dimension 'create_at'
-- Pass Only Elements:
--   ['purchase_total', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', create_at) AS metric_time__day
  , SUM(purchase_amount_usd) AS purchase_total_metrics
FROM "postgres"."metrics_test_windingflow"."purchase_items" purchase_items_src_0
GROUP BY
  DATE_TRUNC('day', create_at)
-- MF_REQUEST_METADATA: {"tag_dict": {"MF_REQUEST_ID": "mf_rid__s2f3173r"}}
[0m20:16:47.876461 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m20:16:47.877879 [debug] [MainThread]: On MetricFlow_request_mf_rid__s2f3173r: ROLLBACK
[0m20:16:48.335210 [debug] [MainThread]: On MetricFlow_request_mf_rid__s2f3173r: Close
[0m20:50:10.992217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6993580f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699145ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69914d5d00>]}


============================== 20:50:10.994577 | c7e11cf7-389d-4abc-a5e8-e4b139f902e6 ==============================
[0m20:50:10.994577 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:50:10.995044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:11.150700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7e11cf7-389d-4abc-a5e8-e4b139f902e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699145e3a0>]}
[0m20:50:11.236208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7e11cf7-389d-4abc-a5e8-e4b139f902e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6993e6ee80>]}
[0m20:50:11.236908 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m20:50:11.243983 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:50:11.270001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:50:11.270675 [debug] [MainThread]: Partial parsing: added file: windingflowdev://models/metrics_models/purchase_items_metrics.sql
[0m20:50:11.405607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7e11cf7-389d-4abc-a5e8-e4b139f902e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698f6fb250>]}
[0m20:50:11.414913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7e11cf7-389d-4abc-a5e8-e4b139f902e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698f846370>]}
[0m20:50:11.415376 [info ] [MainThread]: Found 6 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m20:50:11.415752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e11cf7-389d-4abc-a5e8-e4b139f902e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698fb736d0>]}
[0m20:50:11.417162 [info ] [MainThread]: 
[0m20:50:11.417819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:11.418992 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m20:50:11.428089 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m20:50:11.428545 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m20:50:11.428860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:11.430514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m20:50:11.432490 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m20:50:11.432850 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m20:50:11.433146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:14.504165 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m20:50:14.504594 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m20:50:14.504906 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m20:50:14.840899 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:50:14.842072 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m20:50:15.165215 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m20:50:15.665049 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m20:50:15.665437 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m20:50:15.665709 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m20:50:16.127449 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m20:50:16.128637 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m20:50:16.580943 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m20:50:16.586844 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:16.587206 [debug] [MainThread]: On master: BEGIN
[0m20:50:16.587486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:22.368502 [debug] [MainThread]: SQL status: BEGIN in 6.0 seconds
[0m20:50:22.368925 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:22.369277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:22.862071 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:50:22.863490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e11cf7-389d-4abc-a5e8-e4b139f902e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698f8776d0>]}
[0m20:50:22.863960 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:23.320407 [debug] [MainThread]: On master: Close
[0m20:50:23.321983 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:23.322765 [info ] [MainThread]: 
[0m20:50:23.324855 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m20:50:23.325424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m20:50:23.325785 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m20:50:23.338443 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m20:50:23.339098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m20:50:23.339447 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m20:50:23.346989 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m20:50:23.363427 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 20:50:23.339650 => 20:50:23.363028
[0m20:50:23.363797 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m20:50:23.364178 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 20:50:23.363986 => 20:50:23.363998
[0m20:50:23.364910 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m20:50:23.368015 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m20:50:23.368528 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m20:50:23.368981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:23.372440 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m20:50:23.373892 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m20:50:23.372884 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m20:50:23.376648 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m20:50:23.374224 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m20:50:23.379923 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m20:50:23.377075 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m20:50:23.384360 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m20:50:23.386414 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 20:50:23.380222 => 20:50:23.385788
[0m20:50:23.385188 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 20:50:23.377296 => 20:50:23.384888
[0m20:50:23.373233 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m20:50:23.394551 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m20:50:23.387296 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m20:50:23.396101 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 20:50:23.395865 => 20:50:23.395880
[0m20:50:23.397189 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m20:50:23.386888 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m20:50:23.398878 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 20:50:23.398425 => 20:50:23.398480
[0m20:50:23.397934 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m20:50:23.400357 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m20:50:23.400725 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m20:50:23.395535 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m20:50:23.399720 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m20:50:23.426411 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m20:50:23.426967 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m20:50:23.427296 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m20:50:23.417889 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m20:50:23.423346 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m20:50:23.433337 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m20:50:23.438932 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 20:50:23.400925 => 20:50:23.438535
[0m20:50:23.439396 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 20:50:23.413940 => 20:50:23.439164
[0m20:50:23.440319 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m20:50:23.440757 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 20:50:23.440557 => 20:50:23.440569
[0m20:50:23.441528 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m20:50:23.439872 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m20:50:23.442583 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 20:50:23.442376 => 20:50:23.442384
[0m20:50:23.442021 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_metrics
[0m20:50:23.443280 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m20:50:23.445427 [debug] [Thread-4  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m20:50:23.443988 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now model.windingflowdev.purchase_items_metrics)
[0m20:50:23.446593 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_metrics
[0m20:50:23.444817 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 20:50:23.427612 => 20:50:23.444368
[0m20:50:23.446044 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m20:50:23.450812 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m20:50:23.450396 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m20:50:23.460163 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m20:50:23.460697 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 20:50:23.460447 => 20:50:23.460462
[0m20:50:23.466151 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m20:50:23.466569 [debug] [Thread-3  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m20:50:23.468077 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m20:50:23.467418 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 20:50:23.451037 => 20:50:23.467102
[0m20:50:23.468419 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m20:50:23.462117 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_metrics (compile): 20:50:23.446885 => 20:50:23.461884
[0m20:50:23.468766 [debug] [Thread-4  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m20:50:23.474758 [debug] [Thread-4  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 20:50:23.474471 => 20:50:23.474485
[0m20:50:23.475496 [debug] [Thread-4  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m20:50:23.473688 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m20:50:23.478964 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 20:50:23.469017 => 20:50:23.478675
[0m20:50:23.479425 [debug] [Thread-3  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m20:50:23.479972 [debug] [Thread-3  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 20:50:23.479768 => 20:50:23.479778
[0m20:50:23.481072 [debug] [Thread-3  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m20:50:23.482401 [debug] [Thread-2  ]: Compilation Error in model purchase_items_metrics (models/metrics_models/purchase_items_metrics.sql)
  'metrics' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:50:23.482882 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_metrics
[0m20:50:30.595109 [debug] [Thread-1  ]: SQL status: BEGIN in 7.0 seconds
[0m20:50:30.595583 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m20:50:30.595946 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m20:50:30.888452 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m20:50:30.898173 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m20:50:30.899343 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 20:50:23.325972 => 20:50:30.898742
[0m20:50:30.900083 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m20:50:30.900540 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 20:50:30.900335 => 20:50:30.900347
[0m20:50:30.900917 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m20:50:31.199047 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m20:50:31.200513 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m20:50:31.201299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:31.201731 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m20:50:31.202078 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_metrics' was properly closed.
[0m20:50:31.202367 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m20:50:31.202604 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m20:50:31.202966 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model purchase_items_metrics (models/metrics_models/purchase_items_metrics.sql)
    'metrics' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:50:31.203616 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 20.254951, "process_user_time": 2.224471, "process_kernel_time": 0.108022, "process_mem_max_rss": "111012", "process_in_blocks": "192", "process_out_blocks": "1760", "command_success": false}
[0m20:50:31.204072 [debug] [MainThread]: Command `dbt compile` failed at 20:50:31.203961 after 20.26 seconds
[0m20:50:31.204366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6993580f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698f734bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698f83df40>]}
[0m20:50:31.204674 [debug] [MainThread]: Flushing usage events
[0m20:50:55.270279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8185ccee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd816524790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8165246a0>]}


============================== 20:50:55.272400 | 7477bc99-966d-4e9d-9cae-cfb559f8d988 ==============================
[0m20:50:55.272400 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:50:55.272871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:55.355088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7477bc99-966d-4e9d-9cae-cfb559f8d988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd816524760>]}
[0m20:50:55.355667 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:50:55.356282 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:50:55.357329 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13011964, "process_user_time": 1.713027, "process_kernel_time": 0.060036, "process_mem_max_rss": "91924", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m20:50:55.357955 [debug] [MainThread]: Command `dbt deps` succeeded at 20:50:55.357833 after 0.13 seconds
[0m20:50:55.358464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8185ccee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd816449b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd81640ba60>]}
[0m20:50:55.358797 [debug] [MainThread]: Flushing usage events
[0m21:06:13.749795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6cb4deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6aa2a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6aa9dfd0>]}


============================== 21:06:13.751996 | 0cb65ad8-5b4b-4881-a8dd-f393caaa56e5 ==============================
[0m21:06:13.751996 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:06:13.752429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:06:13.906509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb65ad8-5b4b-4881-a8dd-f393caaa56e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6aa31f40>]}
[0m21:06:13.982878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb65ad8-5b4b-4881-a8dd-f393caaa56e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6b30eac0>]}
[0m21:06:13.983549 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:06:13.984171 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:06:13.984822 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.27932274, "process_user_time": 1.900043, "process_kernel_time": 0.071699, "process_mem_max_rss": "98064", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m21:06:13.985299 [debug] [MainThread]: Command `dbt compile` failed at 21:06:13.985185 after 0.28 seconds
[0m21:06:13.985622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6cb4deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac69054a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac69054610>]}
[0m21:06:13.985936 [debug] [MainThread]: Flushing usage events
[0m21:06:28.527402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13155a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131704f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1313507700>]}


============================== 21:06:28.529553 | fb1e3db9-efbd-404f-ba29-80d6c9832ed7 ==============================
[0m21:06:28.529553 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:06:28.529976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:28.617524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb1e3db9-efbd-404f-ba29-80d6c9832ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13135077c0>]}
[0m21:06:28.618894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g72rv9u5'
[0m21:06:28.619579 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:06:31.008725 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:06:31.009274 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m21:06:31.464124 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m21:06:31.466046 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: >=1.5.0-a1, <1.6.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m21:06:31.466797 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 2.9828353, "process_user_time": 1.755938, "process_kernel_time": 0.075997, "process_mem_max_rss": "94140", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m21:06:31.467286 [debug] [MainThread]: Command `dbt deps` failed at 21:06:31.467161 after 2.98 seconds
[0m21:06:31.467613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13155a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13134172b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1313417b50>]}
[0m21:06:31.467954 [debug] [MainThread]: Flushing usage events
[0m21:06:53.196218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10782ebeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1079d6b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10762396a0>]}


============================== 21:06:53.198390 | 0ad27ff0-69ef-453c-9e18-d5a669c0f2e2 ==============================
[0m21:06:53.198390 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:06:53.198868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-version-check deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:53.282238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ad27ff0-69ef-453c-9e18-d5a669c0f2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1076239760>]}
[0m21:06:53.283124 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o5xiwa3r'
[0m21:06:53.283775 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:06:54.923889 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:06:54.924540 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m21:06:56.540762 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m21:06:56.542372 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:06:57.276413 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:06:57.282695 [info ] [MainThread]: Updating lock file in file path: /home/shaw/Projects/windingflow/windingflowdev/package-lock.yml
[0m21:06:57.285958 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yo1i3bno'
[0m21:06:57.289573 [info ] [MainThread]: Installing dbt-labs/metrics
[0m21:06:59.120999 [info ] [MainThread]: Installed from version 1.5.1
[0m21:06:59.121461 [info ] [MainThread]: Up to date!
[0m21:06:59.121958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0ad27ff0-69ef-453c-9e18-d5a669c0f2e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1078bd8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1078bd8f70>]}
[0m21:06:59.122680 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:07:01.286701 [info ] [MainThread]: Installed from version 1.0.0
[0m21:07:01.287219 [info ] [MainThread]: Updated version available: 1.1.1
[0m21:07:01.287680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0ad27ff0-69ef-453c-9e18-d5a669c0f2e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10761397c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1076233a00>]}
[0m21:07:01.288124 [info ] [MainThread]: 
[0m21:07:01.288560 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:07:01.289612 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.136525, "process_user_time": 1.868169, "process_kernel_time": 0.124011, "process_mem_max_rss": "94988", "process_out_blocks": "5176", "process_in_blocks": "0"}
[0m21:07:01.290133 [debug] [MainThread]: Command `dbt deps` succeeded at 21:07:01.290004 after 8.14 seconds
[0m21:07:01.290474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10782ebeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107618e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1076233910>]}
[0m21:07:01.290819 [debug] [MainThread]: Flushing usage events
[0m21:10:49.600546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd2b14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0a4f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0a4fa60>]}


============================== 21:10:49.602855 | 82e3d0fe-4799-49a9-81e0-e775c894933d ==============================
[0m21:10:49.602855 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:10:49.603372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:10:49.777691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82e3d0fe-4799-49a9-81e0-e775c894933d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd09f2b20>]}
[0m21:10:49.863029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82e3d0fe-4799-49a9-81e0-e775c894933d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd33fde80>]}
[0m21:10:49.863767 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:10:49.872818 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'metrics' package.
      Installed version of dbt: =1.7.4
      Required version of dbt for 'metrics': ['>=1.5.0-a1', '<1.6.0']
    Check for a different version of the 'metrics' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/shaw/Projects/windingflow/windingflowdev/dbt_packages/metrics/dbt_project.yml

Error encountered in /home/shaw/Projects/windingflow/windingflowdev/dbt_packages/metrics
[0m21:10:49.874381 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.32054514, "process_user_time": 1.912718, "process_kernel_time": 0.10759, "process_mem_max_rss": "98116", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m21:10:49.875078 [debug] [MainThread]: Command `dbt compile` failed at 21:10:49.874902 after 0.32 seconds
[0m21:10:49.875503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd2b14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ccf10a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ccf0826d0>]}
[0m21:10:49.875909 [debug] [MainThread]: Flushing usage events
[0m21:11:27.636269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f2876cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f07cde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f07cd700>]}


============================== 21:11:27.638539 | 1c8dcb4c-46ac-43d6-925e-f75755299669 ==============================
[0m21:11:27.638539 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:11:27.639162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:11:27.725168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8dcb4c-46ac-43d6-925e-f75755299669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f07cd730>]}
[0m21:11:27.725818 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:11:27.736552 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:11:27.737370 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1428128, "process_user_time": 1.761342, "process_kernel_time": 0.063615, "process_mem_max_rss": "91844", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m21:11:27.737893 [debug] [MainThread]: Command `dbt deps` succeeded at 21:11:27.737767 after 0.14 seconds
[0m21:11:27.738242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f2876cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f070ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f070af10>]}
[0m21:11:27.738587 [debug] [MainThread]: Flushing usage events
[0m21:11:36.991329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767a020eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7677efdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7677f74fd0>]}


============================== 21:11:36.993572 | 98f7398c-3ef9-4ff1-9807-8fa750b7962e ==============================
[0m21:11:36.993572 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:11:36.994045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:37.171470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f7398c-3ef9-4ff1-9807-8fa750b7962e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7677f06f40>]}
[0m21:11:37.269886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f7398c-3ef9-4ff1-9807-8fa750b7962e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767a90de20>]}
[0m21:11:37.270895 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:11:37.278272 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:11:37.308772 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m21:11:37.309470 [debug] [MainThread]: Partial parsing: deleted file: windingflowdev://models/metrics_models/purchase_items_metrics.sql
[0m21:11:37.326680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f7398c-3ef9-4ff1-9807-8fa750b7962e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767637a4c0>]}
[0m21:11:37.344002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f7398c-3ef9-4ff1-9807-8fa750b7962e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7676422ee0>]}
[0m21:11:37.344744 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m21:11:37.345392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f7398c-3ef9-4ff1-9807-8fa750b7962e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7676422e80>]}
[0m21:11:37.347454 [info ] [MainThread]: 
[0m21:11:37.348466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:11:37.349753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m21:11:37.370029 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m21:11:37.377112 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m21:11:37.377496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:37.381603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m21:11:37.384527 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m21:11:37.384996 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m21:11:37.385881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:42.480901 [debug] [ThreadPool]: SQL status: BEGIN in 5.0 seconds
[0m21:11:42.481631 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m21:11:42.481920 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m21:11:42.785360 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:11:42.786787 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m21:11:43.096199 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m21:11:43.774556 [debug] [ThreadPool]: SQL status: BEGIN in 6.0 seconds
[0m21:11:43.775322 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m21:11:43.775957 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m21:11:44.271777 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:11:44.273327 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m21:11:44.733897 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m21:11:44.740164 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:44.740549 [debug] [MainThread]: On master: BEGIN
[0m21:11:44.740800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:48.852004 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m21:11:48.852434 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:48.852751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:11:49.294912 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:11:49.296323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f7398c-3ef9-4ff1-9807-8fa750b7962e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767669afd0>]}
[0m21:11:49.296758 [debug] [MainThread]: On master: ROLLBACK
[0m21:11:49.747691 [debug] [MainThread]: On master: Close
[0m21:11:49.748740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:11:49.749173 [info ] [MainThread]: 
[0m21:11:49.751289 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m21:11:49.751850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m21:11:49.752178 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m21:11:49.766448 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m21:11:49.767578 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m21:11:49.767967 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m21:11:49.772699 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m21:11:49.773760 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 21:11:49.768169 => 21:11:49.773345
[0m21:11:49.774211 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m21:11:49.774681 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 21:11:49.774468 => 21:11:49.774481
[0m21:11:49.775482 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m21:11:49.793142 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:11:49.794272 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m21:11:49.797056 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m21:11:49.797503 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m21:11:49.800481 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m21:11:49.795402 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m21:11:49.801279 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m21:11:49.801662 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m21:11:49.805514 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m21:11:49.794889 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m21:11:49.807547 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m21:11:49.808005 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m21:11:49.813045 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m21:11:49.806499 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 21:11:49.797759 => 21:11:49.806245
[0m21:11:49.816263 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m21:11:49.816938 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 21:11:49.816608 => 21:11:49.816624
[0m21:11:49.815406 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 21:11:49.801902 => 21:11:49.814950
[0m21:11:49.819834 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m21:11:49.820743 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 21:11:49.820198 => 21:11:49.820208
[0m21:11:49.822883 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m21:11:49.821752 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 21:11:49.808271 => 21:11:49.821406
[0m21:11:49.824237 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m21:11:49.824890 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 21:11:49.824583 => 21:11:49.824594
[0m21:11:49.796174 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m21:11:49.827653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:11:49.819268 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m21:11:49.829456 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:11:49.830864 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m21:11:49.831497 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:11:49.823587 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:11:49.842891 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m21:11:49.843775 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:11:49.826630 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m21:11:49.850449 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:11:49.851435 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m21:11:49.851868 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:11:49.864783 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m21:11:49.871291 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 21:11:49.831841 => 21:11:49.871030
[0m21:11:49.870075 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m21:11:49.868496 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m21:11:49.874236 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 21:11:49.844128 => 21:11:49.873701
[0m21:11:49.872725 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 21:11:49.852180 => 21:11:49.872301
[0m21:11:49.871817 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:11:49.875896 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 21:11:49.875649 => 21:11:49.875667
[0m21:11:49.875332 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:11:49.874862 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:11:49.878867 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 21:11:49.878582 => 21:11:49.878598
[0m21:11:49.878154 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 21:11:49.877848 => 21:11:49.877863
[0m21:11:49.877396 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:11:49.881879 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:11:49.881299 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:11:49.879965 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:11:49.882756 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m21:11:49.883630 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:11:49.887915 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m21:11:49.889108 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 21:11:49.883949 => 21:11:49.888859
[0m21:11:49.889504 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:11:49.889970 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 21:11:49.889739 => 21:11:49.889750
[0m21:11:49.890916 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:11:54.124974 [debug] [Thread-1  ]: SQL status: BEGIN in 4.0 seconds
[0m21:11:54.125435 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:11:54.125805 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m21:11:54.579806 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m21:11:54.590308 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m21:11:54.591124 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 21:11:49.752368 => 21:11:54.590876
[0m21:11:54.591511 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m21:11:54.591918 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 21:11:54.591720 => 21:11:54.591730
[0m21:11:54.592250 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m21:11:55.041947 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m21:11:55.043973 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m21:11:55.045565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:55.045890 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695' was properly closed.
[0m21:11:55.046163 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m21:11:55.046435 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m21:11:55.046696 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m21:11:55.048269 [debug] [MainThread]: Command end result
[0m21:11:55.057872 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 18.110271, "process_user_time": 2.184227, "process_kernel_time": 0.127546, "process_mem_max_rss": "109760", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m21:11:55.058488 [debug] [MainThread]: Command `dbt compile` succeeded at 21:11:55.058354 after 18.11 seconds
[0m21:11:55.058823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767a020eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f767a90de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76765361f0>]}
[0m21:11:55.059154 [debug] [MainThread]: Flushing usage events
[0m21:23:10.926213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9bba45ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b99a4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b9998fd0>]}


============================== 21:23:10.929000 | bc515306-4273-4d02-8204-8212ea5d539f ==============================
[0m21:23:10.929000 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:23:10.929507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:23:11.139469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc515306-4273-4d02-8204-8212ea5d539f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b992ff40>]}
[0m21:23:11.228609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc515306-4273-4d02-8204-8212ea5d539f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9bc335e20>]}
[0m21:23:11.229393 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:23:11.236690 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:23:11.263725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:11.264297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:11.270440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc515306-4273-4d02-8204-8212ea5d539f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b7d90b80>]}
[0m21:23:11.283110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc515306-4273-4d02-8204-8212ea5d539f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b7e45b50>]}
[0m21:23:11.283694 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m21:23:11.284159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc515306-4273-4d02-8204-8212ea5d539f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b7e45af0>]}
[0m21:23:11.286052 [info ] [MainThread]: 
[0m21:23:11.287025 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:23:11.288348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test_windingflow'
[0m21:23:11.289179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metrics_test'
[0m21:23:11.309796 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m21:23:11.310621 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m21:23:11.311591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:11.314224 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m21:23:11.314606 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m21:23:11.315002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:15.658422 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m21:23:15.658985 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m21:23:15.659391 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m21:23:15.668122 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m21:23:15.668513 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m21:23:15.668793 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m21:23:16.120954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:23:16.122686 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m21:23:16.155132 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:23:16.156379 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m21:23:16.587770 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m21:23:16.637916 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m21:23:16.644136 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:16.644541 [debug] [MainThread]: On master: BEGIN
[0m21:23:16.644843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:23.750378 [debug] [MainThread]: SQL status: BEGIN in 7.0 seconds
[0m21:23:23.750822 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:23.751334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:23:24.290637 [debug] [MainThread]: SQL status: SELECT 7 in 1.0 seconds
[0m21:23:24.292295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc515306-4273-4d02-8204-8212ea5d539f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b7dede80>]}
[0m21:23:24.292796 [debug] [MainThread]: On master: ROLLBACK
[0m21:23:24.767460 [debug] [MainThread]: On master: Close
[0m21:23:24.769280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:24.769753 [info ] [MainThread]: 
[0m21:23:24.773388 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m21:23:24.773864 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m21:23:24.774545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m21:23:24.775175 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m21:23:24.775567 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m21:23:24.775938 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m21:23:24.787143 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m21:23:24.788159 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 21:23:24.781967 => 21:23:24.787778
[0m21:23:24.788519 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m21:23:24.788919 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 21:23:24.788719 => 21:23:24.788731
[0m21:23:24.789741 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m21:23:24.816020 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m21:23:24.816864 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m21:23:24.817245 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m21:23:24.825202 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m21:23:24.826118 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 21:23:24.817462 => 21:23:24.825811
[0m21:23:24.826490 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m21:23:24.827198 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 21:23:24.826786 => 21:23:24.826806
[0m21:23:24.828423 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m21:23:24.832076 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items_day
[0m21:23:24.832651 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_week
[0m21:23:24.833016 [debug] [Thread-2  ]: Began running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:23:24.842985 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695)
[0m21:23:24.843647 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:23:24.839123 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_week'
[0m21:23:24.863989 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m21:23:24.836827 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:23:24.868041 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m21:23:24.868379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:23:24.838082 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items, now model.windingflowdev.purchase_items_day)
[0m21:23:24.868963 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m21:23:24.877143 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m21:23:24.867578 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m21:23:24.879972 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 21:23:24.869426 => 21:23:24.877726
[0m21:23:24.882716 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items_day
[0m21:23:24.883177 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 21:23:24.882952 => 21:23:24.882965
[0m21:23:24.884060 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items_day
[0m21:23:24.881348 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695"
[0m21:23:24.882295 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 21:23:24.864318 => 21:23:24.881932
[0m21:23:24.885069 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_week
[0m21:23:24.885513 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 21:23:24.885297 => 21:23:24.885307
[0m21:23:24.886360 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_week
[0m21:23:24.884544 [debug] [Thread-4  ]: Began running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:23:24.888168 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_day, now test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232)
[0m21:23:24.887500 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (compile): 21:23:24.843915 => 21:23:24.887256
[0m21:23:24.889829 [debug] [Thread-2  ]: Began executing node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:23:24.886774 [debug] [Thread-3  ]: Began running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:23:24.890319 [debug] [Thread-2  ]: Timing info for test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695 (execute): 21:23:24.890066 => 21:23:24.890080
[0m21:23:24.895648 [debug] [Thread-2  ]: Finished running node test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695
[0m21:23:24.894668 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.windingflowdev.purchase_items_week, now test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506)
[0m21:23:24.896144 [debug] [Thread-2  ]: Began running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:23:24.897381 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.windingflowdev.not_null_stg_purchase_purchase_id.591cd6e695, now test.windingflowdev.unique_purchase_items_purchase_id.35f0595649)
[0m21:23:24.896641 [debug] [Thread-3  ]: Began compiling node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:23:24.897917 [debug] [Thread-2  ]: Began compiling node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:23:24.889302 [debug] [Thread-4  ]: Began compiling node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:23:24.919032 [debug] [Thread-4  ]: Writing injected SQL for node "test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232"
[0m21:23:24.914578 [debug] [Thread-3  ]: Writing injected SQL for node "test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506"
[0m21:23:24.920058 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (compile): 21:23:24.898206 => 21:23:24.919703
[0m21:23:24.920438 [debug] [Thread-3  ]: Began executing node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:23:24.920866 [debug] [Thread-3  ]: Timing info for test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506 (execute): 21:23:24.920655 => 21:23:24.920667
[0m21:23:24.914044 [debug] [Thread-2  ]: Writing injected SQL for node "test.windingflowdev.unique_purchase_items_purchase_id.35f0595649"
[0m21:23:24.921935 [debug] [Thread-3  ]: Finished running node test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506
[0m21:23:24.930948 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (compile): 21:23:24.915339 => 21:23:24.930599
[0m21:23:24.931614 [debug] [Thread-4  ]: Began executing node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:23:24.932044 [debug] [Thread-4  ]: Timing info for test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232 (execute): 21:23:24.931833 => 21:23:24.931843
[0m21:23:24.933182 [debug] [Thread-4  ]: Finished running node test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232
[0m21:23:24.934364 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (compile): 21:23:24.906253 => 21:23:24.933916
[0m21:23:24.934946 [debug] [Thread-2  ]: Began executing node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:23:24.935488 [debug] [Thread-2  ]: Timing info for test.windingflowdev.unique_purchase_items_purchase_id.35f0595649 (execute): 21:23:24.935219 => 21:23:24.935232
[0m21:23:24.936715 [debug] [Thread-2  ]: Finished running node test.windingflowdev.unique_purchase_items_purchase_id.35f0595649
[0m21:23:29.463513 [debug] [Thread-1  ]: SQL status: BEGIN in 5.0 seconds
[0m21:23:29.463971 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:23:29.464368 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m21:23:29.992559 [debug] [Thread-1  ]: SQL status: SELECT 1 in 1.0 seconds
[0m21:23:30.003386 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m21:23:30.004337 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 21:23:24.776213 => 21:23:30.004096
[0m21:23:30.004767 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m21:23:30.005217 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 21:23:30.004999 => 21:23:30.005010
[0m21:23:30.005655 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: ROLLBACK
[0m21:23:30.627821 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m21:23:30.629217 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m21:23:30.630478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:30.630772 [debug] [MainThread]: Connection 'test.windingflowdev.unique_purchase_items_purchase_id.35f0595649' was properly closed.
[0m21:23:30.631067 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m21:23:30.631305 [debug] [MainThread]: Connection 'test.windingflowdev.unique_stg_purchase_purchase_id.c8634cc232' was properly closed.
[0m21:23:30.631536 [debug] [MainThread]: Connection 'test.windingflowdev.not_null_purchase_items_purchase_id.6ab1551506' was properly closed.
[0m21:23:30.632947 [debug] [MainThread]: Command end result
[0m21:23:30.641179 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 19.761501, "process_user_time": 2.368291, "process_kernel_time": 0.083446, "process_mem_max_rss": "109048", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m21:23:30.642293 [debug] [MainThread]: Command `dbt compile` succeeded at 21:23:30.642050 after 19.76 seconds
[0m21:23:30.642703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9bba45ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9bc335e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b7f5e1f0>]}
[0m21:23:30.643058 [debug] [MainThread]: Flushing usage events
[0m21:23:44.799266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c7b3f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c793447f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c79344700>]}


============================== 21:23:44.802503 | 99e221ad-5c20-4230-887b-a6b32e816ef7 ==============================
[0m21:23:44.802503 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:23:44.803057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:23:44.803560 [info ] [MainThread]: dbt version: 1.7.4
[0m21:23:44.803921 [info ] [MainThread]: python version: 3.8.10
[0m21:23:44.804265 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:23:44.804602 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m21:23:44.886870 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m21:23:44.887412 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m21:23:44.887937 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m21:23:44.888730 [info ] [MainThread]: adapter type: postgres
[0m21:23:44.889099 [info ] [MainThread]: adapter version: 1.7.4
[0m21:23:44.968148 [info ] [MainThread]: Configuration:
[0m21:23:44.968709 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:23:44.969064 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:23:44.969507 [info ] [MainThread]: Required dependencies:
[0m21:23:44.969930 [debug] [MainThread]: Executing "git --help"
[0m21:23:44.976241 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:23:44.977137 [debug] [MainThread]: STDERR: "b''"
[0m21:23:44.977549 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:23:44.978122 [info ] [MainThread]: Connection:
[0m21:23:44.978667 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m21:23:44.979002 [info ] [MainThread]:   port: 5432
[0m21:23:44.979369 [info ] [MainThread]:   user: postgres
[0m21:23:44.979686 [info ] [MainThread]:   database: postgres
[0m21:23:44.979998 [info ] [MainThread]:   schema: metrics_test
[0m21:23:44.980319 [info ] [MainThread]:   connect_timeout: 10
[0m21:23:44.980704 [info ] [MainThread]:   role: None
[0m21:23:44.981260 [info ] [MainThread]:   search_path: None
[0m21:23:44.981731 [info ] [MainThread]:   keepalives_idle: 0
[0m21:23:44.982609 [info ] [MainThread]:   sslmode: None
[0m21:23:44.982992 [info ] [MainThread]:   sslcert: None
[0m21:23:44.983314 [info ] [MainThread]:   sslkey: None
[0m21:23:44.983633 [info ] [MainThread]:   sslrootcert: None
[0m21:23:44.983949 [info ] [MainThread]:   application_name: dbt
[0m21:23:44.984271 [info ] [MainThread]:   retries: 1
[0m21:23:44.984793 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:23:44.985626 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:23:44.986125 [debug] [MainThread]: Using postgres connection "debug"
[0m21:23:44.986529 [debug] [MainThread]: On debug: select 1 as id
[0m21:23:44.986875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:50.570641 [debug] [MainThread]: SQL status: SELECT 1 in 6.0 seconds
[0m21:23:50.571824 [debug] [MainThread]: On debug: Close
[0m21:23:50.572416 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:23:50.572968 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:23:50.573989 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.8201885, "process_user_time": 1.902484, "process_kernel_time": 0.115422, "process_mem_max_rss": "100004", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:23:50.574692 [debug] [MainThread]: Command `dbt debug` succeeded at 21:23:50.574554 after 5.82 seconds
[0m21:23:50.575102 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:23:50.575598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c7b3f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c7a617d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c77ada610>]}
[0m21:23:50.576139 [debug] [MainThread]: Flushing usage events
[0m21:25:28.832026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3fa04d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ea22430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3d9745e0>]}


============================== 21:25:28.836198 | 0846ef8d-4f3b-42e5-b062-25018428a08b ==============================
[0m21:25:28.836198 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:25:28.836821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:25:29.030327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3d9042e0>]}
[0m21:25:29.123596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3d9788b0>]}
[0m21:25:29.124803 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:25:29.132744 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:25:29.161537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:29.162012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:29.167881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3bd68b50>]}
[0m21:25:29.180126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3be80b20>]}
[0m21:25:29.180667 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 1 metric, 401 macros, 0 groups, 1 semantic model
[0m21:25:29.181051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3be80ac0>]}
[0m21:25:29.182565 [info ] [MainThread]: 
[0m21:25:29.183309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:29.184782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:25:29.186317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:25:29.196980 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:25:29.201392 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:25:29.201811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:29.200706 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:25:29.202612 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:25:29.202944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:34.592557 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.0 seconds
[0m21:25:34.593870 [debug] [ThreadPool]: On list_postgres: Close
[0m21:25:34.744311 [debug] [ThreadPool]: SQL status: SELECT 8 in 6.0 seconds
[0m21:25:34.745494 [debug] [ThreadPool]: On list_postgres: Close
[0m21:25:34.747927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test_windingflow)
[0m21:25:34.753838 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m21:25:34.754585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_metrics_test)
[0m21:25:34.755192 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: BEGIN
[0m21:25:34.757820 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m21:25:34.758294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:34.758625 [debug] [ThreadPool]: On list_postgres_metrics_test: BEGIN
[0m21:25:34.759333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:37.992930 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m21:25:37.993356 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test_windingflow"
[0m21:25:37.993664 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test_windingflow"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test_windingflow'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test_windingflow'
  
[0m21:25:38.300534 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:25:38.301713 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: ROLLBACK
[0m21:25:38.600181 [debug] [ThreadPool]: On list_postgres_metrics_test_windingflow: Close
[0m21:25:39.171896 [debug] [ThreadPool]: SQL status: BEGIN in 4.0 seconds
[0m21:25:39.172297 [debug] [ThreadPool]: Using postgres connection "list_postgres_metrics_test"
[0m21:25:39.172582 [debug] [ThreadPool]: On list_postgres_metrics_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "list_postgres_metrics_test"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'metrics_test'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'metrics_test'
  
[0m21:25:39.675369 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.0 seconds
[0m21:25:39.676730 [debug] [ThreadPool]: On list_postgres_metrics_test: ROLLBACK
[0m21:25:40.128165 [debug] [ThreadPool]: On list_postgres_metrics_test: Close
[0m21:25:40.133721 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:40.134158 [debug] [MainThread]: On master: BEGIN
[0m21:25:40.134457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:44.527330 [debug] [MainThread]: SQL status: BEGIN in 4.0 seconds
[0m21:25:44.527810 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:44.528208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:45.052346 [debug] [MainThread]: SQL status: SELECT 7 in 1.0 seconds
[0m21:25:45.054064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3bd71130>]}
[0m21:25:45.054556 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:45.585541 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:45.585989 [debug] [MainThread]: On master: BEGIN
[0m21:25:46.558151 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:25:46.558586 [debug] [MainThread]: On master: COMMIT
[0m21:25:46.558936 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:46.559299 [debug] [MainThread]: On master: COMMIT
[0m21:25:47.136848 [debug] [MainThread]: SQL status: COMMIT in 1.0 seconds
[0m21:25:47.137271 [debug] [MainThread]: On master: Close
[0m21:25:47.138854 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:47.139685 [info ] [MainThread]: 
[0m21:25:47.142406 [debug] [Thread-1  ]: Began running node model.windingflowdev.metricflow_time_spine
[0m21:25:47.142927 [info ] [Thread-1  ]: 1 of 5 START sql table model metrics_test_windingflow.metricflow_time_spine .... [RUN]
[0m21:25:47.143497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test, now model.windingflowdev.metricflow_time_spine)
[0m21:25:47.143877 [debug] [Thread-1  ]: Began compiling node model.windingflowdev.metricflow_time_spine
[0m21:25:47.151519 [debug] [Thread-2  ]: Began running node model.windingflowdev.stg_purchase
[0m21:25:47.152095 [info ] [Thread-2  ]: 2 of 5 START sql view model metrics_test.stg_purchase .......................... [RUN]
[0m21:25:47.152881 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_metrics_test_windingflow, now model.windingflowdev.stg_purchase)
[0m21:25:47.153239 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.stg_purchase
[0m21:25:47.159617 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.stg_purchase"
[0m21:25:47.160637 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (compile): 21:25:47.153502 => 21:25:47.160313
[0m21:25:47.177175 [debug] [Thread-2  ]: Began executing node model.windingflowdev.stg_purchase
[0m21:25:47.222561 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:47.228237 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: BEGIN
[0m21:25:47.228675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:25:47.236188 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.stg_purchase"
[0m21:25:47.237583 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m21:25:47.238057 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: BEGIN
[0m21:25:47.238452 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:25:49.695946 [debug] [Thread-2  ]: SQL status: BEGIN in 2.0 seconds
[0m21:25:49.696506 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m21:25:49.696919 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */

  create view "postgres"."metrics_test"."stg_purchase__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."metrics_test"."purchase_sync"
),

renamed as (
    select
        id as purchase_id,
        no as number,
        tenantId as tenant_id,
        appId as app_id,
        sku as sku,
        qty as qty,
        amount as amount,
        (amount * 7) as amount_rmb,
        unit as unit,
        date_trunc('day', createAt) as create_at
    from source
)

select * from renamed
  );
[0m21:25:49.936994 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:25:49.943971 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m21:25:49.944483 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase" rename to "stg_purchase__dbt_backup"
[0m21:25:50.181598 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:50.184739 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m21:25:50.185212 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
alter table "postgres"."metrics_test"."stg_purchase__dbt_tmp" rename to "stg_purchase"
[0m21:25:50.424131 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:50.438732 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m21:25:50.439232 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m21:25:50.439589 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: COMMIT
[0m21:25:50.678566 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m21:25:50.685199 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test"."stg_purchase__dbt_backup"
[0m21:25:50.689481 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.stg_purchase"
[0m21:25:50.689930 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.stg_purchase"} */
drop view if exists "postgres"."metrics_test"."stg_purchase__dbt_backup" cascade
[0m21:25:50.928020 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m21:25:50.929510 [debug] [Thread-2  ]: Timing info for model.windingflowdev.stg_purchase (execute): 21:25:47.177528 => 21:25:50.929308
[0m21:25:50.929869 [debug] [Thread-2  ]: On model.windingflowdev.stg_purchase: Close
[0m21:25:50.931018 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ad07400>]}
[0m21:25:50.931712 [info ] [Thread-2  ]: 2 of 5 OK created sql view model metrics_test.stg_purchase ..................... [[32mCREATE VIEW[0m in 3.78s]
[0m21:25:50.932283 [debug] [Thread-2  ]: Finished running node model.windingflowdev.stg_purchase
[0m21:25:50.932970 [debug] [Thread-4  ]: Began running node model.windingflowdev.purchase_items
[0m21:25:50.933812 [debug] [Thread-3  ]: Began running node model.windingflowdev.purchase_items_day
[0m21:25:50.933381 [info ] [Thread-4  ]: 3 of 5 START sql table model metrics_test_windingflow.purchase_items ........... [RUN]
[0m21:25:50.935553 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items'
[0m21:25:50.934790 [info ] [Thread-3  ]: 4 of 5 START sql table model metrics_test_windingflow.purchase_items_day ....... [RUN]
[0m21:25:50.936524 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.windingflowdev.purchase_items_day'
[0m21:25:50.935898 [debug] [Thread-4  ]: Began compiling node model.windingflowdev.purchase_items
[0m21:25:50.940843 [debug] [Thread-4  ]: Writing injected SQL for node "model.windingflowdev.purchase_items"
[0m21:25:50.936864 [debug] [Thread-3  ]: Began compiling node model.windingflowdev.purchase_items_day
[0m21:25:50.934330 [debug] [Thread-2  ]: Began running node model.windingflowdev.purchase_items_week
[0m21:25:50.945035 [debug] [Thread-3  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_day"
[0m21:25:50.951552 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (compile): 21:25:50.941315 => 21:25:50.951239
[0m21:25:50.946717 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (compile): 21:25:50.937479 => 21:25:50.946387
[0m21:25:50.950691 [info ] [Thread-2  ]: 5 of 5 START sql table model metrics_test_windingflow.purchase_items_week ...... [RUN]
[0m21:25:50.952265 [debug] [Thread-3  ]: Began executing node model.windingflowdev.purchase_items_day
[0m21:25:50.952760 [debug] [Thread-4  ]: Began executing node model.windingflowdev.purchase_items
[0m21:25:50.953334 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.windingflowdev.stg_purchase, now model.windingflowdev.purchase_items_week)
[0m21:25:50.984002 [debug] [Thread-2  ]: Began compiling node model.windingflowdev.purchase_items_week
[0m21:25:50.988502 [debug] [Thread-2  ]: Writing injected SQL for node "model.windingflowdev.purchase_items_week"
[0m21:25:50.996503 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (compile): 21:25:50.984380 => 21:25:50.996150
[0m21:25:51.003372 [debug] [Thread-2  ]: Began executing node model.windingflowdev.purchase_items_week
[0m21:25:51.007747 [debug] [Thread-2  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_week"
[0m21:25:51.008750 [debug] [Thread-3  ]: Writing runtime sql for node "model.windingflowdev.purchase_items_day"
[0m21:25:51.011269 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m21:25:51.011766 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: BEGIN
[0m21:25:51.012139 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:25:51.002904 [debug] [Thread-4  ]: Writing runtime sql for node "model.windingflowdev.purchase_items"
[0m21:25:51.010026 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m21:25:51.013124 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: BEGIN
[0m21:25:51.014212 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:25:51.013823 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m21:25:51.015105 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: BEGIN
[0m21:25:51.015776 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:25:54.443808 [debug] [Thread-1  ]: SQL status: BEGIN in 7.0 seconds
[0m21:25:54.444364 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:54.444803 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */


        select 
        ((to_date('01/01/2027','mm/dd/yyyy'))::date - (to_date('01/01/2000','mm/dd/yyyy'))::date)
    
[0m21:25:54.548275 [debug] [Thread-4  ]: SQL status: BEGIN in 4.0 seconds
[0m21:25:54.548756 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m21:25:54.549082 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select purchase_id,
    number,
    tenant_id,
    app_id,
    sku,
    qty,
    amount,
    amount_rmb,
    unit,
    create_at,
    (amount * qty) as purchase_amount_usd
    from purchase_items
)

select * from renamed
  );
  
[0m21:25:54.870291 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m21:25:54.873246 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m21:25:54.873575 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items" rename to "purchase_items__dbt_backup"
[0m21:25:54.944116 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m21:25:54.954896 [debug] [Thread-1  ]: Writing injected SQL for node "model.windingflowdev.metricflow_time_spine"
[0m21:25:54.955881 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (compile): 21:25:47.144093 => 21:25:54.955569
[0m21:25:54.956251 [debug] [Thread-1  ]: Began executing node model.windingflowdev.metricflow_time_spine
[0m21:25:54.960161 [debug] [Thread-1  ]: Writing runtime sql for node "model.windingflowdev.metricflow_time_spine"
[0m21:25:54.960912 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:54.961315 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp"
  
  
    as
  
  (
    

with days as (

    


    


    with rawdata as (

        

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 9862
    order by generated_number



    ),

    all_periods as (

        select (
            

    to_date('01/01/2000','mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))


        ) as date_day
        from rawdata

    ),

    filtered as (

        select *
        from all_periods
        where date_day <= to_date('01/01/2027','mm/dd/yyyy')

    )

    select * from filtered



),

final as (
    select cast(date_day as date) as date_day
    from days
)

select * from final
  );
  
[0m21:25:55.015056 [debug] [Thread-2  ]: SQL status: BEGIN in 4.0 seconds
[0m21:25:55.015580 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m21:25:55.015945 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('week', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m21:25:55.186010 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:55.189488 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m21:25:55.189908 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items__dbt_tmp" rename to "purchase_items"
[0m21:25:55.411575 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:25:55.415454 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m21:25:55.415844 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week" rename to "purchase_items_week__dbt_backup"
[0m21:25:55.458406 [debug] [Thread-1  ]: SQL status: SELECT 9862 in 0.0 seconds
[0m21:25:55.461936 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:55.462936 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine" rename to "metricflow_time_spine__dbt_backup"
[0m21:25:55.492872 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:55.497975 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: COMMIT
[0m21:25:55.498441 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m21:25:55.498784 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: COMMIT
[0m21:25:55.555438 [debug] [Thread-3  ]: SQL status: BEGIN in 5.0 seconds
[0m21:25:55.555891 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m21:25:55.556243 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */

  
    

  create  table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp"
  
  
    as
  
  (
    

with 

purchase_items as (
    select *
    from "postgres"."metrics_test"."stg_purchase"
),


renamed as (
    select
    sku,
    date_trunc('day', create_at) as create_at,
    sum(amount * qty) as purchase_amount_usd_total,
    sum(qty) as qty,
    sum(amount * qty) / sum(qty) as purchase_amount_usd_avg
    from purchase_items
    group by sku,create_at
)

select * from renamed
  );
  
[0m21:25:55.782951 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:55.785936 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m21:25:55.786358 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_tmp" rename to "purchase_items_week"
[0m21:25:55.860022 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m21:25:55.862617 [debug] [Thread-4  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup"
[0m21:25:55.865271 [debug] [Thread-4  ]: Using postgres connection "model.windingflowdev.purchase_items"
[0m21:25:55.865645 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items__dbt_backup" cascade
[0m21:25:55.921833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:55.924871 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:55.925266 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
alter table "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_tmp" rename to "metricflow_time_spine"
[0m21:25:56.053084 [debug] [Thread-3  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:25:56.056343 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m21:25:56.056765 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day" rename to "purchase_items_day__dbt_backup"
[0m21:25:56.169906 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:56.171996 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m21:25:56.172364 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m21:25:56.172686 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: COMMIT
[0m21:25:56.191420 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:25:56.192998 [debug] [Thread-4  ]: Timing info for model.windingflowdev.purchase_items (execute): 21:25:50.959434 => 21:25:56.192770
[0m21:25:56.193367 [debug] [Thread-4  ]: On model.windingflowdev.purchase_items: Close
[0m21:25:56.194447 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e38437430>]}
[0m21:25:56.195241 [info ] [Thread-4  ]: 3 of 5 OK created sql table model metrics_test_windingflow.purchase_items ...... [[32mSELECT 15[0m in 5.26s]
[0m21:25:56.195923 [debug] [Thread-4  ]: Finished running node model.windingflowdev.purchase_items
[0m21:25:56.413737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:56.416639 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m21:25:56.417250 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:56.417931 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: COMMIT
[0m21:25:56.509635 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:56.513043 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m21:25:56.513500 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
alter table "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_tmp" rename to "purchase_items_day"
[0m21:25:56.541388 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m21:25:56.544029 [debug] [Thread-2  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup"
[0m21:25:56.544796 [debug] [Thread-2  ]: Using postgres connection "model.windingflowdev.purchase_items_week"
[0m21:25:56.545164 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_week"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_week__dbt_backup" cascade
[0m21:25:56.963615 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:25:56.965228 [debug] [Thread-2  ]: Timing info for model.windingflowdev.purchase_items_week (execute): 21:25:51.003819 => 21:25:56.965018
[0m21:25:56.965613 [debug] [Thread-2  ]: On model.windingflowdev.purchase_items_week: Close
[0m21:25:56.966648 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e384173d0>]}
[0m21:25:56.967393 [info ] [Thread-2  ]: 5 of 5 OK created sql table model metrics_test_windingflow.purchase_items_week . [[32mSELECT 14[0m in 6.01s]
[0m21:25:56.968010 [debug] [Thread-2  ]: Finished running node model.windingflowdev.purchase_items_week
[0m21:25:57.004467 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:25:57.007008 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m21:25:57.007475 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m21:25:57.007823 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: COMMIT
[0m21:25:57.443242 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m21:25:57.446992 [debug] [Thread-3  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup"
[0m21:25:57.484970 [debug] [Thread-3  ]: Using postgres connection "model.windingflowdev.purchase_items_day"
[0m21:25:57.485419 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.purchase_items_day"} */
drop table if exists "postgres"."metrics_test_windingflow"."purchase_items_day__dbt_backup" cascade
[0m21:25:57.642604 [debug] [Thread-1  ]: SQL status: COMMIT in 1.0 seconds
[0m21:25:57.645082 [debug] [Thread-1  ]: Applying DROP to: "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup"
[0m21:25:57.645779 [debug] [Thread-1  ]: Using postgres connection "model.windingflowdev.metricflow_time_spine"
[0m21:25:57.646138 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "windingflowdev", "target_name": "dev", "node_id": "model.windingflowdev.metricflow_time_spine"} */
drop table if exists "postgres"."metrics_test_windingflow"."metricflow_time_spine__dbt_backup" cascade
[0m21:25:57.936929 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:25:57.938707 [debug] [Thread-3  ]: Timing info for model.windingflowdev.purchase_items_day (execute): 21:25:50.953588 => 21:25:57.938419
[0m21:25:57.939182 [debug] [Thread-3  ]: On model.windingflowdev.purchase_items_day: Close
[0m21:25:57.940699 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e382b5e50>]}
[0m21:25:57.941757 [info ] [Thread-3  ]: 4 of 5 OK created sql table model metrics_test_windingflow.purchase_items_day .. [[32mSELECT 14[0m in 7.00s]
[0m21:25:57.942554 [debug] [Thread-3  ]: Finished running node model.windingflowdev.purchase_items_day
[0m21:25:58.135857 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:25:58.137367 [debug] [Thread-1  ]: Timing info for model.windingflowdev.metricflow_time_spine (execute): 21:25:54.956468 => 21:25:58.137164
[0m21:25:58.137744 [debug] [Thread-1  ]: On model.windingflowdev.metricflow_time_spine: Close
[0m21:25:58.139242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0846ef8d-4f3b-42e5-b062-25018428a08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e38313970>]}
[0m21:25:58.139907 [info ] [Thread-1  ]: 1 of 5 OK created sql table model metrics_test_windingflow.metricflow_time_spine  [[32mSELECT 9862[0m in 11.00s]
[0m21:25:58.140483 [debug] [Thread-1  ]: Finished running node model.windingflowdev.metricflow_time_spine
[0m21:25:58.141970 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:58.142303 [debug] [MainThread]: On master: BEGIN
[0m21:25:58.142574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:00.750252 [debug] [MainThread]: SQL status: BEGIN in 3.0 seconds
[0m21:26:00.750668 [debug] [MainThread]: On master: COMMIT
[0m21:26:00.750990 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.751250 [debug] [MainThread]: On master: COMMIT
[0m21:26:01.025997 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:26:01.026473 [debug] [MainThread]: On master: Close
[0m21:26:01.027728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:01.028281 [debug] [MainThread]: Connection 'model.windingflowdev.metricflow_time_spine' was properly closed.
[0m21:26:01.028535 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_week' was properly closed.
[0m21:26:01.028775 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items' was properly closed.
[0m21:26:01.029012 [debug] [MainThread]: Connection 'model.windingflowdev.purchase_items_day' was properly closed.
[0m21:26:01.029380 [info ] [MainThread]: 
[0m21:26:01.029747 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 31.85 seconds (31.85s).
[0m21:26:01.031232 [debug] [MainThread]: Command end result
[0m21:26:01.041578 [info ] [MainThread]: 
[0m21:26:01.042190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:01.042584 [info ] [MainThread]: 
[0m21:26:01.042945 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:26:01.043703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.269756, "process_user_time": 2.723113, "process_kernel_time": 0.140038, "process_mem_max_rss": "111876", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m21:26:01.044245 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:01.044117 after 32.27 seconds
[0m21:26:01.044610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3fa04d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3d9042e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e382ba640>]}
[0m21:26:01.044977 [debug] [MainThread]: Flushing usage events
[0m21:33:17.707142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9abf497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aaa107c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aaa106d0>]}


============================== 21:33:17.708885 | 259a2a36-93ab-451c-a849-a3432e7c4498 ==============================
[0m21:33:17.708885 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:33:17.709292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'invocation_command': 'dbt list metrics', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:17.709696 [info ] [MainThread]: dbt version: 1.7.4
[0m21:33:17.709977 [info ] [MainThread]: python version: 3.8.10
[0m21:33:17.710260 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:33:17.710527 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m21:33:17.784847 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m21:33:17.785309 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m21:33:17.785625 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m21:33:17.786088 [info ] [MainThread]: adapter type: postgres
[0m21:33:17.786396 [info ] [MainThread]: adapter version: 1.7.4
[0m21:33:17.868358 [info ] [MainThread]: Configuration:
[0m21:33:17.868810 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:33:17.869105 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:33:17.869386 [info ] [MainThread]: Required dependencies:
[0m21:33:17.869693 [debug] [MainThread]: Executing "git --help"
[0m21:33:17.882018 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:33:17.883051 [debug] [MainThread]: STDERR: "b''"
[0m21:33:17.883546 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:33:17.883902 [info ] [MainThread]: Connection:
[0m21:33:17.884400 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m21:33:17.884692 [info ] [MainThread]:   port: 5432
[0m21:33:17.884993 [info ] [MainThread]:   user: postgres
[0m21:33:17.885270 [info ] [MainThread]:   database: postgres
[0m21:33:17.885560 [info ] [MainThread]:   schema: metrics_test
[0m21:33:17.885892 [info ] [MainThread]:   connect_timeout: 10
[0m21:33:17.886202 [info ] [MainThread]:   role: None
[0m21:33:17.886480 [info ] [MainThread]:   search_path: None
[0m21:33:17.886756 [info ] [MainThread]:   keepalives_idle: 0
[0m21:33:17.887050 [info ] [MainThread]:   sslmode: None
[0m21:33:17.887323 [info ] [MainThread]:   sslcert: None
[0m21:33:17.887594 [info ] [MainThread]:   sslkey: None
[0m21:33:17.887873 [info ] [MainThread]:   sslrootcert: None
[0m21:33:17.888151 [info ] [MainThread]:   application_name: dbt
[0m21:33:17.888424 [info ] [MainThread]:   retries: 1
[0m21:33:17.888912 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:33:17.889672 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:33:17.890084 [debug] [MainThread]: Using postgres connection "debug"
[0m21:33:17.890453 [debug] [MainThread]: On debug: select 1 as id
[0m21:33:17.890822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:21.682470 [debug] [MainThread]: SQL status: SELECT 1 in 4.0 seconds
[0m21:33:21.683677 [debug] [MainThread]: On debug: Close
[0m21:33:21.684216 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:33:21.684520 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:33:21.685417 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.0237494, "process_user_time": 2.213196, "process_kernel_time": 0.243691, "process_mem_max_rss": "147496", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m21:33:21.686179 [debug] [MainThread]: Command `cli debug` succeeded at 21:33:21.685954 after 4.02 seconds
[0m21:33:21.686535 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:33:21.686901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9abf497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9abae1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a90b6e20>]}
[0m21:33:21.687327 [debug] [MainThread]: Flushing usage events
[0m21:34:16.485625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14c649790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14b10a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14b10a7c0>]}


============================== 21:34:16.487446 | 5ae3f93c-4eae-41df-b38d-3f6ba863e439 ==============================
[0m21:34:16.487446 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:34:16.487932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt query --metrics purchase_total_metrics --group-by purchase_id__create_at', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:34:16.488378 [info ] [MainThread]: dbt version: 1.7.4
[0m21:34:16.488736 [info ] [MainThread]: python version: 3.8.10
[0m21:34:16.489047 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:34:16.489357 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m21:34:16.562703 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m21:34:16.563220 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m21:34:16.563578 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m21:34:16.564028 [info ] [MainThread]: adapter type: postgres
[0m21:34:16.564412 [info ] [MainThread]: adapter version: 1.7.4
[0m21:34:16.638539 [info ] [MainThread]: Configuration:
[0m21:34:16.639000 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:34:16.639376 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:34:16.639686 [info ] [MainThread]: Required dependencies:
[0m21:34:16.640012 [debug] [MainThread]: Executing "git --help"
[0m21:34:16.646605 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:34:16.647372 [debug] [MainThread]: STDERR: "b''"
[0m21:34:16.647810 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:34:16.648151 [info ] [MainThread]: Connection:
[0m21:34:16.648519 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m21:34:16.648851 [info ] [MainThread]:   port: 5432
[0m21:34:16.649149 [info ] [MainThread]:   user: postgres
[0m21:34:16.649448 [info ] [MainThread]:   database: postgres
[0m21:34:16.649849 [info ] [MainThread]:   schema: metrics_test
[0m21:34:16.650162 [info ] [MainThread]:   connect_timeout: 10
[0m21:34:16.650461 [info ] [MainThread]:   role: None
[0m21:34:16.650787 [info ] [MainThread]:   search_path: None
[0m21:34:16.651085 [info ] [MainThread]:   keepalives_idle: 0
[0m21:34:16.651384 [info ] [MainThread]:   sslmode: None
[0m21:34:16.651946 [info ] [MainThread]:   sslcert: None
[0m21:34:16.652248 [info ] [MainThread]:   sslkey: None
[0m21:34:16.652547 [info ] [MainThread]:   sslrootcert: None
[0m21:34:16.652948 [info ] [MainThread]:   application_name: dbt
[0m21:34:16.653433 [info ] [MainThread]:   retries: 1
[0m21:34:16.654100 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:34:16.654847 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:34:16.655266 [debug] [MainThread]: Using postgres connection "debug"
[0m21:34:16.655617 [debug] [MainThread]: On debug: select 1 as id
[0m21:34:16.655954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:18.781596 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m21:34:18.782872 [debug] [MainThread]: On debug: Close
[0m21:34:18.783798 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:34:18.784130 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:34:18.785122 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3445904, "process_user_time": 2.227762, "process_kernel_time": 0.167681, "process_mem_max_rss": "147508", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m21:34:18.785800 [debug] [MainThread]: Command `cli debug` succeeded at 21:34:18.785651 after 2.35 seconds
[0m21:34:18.786196 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:34:18.786600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14c649790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd150665970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1497b5e20>]}
[0m21:34:18.787045 [debug] [MainThread]: Flushing usage events
[0m21:34:21.358982 [debug] [MainThread]: Acquiring new postgres connection 'MetricFlow_request_mf_rid__99rf22dv'
[0m21:34:21.359420 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__99rf22dv"
[0m21:34:21.359726 [debug] [MainThread]: On MetricFlow_request_mf_rid__99rf22dv: BEGIN
[0m21:34:21.360006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:23.520276 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m21:34:23.520684 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__99rf22dv"
[0m21:34:23.520961 [debug] [MainThread]: On MetricFlow_request_mf_rid__99rf22dv: -- Read Elements From Semantic Model 'purchase_items'
-- Metric Time Dimension 'create_at'
-- Pass Only Elements:
--   ['purchase_total', 'purchase_id__create_at__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', create_at) AS purchase_id__create_at__day
  , SUM(purchase_amount_usd) AS purchase_total_metrics
FROM "postgres"."metrics_test_windingflow"."purchase_items" purchase_items_src_0
GROUP BY
  DATE_TRUNC('day', create_at)
-- MF_REQUEST_METADATA: {"tag_dict": {"MF_REQUEST_ID": "mf_rid__99rf22dv"}}
[0m21:34:23.788132 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m21:34:23.789664 [debug] [MainThread]: On MetricFlow_request_mf_rid__99rf22dv: ROLLBACK
[0m21:34:24.020718 [debug] [MainThread]: On MetricFlow_request_mf_rid__99rf22dv: Close
[0m21:35:02.865894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad6d96790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad58587f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad5858700>]}


============================== 21:35:02.867582 | 29a1199f-8d14-4717-a291-505d47c127ca ==============================
[0m21:35:02.867582 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:35:02.867976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/home/shaw/Projects/windingflow/windingflowdev/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt query --metrics purchase_total_metrics --group-by purchase_id__sku', 'send_anonymous_usage_stats': 'True'}
[0m21:35:02.868404 [info ] [MainThread]: dbt version: 1.7.4
[0m21:35:02.868675 [info ] [MainThread]: python version: 3.8.10
[0m21:35:02.868973 [info ] [MainThread]: python path: /usr/bin/python3
[0m21:35:02.869231 [info ] [MainThread]: os info: Linux-5.15.0-91-generic-x86_64-with-glibc2.29
[0m21:35:02.940328 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m21:35:02.940719 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m21:35:02.940999 [info ] [MainThread]: Using dbt_project.yml file at /home/shaw/Projects/windingflow/windingflowdev/dbt_project.yml
[0m21:35:02.941482 [info ] [MainThread]: adapter type: postgres
[0m21:35:02.941753 [info ] [MainThread]: adapter version: 1.7.4
[0m21:35:03.012997 [info ] [MainThread]: Configuration:
[0m21:35:03.013424 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:35:03.013711 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:35:03.013977 [info ] [MainThread]: Required dependencies:
[0m21:35:03.014289 [debug] [MainThread]: Executing "git --help"
[0m21:35:03.020497 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:35:03.021139 [debug] [MainThread]: STDERR: "b''"
[0m21:35:03.021632 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:35:03.021953 [info ] [MainThread]: Connection:
[0m21:35:03.022451 [info ] [MainThread]:   host: database-1.c0fmdark0ki3.us-east-1.rds.amazonaws.com
[0m21:35:03.022919 [info ] [MainThread]:   port: 5432
[0m21:35:03.023322 [info ] [MainThread]:   user: postgres
[0m21:35:03.023581 [info ] [MainThread]:   database: postgres
[0m21:35:03.023837 [info ] [MainThread]:   schema: metrics_test
[0m21:35:03.024092 [info ] [MainThread]:   connect_timeout: 10
[0m21:35:03.024347 [info ] [MainThread]:   role: None
[0m21:35:03.024606 [info ] [MainThread]:   search_path: None
[0m21:35:03.024860 [info ] [MainThread]:   keepalives_idle: 0
[0m21:35:03.025113 [info ] [MainThread]:   sslmode: None
[0m21:35:03.025380 [info ] [MainThread]:   sslcert: None
[0m21:35:03.025641 [info ] [MainThread]:   sslkey: None
[0m21:35:03.025893 [info ] [MainThread]:   sslrootcert: None
[0m21:35:03.026165 [info ] [MainThread]:   application_name: dbt
[0m21:35:03.026423 [info ] [MainThread]:   retries: 1
[0m21:35:03.026858 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m21:35:03.027613 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:35:03.027974 [debug] [MainThread]: Using postgres connection "debug"
[0m21:35:03.028291 [debug] [MainThread]: On debug: select 1 as id
[0m21:35:03.028589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:06.770225 [debug] [MainThread]: SQL status: SELECT 1 in 4.0 seconds
[0m21:35:06.771509 [debug] [MainThread]: On debug: Close
[0m21:35:06.772698 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:35:06.773168 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:35:06.774302 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.9534817, "process_user_time": 2.173481, "process_kernel_time": 0.231306, "process_mem_max_rss": "147508", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m21:35:06.775017 [debug] [MainThread]: Command `cli debug` succeeded at 21:35:06.774833 after 3.95 seconds
[0m21:35:06.775401 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:35:06.775805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad6d96790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad6969340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad3f02c70>]}
[0m21:35:06.776273 [debug] [MainThread]: Flushing usage events
[0m21:35:08.830562 [debug] [MainThread]: Acquiring new postgres connection 'MetricFlow_request_mf_rid__24fs05zs'
[0m21:35:08.831022 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__24fs05zs"
[0m21:35:08.831316 [debug] [MainThread]: On MetricFlow_request_mf_rid__24fs05zs: BEGIN
[0m21:35:08.831609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:11.034188 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m21:35:11.034623 [debug] [MainThread]: Using postgres connection "MetricFlow_request_mf_rid__24fs05zs"
[0m21:35:11.034919 [debug] [MainThread]: On MetricFlow_request_mf_rid__24fs05zs: -- Read Elements From Semantic Model 'purchase_items'
-- Metric Time Dimension 'create_at'
-- Pass Only Elements:
--   ['purchase_total', 'purchase_id__sku']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  sku AS purchase_id__sku
  , SUM(purchase_amount_usd) AS purchase_total_metrics
FROM "postgres"."metrics_test_windingflow"."purchase_items" purchase_items_src_0
GROUP BY
  sku
-- MF_REQUEST_METADATA: {"tag_dict": {"MF_REQUEST_ID": "mf_rid__24fs05zs"}}
[0m21:35:11.287563 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:35:11.288936 [debug] [MainThread]: On MetricFlow_request_mf_rid__24fs05zs: ROLLBACK
[0m21:35:11.520888 [debug] [MainThread]: On MetricFlow_request_mf_rid__24fs05zs: Close
